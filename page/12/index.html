<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="nullptr">
<meta property="og:url" content="http://example.com/page/12/index.html">
<meta property="og:site_name" content="nullptr">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ubun2">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/12/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>nullptr</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">nullptr</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">吾生也有涯 而知也无涯</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/sql/sqlite/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/sql/sqlite/" class="post-title-link" itemprop="url">sqlite</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:42:38" itemprop="dateModified" datetime="2022-06-08T20:42:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sqlite/" itemprop="url" rel="index"><span itemprop="name">sqlite</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>SQLite是一款轻量、无服务器的、零配置的、事务性、关系型的数据库引擎，不需要在系统中配置就可以直接使用。</p>
<h2 id="点命令"><a href="#点命令" class="headerlink" title="点命令"></a>点命令</h2><p>可在命令行上输入<code>.help</code>列出所有sqlite支持的点命令。</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>每个存储在 SQLite 数据库中的值都具有以下存储类之一：</p>
<table>
<thead>
<tr>
<th align="left">存储类</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">NULL</td>
<td align="left">NULL 值。</td>
</tr>
<tr>
<td align="left">INTEGER</td>
<td align="left">有符号整数，根据值的大小存储在 1、2、3、4、6 或 8 字节中</td>
</tr>
<tr>
<td align="left">REAL</td>
<td align="left">浮点数</td>
</tr>
<tr>
<td align="left">TEXT</td>
<td align="left">文本字符串，使用数据库编码（UTF-8、UTF-16BE 或 UTF-16LE）存储</td>
</tr>
<tr>
<td align="left">BLOB</td>
<td align="left">值是一个 blob 数据，完全根据它的输入存储</td>
</tr>
</tbody></table>
<p>SQLite通过值的表示来推理其类型：</p>
<ul>
<li>用单引号或双引号括起来的文字被指派为TEXT。</li>
<li>未用引号括起来的数据，并且没有小数点和指数，被指派为INTEGER。</li>
<li>未用引号括起来的数据，并且带有小数点或指数，被指派为REAL。</li>
<li>用NULL说明的值被指派为NULL存储类。</li>
<li>如果一个值的格式为X’ABCD’，其中ABCD为16进制数字，X前缀大小写皆可，则该值被指派为BLOB。</li>
</ul>
<p>SQLite支持列的亲和类型，列仍然可以存储任何类型的数据，当数据插入时，该字段的数据将会优先采用亲缘类型作为该值的存储方式。</p>
<table>
<thead>
<tr>
<th align="left">数据类型</th>
<th align="left">亲和类型</th>
</tr>
</thead>
<tbody><tr>
<td align="left">INT、NTEGER、TINYINT、SMALLINT、MEDIUMINT、BIGINT、UNSIGNED BIG INT、INT2、INT8</td>
<td align="left">INTEGER</td>
</tr>
<tr>
<td align="left">CHARACTER(20)、VARCHAR(255)、VARYING CHARACTER(255)、NCHAR(55)、NATIVE CHARACTER(70)、NVARCHAR(100)、TEXT、CLOB</td>
<td align="left">TEXT</td>
</tr>
<tr>
<td align="left">BLOB、no datatype specified</td>
<td align="left">NONE</td>
</tr>
<tr>
<td align="left">REAL、DOUBLE、DOUBLE PRECISION、FLOAT</td>
<td align="left">REAL</td>
</tr>
<tr>
<td align="left">NUMERIC、DECIMAL(10,5)、BOOLEAN、DATE、DATETIME</td>
<td align="left">NUMERIC<br/>可以包含使用所有五个存储类的值</td>
</tr>
</tbody></table>
<p>SQLite 没有单独的 Boolean 存储类，布尔值被存储为整数 0和 1。</p>
<p>SQLite 没有单独用于存储日期或时间的存储类，但 可以存储为 TEXT、REAL 或 INTEGER 值。</p>
<table>
<thead>
<tr>
<th align="left">存储类</th>
<th align="left">日期格式</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TEXT</td>
<td align="left">格式为 “YYYY-MM-DD HH:MM:SS.SSS” 的日期。</td>
</tr>
<tr>
<td align="left">REAL</td>
<td align="left">从公元前 4714 年 11 月 24 日格林尼治时间的正午开始算起的天数。</td>
</tr>
<tr>
<td align="left">INTEGER</td>
<td align="left">从 1970-01-01 00:00:00 UTC 算起的秒数。</td>
</tr>
</tbody></table>
<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><p>约束是在表或列上强制执行的规则，限制可以插入到表中的数据类型，以确保数据的准确性和可靠性。</p>
<ul>
<li>NOT NULL约束：确保某列不能是NULL值(未知的数据)。</li>
<li>DEFAULT约束：当某列没有指定值时，为该列提供默认值。</li>
<li>UNIQUE约束：确保某列中的所有值是不同的。</li>
<li>PRIMARY Key约束：只能有一个主键唯一标识数据库表中的各行记录。</li>
<li>CHECK约束：确保某列中的所有值满足一定条件。</li>
</ul>
<h2 id="Join"><a href="#Join" class="headerlink" title="Join"></a>Join</h2><p>Joins子句用于结合两个或多个数据库中表的记录。JOIN是一种通过共同值来结合两个表中字段的手段。</p>
<p>交叉连接（CROSS JOIN）把第一个表的每一行与第二个表的每一行进行匹配。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> table2 ...;</span><br></pre></td></tr></table></figure>

<p>内连接（INNER JOIN）根据指定的连接条件结合两个表的列值来创建一个新的表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--INNER 关键字是可选的</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 [<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> table2 <span class="keyword">ON</span> conditional_expression ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">--可以使用USING表达式声明内连接条件，指定一个或多个列的列表</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">JOIN</span> table2 <span class="keyword">USING</span> ( column1 ,... ) ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自然连接会自动测试存在两个表中的每一列的值之间相等值</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> table2...;</span><br></pre></td></tr></table></figure>

<p>外连接（OUTER JOIN）是内连接的扩展，不同的是会将未匹配条件的行使用NULL值，也附加到结果表中。虽然 SQL标准定义了三种类型的外连接：LEFT、RIGHT、FULL，但SQLite只支持左外连接（LEFT OUTER JOIN）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> table2 <span class="keyword">ON</span> conditional_expression ...;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table1 <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> table2 <span class="keyword">USING</span> ( column1 ,... ) ...;</span><br></pre></td></tr></table></figure>

<h2 id="AS别名"><a href="#AS别名" class="headerlink" title="AS别名"></a>AS别名</h2><p>可以暂时把表或列重命名为另一个名字，重命名是临时的改变，在数据库中实际的表的名称不会改变。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表别名</span></span><br><span class="line"><span class="keyword">SELECT</span> column1, ... columnN</span><br><span class="line"><span class="keyword">FROM</span> table_name <span class="keyword">AS</span> alias_name</span><br><span class="line"><span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列别名</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">AS</span> alias_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>触发器(Trigger)是数据库的回调函数，它会在自动执行或指定的数据库事件发生时调用。</p>
<ul>
<li><p>SQLite的触发器可以指定在特定的数据库表发生DELETE、INSERT或UPDATE时触发，或在一个或多个指定表的列发生更新时触发。</p>
</li>
<li><p>SQLite只支持FOR EACH ROW触发器，没有FOR EACH STATEMENT触发器。</p>
</li>
<li><p>BEFORE或AFTER关键字决定何时执行触发器动作，决定是在关联行的插入、修改或删除之前或者之后执行触发器动作。</p>
</li>
<li><p>要修改的表必须存在于同一数据库中，作为触发器被附加的表或视图，且必须只使用tablename，而不是database.tablename。</p>
</li>
<li><p>当触发器相关联的表删除时，自动删除触发器。</p>
</li>
<li><p>RAISE()函数可用于触发器程序内抛出异常。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建触发器</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name [BEFORE<span class="operator">|</span>AFTER] </span><br><span class="line"><span class="keyword">INSERT</span><span class="operator">|</span><span class="keyword">DELETE</span><span class="operator">|</span><span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> table_name </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="comment">-- Trigger logic goes here....</span></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列出触发器</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> sqlite_master <span class="keyword">WHERE</span> type <span class="operator">=</span> <span class="string">&#x27;trigger&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出特定表上的触发器</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> sqlite_master <span class="keyword">WHERE</span> type <span class="operator">=</span> <span class="string">&#x27;trigger&#x27;</span> <span class="keyword">AND</span> tbl_name <span class="operator">=</span> <span class="string">&#x27;table_name_xxx&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除触发器</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> trigger_name;</span><br></pre></td></tr></table></figure>

<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>索引(Index)是一种特殊的查找表，用来加快数据检索。索引是一个指向表中数据的指针，索引有助于加快SELECT查询和WHERE子句，但它会减慢使用UPDATE和INSERT语句时的数据输入。</p>
<ul>
<li>单列索引是一个只基于表的一个列上创建的索引。</li>
<li>组合索引是基于一个表的两个或多个列上创建的索引。</li>
<li>唯一索引不允许任何重复的值插入到表中，这是出于性能和数据完整性考虑。</li>
<li>隐式索引是在创建对象时，由数据库服务器自动创建的索引，自动创建的索引为主键约束和唯一约束。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX index_name <span class="keyword">ON</span> table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建单列索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX index_name <span class="keyword">ON</span> table_name (column_name);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建组合索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX index_name <span class="keyword">on</span> table_name (column1, column2);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建唯一索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> INDEX index_name <span class="keyword">on</span> table_name (column_name);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX index_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看索引</span></span><br><span class="line">.indices teamTable</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出数据库所有索引：</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> sqlite_master <span class="keyword">WHERE</span> type <span class="operator">=</span> <span class="string">&#x27;index&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Indexed-By关键字"><a href="#Indexed-By关键字" class="headerlink" title="Indexed By关键字"></a>Indexed By关键字</h3><p><code>INDEXED BY index-name</code>子句规定必须要指定的索引名来查找表中的值，如果索引名index-name不存在或不能用于查询，就会失败。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span><span class="operator">|</span><span class="keyword">DELETE</span><span class="operator">|</span><span class="keyword">UPDATE</span> column1, column2...</span><br><span class="line">INDEXED <span class="keyword">BY</span> (index_name)</span><br><span class="line">table_name</span><br><span class="line"><span class="keyword">WHERE</span> (<span class="keyword">CONDITION</span>);</span><br></pre></td></tr></table></figure>

<p><code>NOT INDEXED</code>子句规定当访问的表（包括由UNIQUE和PRIMARY KEY约束创建的隐式索引）时，没有使用索引。</p>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>视图(View)是一个以预定义的SQLite查询形式存在的表的组合。视图可以包含一个表的所有行或从一个或多个表选定行，可以从一个单一的表、多个表或其他视图创建。。使用视图可以实现：</p>
<ul>
<li>用这种结构来查找数据更自然或直观。</li>
<li>限制数据访问，只能看到有限的数据，而不是完整的表。</li>
<li>汇总各种表中的数据，用于生成报告。</li>
</ul>
<p>SQLite视图是只读的，因此可能无法在视图上执行DELETE、INSERT或UPDATE语句。但是可以在视图上创建一个触发器，当尝试DELETE、INSERT或UPDATE视图时触发。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> [TEMP <span class="operator">|</span> TEMPORARY] <span class="keyword">VIEW</span> view_name <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> column1, column2...</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除视图</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> view_name;</span><br></pre></td></tr></table></figure>

<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>事务（Transaction）是以逻辑顺序完成的工作单位或序列。事务具有四个属性：</p>
<ul>
<li>原子性：确保工作单位内的所有操作都成功完成，否则，事务会在出现故障时终止，之前的操作也会回滚到以前的状态。</li>
<li>一致性：确保数据库在成功提交的事务上正确地改变状态。</li>
<li>隔离性：使事务操作相互独立和透明。</li>
<li>持久性：确保已提交事务的结果或效果在系统发生故障的情况下仍然存在。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 启动事务</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">BEGIN</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 将事务调用的更改保存到数据库</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 撤消尚未保存到数据库的事务</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>

<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询是在WHERE子句中内嵌一个查询语句，使用子查询返回的数据将被用在主查询中作为条件，以进一步限制要检索的数据。子查询可以与SELECT、INSERT、UPDATE和DELETE语句一起使用。子查询必须遵循的几个规则：</p>
<ul>
<li>子查询必须用括号括起来。</li>
<li>子查询在SELECT子句中只能有一个列，除非在主查询中有多列与子查询的所选列进行比较。</li>
<li>ORDER BY不能用在子查询中，虽然主查询可以使用ORDER BY。</li>
<li>子查询返回多于一行，只能与多值运算符一起使用，如IN运算符。</li>
<li>BETWEEN运算符不能与子查询一起使用，但是BETWEEN可在子查询内使用。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teamTable <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> teamTable <span class="keyword">WHERE</span> money <span class="operator">&gt;</span> <span class="number">4500</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teamTable_bak <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teamTable <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> teamTable);</span><br><span class="line"><span class="keyword">UPDATE</span> teamTable <span class="keyword">SET</span> money <span class="operator">=</span> money <span class="operator">*</span> <span class="number">0.50</span> <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="keyword">SELECT</span> age <span class="keyword">FROM</span> teamTable_bck <span class="keyword">WHERE</span> age <span class="operator">&gt;=</span> <span class="number">24</span>);</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> teamTable <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="keyword">SELECT</span> age <span class="keyword">FROM</span> teamTable_bck <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">24</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Autoincrement"><a href="#Autoincrement" class="headerlink" title="Autoincrement"></a>Autoincrement</h2><p>AUTOINCREMENT关键字用于表中的字段值自动递增，可以在创建表时在特定的列名称上使用AUTOINCREMENT关键字实现该字段值的自动增加，只能用于整型（INTEGER）字段。设置了AUTOINCREMENT后insert或者update时不需要指定值，自动从1开始递增。</p>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p>允许用户通过网页输入，并将输入内容插入到SQLite数据库中，这时需要注意SQL注入的安全问题。</p>
<h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><code>EXPLAIN</code>或<code>EXPLAIN QUERY PLAN</code>关键字用于描述表的细节，可用于表的交互式分析和排除故障。。</p>
<p>EXPLAIN [SQLite Query]</p>
<p>EXPLAIN  QUERY PLAN [SQLite Query]</p>
<h2 id="PRAGMA"><a href="#PRAGMA" class="headerlink" title="PRAGMA"></a>PRAGMA</h2><p>SQLite的PRAGMA命令是一个特殊的命令，可以用在SQLite环境内控制各种环境变量和状态标志。PRAGMA值可以被读取和设置。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询当前的PRAGMA值</span></span><br><span class="line">PRAGMA pragma_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置一个新的值</span></span><br><span class="line">PRAGMA pragma_name <span class="operator">=</span> <span class="keyword">value</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Vacuum"><a href="#Vacuum" class="headerlink" title="Vacuum"></a>Vacuum</h2><p>VACUUM 命令通过复制主数据库中的内容到一个临时数据库文件，然后清空主数据库，并从副本中重新载入原始的数据库文件。目的是整理数据库文件结构，消除空闲页，把表中的数据排列连续。</p>
<p>如果表中没有明确的整型主键(INTEGER PRIMARY KEY)，VACUUM 命令可能会改变表中条目的行 ID(ROWID)。VACUUM 命令只适用于主数据库，附加的数据库文件是不能使用。如果有一个活动的事务，VACUUM 命令就会失败。由于 VACUUM 命令从头开始重新创建数据库文件，所以 VACUUM 也可以用于修改许多数据库特定的配置参数。</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.sqlite.org/docs.html">https://www.sqlite.org/docs.html</a></p>
<p><a target="_blank" rel="noopener" href="https://runebook.dev/zh-CN/docs/sqlite/-index-">https://runebook.dev/zh-CN/docs/sqlite/-index-</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/sqlite/sqlite-tutorial.html">https://www.runoob.com/sqlite/sqlite-tutorial.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/HardWorkingAnt/article/details/70474107">https://blog.csdn.net/HardWorkingAnt/article/details/70474107</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/sql/sqlite-sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/sql/sqlite-sql/" class="post-title-link" itemprop="url">sqlite sql commands and clauses</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:42:45" itemprop="dateModified" datetime="2022-06-08T20:42:45+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sqlite/" itemprop="url" rel="index"><span itemprop="name">sqlite</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>SQLite有4类SQL语句：</p>
<ul>
<li>DDL(数据定义语言)用来定义数据库对象、创建库、表、列等。</li>
<li>DML(数据库操作语言)用来操作数据库表中的记录。</li>
<li>DQL(数据查询语言)用来查询数据。</li>
<li>DCL(数据控制语言)用来定义访问权限和安全级别。</li>
</ul>
<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt;.open database_name.db</span><br><span class="line">sqlite3 database_name.db</span><br></pre></td></tr></table></figure>

<h3 id="附加-分离数据库"><a href="#附加-分离数据库" class="headerlink" title="附加/分离数据库"></a>附加/分离数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ATTACH DATABASE <span class="string">&#x27;file_name&#x27;</span> <span class="keyword">AS</span> database_name;</span><br><span class="line"></span><br><span class="line">DETACH DATABASE <span class="string">&#x27;alias_name&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; attach database &#x27;test.db&#x27; as test;</span><br><span class="line">sqlite&gt; .databases</span><br><span class="line">seq  name             file                                                      </span><br><span class="line">---  ---------------  ----------------------------------------------------------</span><br><span class="line">0    main             ./test.db                                       </span><br><span class="line">2    test             ./test.db</span><br><span class="line">sqlite&gt; detach database test;</span><br><span class="line">sqlite&gt; .databases</span><br><span class="line">seq  name             file                                                      </span><br><span class="line">---  ---------------  ----------------------------------------------------------</span><br><span class="line">0    main             /home/luo_u/test.db</span><br></pre></td></tr></table></figure>

<h3 id="创建-删除表"><a href="#创建-删除表" class="headerlink" title="创建/删除表"></a>创建/删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> database_name.table_name(</span><br><span class="line">   col1_datatype,</span><br><span class="line">   .....</span><br><span class="line">   colN_datatype,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> database_name.table_name;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table tb1(num, name);</span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">tb1</span><br><span class="line">sqlite&gt; drop table tb1;</span><br><span class="line">sqlite&gt; .tables</span><br></pre></td></tr></table></figure>

<h3 id="变更表"><a href="#变更表" class="headerlink" title="变更表"></a>变更表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重命名表</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> database_name.table_name RENAME <span class="keyword">TO</span> new_table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加一个新的列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> database_name.table_name <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> column_def...;</span><br></pre></td></tr></table></figure>

<h3 id="插入记录"><a href="#插入记录" class="headerlink" title="插入记录"></a>插入记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在表的某些列添加值</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE_NAME <span class="keyword">VALUES</span> (value1, ... valueN);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在表的所有列添加值</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE_NAME (col1, ... colN) <span class="keyword">VALUES</span> (value1, ... valueN);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用一个表来填充另一个表</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name1 [(col1, ... colN)] <span class="keyword">SELECT</span> col1, ... colN <span class="keyword">FROM</span> table_name2 [<span class="keyword">WHERE</span> <span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; insert into tb1 values(0, &#x27;aaa&#x27;);</span><br><span class="line">sqlite&gt; insert into tb1 values(1, &#x27;bbb&#x27;);</span><br><span class="line">sqlite&gt; select * from tb1;</span><br><span class="line">0|aaa</span><br><span class="line">1|bbb</span><br></pre></td></tr></table></figure>

<h3 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name <span class="keyword">SET</span> col1<span class="operator">=</span>value1, .... colN<span class="operator">=</span>valueN <span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<h3 id="替换记录"><a href="#替换记录" class="headerlink" title="替换记录"></a>替换记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPLACE <span class="keyword">INTO</span> TABLE_NAME (col1, ... colN) <span class="keyword">VALUES</span> (value1, ... valueN);</span><br></pre></td></tr></table></figure>

<h3 id="删除记录"><a href="#删除记录" class="headerlink" title="删除记录"></a>删除记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<h3 id="查询记录"><a href="#查询记录" class="headerlink" title="查询记录"></a>查询记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1, ... colN <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_TIMESTAMP</span>; <span class="comment">--返回系统日期</span></span><br></pre></td></tr></table></figure>

<p>select命令可以支持算术运算，当成计算器使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; select 1+1;</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<h3 id="WHERE子句"><a href="#WHERE子句" class="headerlink" title="WHERE子句"></a>WHERE子句</h3><p>WHERE子句用来过滤记录，只获取需要的记录。指定从一个表或多个表中获取数据的条件，如果满足给定的条件，则从表中返回特定的值。可在SELECT、UPDATE、DELETE语句中使用。</p>
<p>WHERE子句支持逻辑运算符、比较运算符和<code>&amp; | ~ &lt;&lt; &gt;&gt;</code>这些位运算符，还有内置函数。</p>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">AND</td>
<td align="left">多个条件的与逻辑</td>
</tr>
<tr>
<td align="left">OR</td>
<td align="left">多个条件的或逻辑</td>
</tr>
<tr>
<td align="left">BETWEEN</td>
<td align="left">在给定最小值和最大值范围内的一系列值中搜索值。</td>
</tr>
<tr>
<td align="left">EXISTS</td>
<td align="left">在满足一定条件的指定表中搜索行的存在</td>
</tr>
<tr>
<td align="left">IN</td>
<td align="left">把某个值与一系列指定列表的值进行比较</td>
</tr>
<tr>
<td align="left">LIKE</td>
<td align="left">把某个值与使用通配符运算符的相似值进行比较</td>
</tr>
<tr>
<td align="left">GLOB</td>
<td align="left">把某个值与使用通配符运算符的相似值进行比较，大小写敏感的</td>
</tr>
<tr>
<td align="left">NOT</td>
<td align="left">否定运算符，与其它逻辑运算符结合使用，比如 NOT EXISTS、NOT BETWEEN、NOT IN等等</td>
</tr>
<tr>
<td align="left">IS NULL</td>
<td align="left">与 NULL 值进行比较</td>
</tr>
<tr>
<td align="left">IS</td>
<td align="left">与 = 相似</td>
</tr>
<tr>
<td align="left">IS NOT</td>
<td align="left">与 != 相似</td>
</tr>
<tr>
<td align="left">||</td>
<td align="left">连接两个不同的字符串，得到一个新的字符串</td>
</tr>
<tr>
<td align="left">UNIQUE</td>
<td align="left">搜索指定表中的每一行，确保唯一性</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">==</td>
<td align="left">检查两个操作数的值是否相等</td>
</tr>
<tr>
<td align="left">=</td>
<td align="left">检查两个操作数的值是否相等</td>
</tr>
<tr>
<td align="left">!=</td>
<td align="left">检查两个操作数的值是否不相等</td>
</tr>
<tr>
<td align="left">&lt;&gt;</td>
<td align="left">检查两个操作数的值是否不相等</td>
</tr>
<tr>
<td align="left">&gt;</td>
<td align="left">检查左操作数的值是否大于右操作数的值</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">检查左操作数的值是否小于右操作数的值</td>
</tr>
<tr>
<td align="left">&gt;=</td>
<td align="left">检查左操作数的值是否大于等于右操作数的值</td>
</tr>
<tr>
<td align="left">&lt;=</td>
<td align="left">检查左操作数的值是否小于等于右操作数的值</td>
</tr>
<tr>
<td align="left">!&lt;</td>
<td align="left">检查左操作数的值是否不小于右操作数的值</td>
</tr>
<tr>
<td align="left">!&gt;</td>
<td align="left">检查左操作数的值是否不大于右操作数的值</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>求平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>求行数</td>
</tr>
<tr>
<td>FIRST()</td>
<td>返回第一个记录的值</td>
</tr>
<tr>
<td>LAST()</td>
<td>返回最后一个记录的值</td>
</tr>
<tr>
<td>MAX()</td>
<td>求最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>求最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>求总和</td>
</tr>
<tr>
<td>UCASE()</td>
<td>将字符串转换为大写</td>
</tr>
<tr>
<td>LCASE()</td>
<td>将字符串转换为小写</td>
</tr>
<tr>
<td>MID()</td>
<td>从某个文本字段提取字符，MySql 中使用</td>
</tr>
<tr>
<td>SubString()</td>
<td>从某字符串提取子字符</td>
</tr>
<tr>
<td>LEN()</td>
<td>返回字符串的长度</td>
</tr>
<tr>
<td>ROUND()</td>
<td>对某个数值字段进行指定小数位数的四舍五入</td>
</tr>
<tr>
<td>NOW()</td>
<td>返回当前的系统日期和时间</td>
</tr>
<tr>
<td>FORMAT()</td>
<td>格式化字符串的显示方式</td>
</tr>
<tr>
<td>RANDOM()</td>
<td>返回一个-9223372036854775808到9223372036854775807的伪随机数</td>
</tr>
<tr>
<td>sqlite_version()</td>
<td>返回SQLite库的版本</td>
</tr>
</tbody></table>
<h3 id="Like子句"><a href="#Like子句" class="headerlink" title="Like子句"></a>Like子句</h3><p>LIKE运算符是用来匹配通配符指定模式的文本值，有两个通配符与之配合使用：</p>
<ul>
<li><code>%</code>：代表零个、一个或多个数字或字符</li>
<li><code>_</code>：代表一个单一的数字或字符</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> colN <span class="keyword">LIKE</span> <span class="string">&#x27;XXXX%&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> colN <span class="keyword">LIKE</span> <span class="string">&#x27;XXXX_&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Glob子句"><a href="#Glob子句" class="headerlink" title="Glob子句"></a>Glob子句</h3><p>GLOB运算符是用来匹配通配符指定模式的文本值，与Like子句不同的是，它是大小写敏感的，也有两个通配符：</p>
<ul>
<li>*：代表零个、一个或多个数字或字符</li>
<li>?：代表一个单一的数字或字符</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> colN GLOB <span class="string">&#x27;XXXX*&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> colN GLOB <span class="string">&#x27;XXXX?&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Limit子句"><a href="#Limit子句" class="headerlink" title="Limit子句"></a>Limit子句</h3><p>LIMIT子句用于限制由SELECT语句返回的数据数量。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1, ... colN <span class="keyword">FROM</span> table_name LIMIT [num <span class="keyword">of</span> <span class="keyword">rows</span>]</span><br><span class="line"><span class="keyword">SELECT</span> col1, ... colN <span class="keyword">FROM</span> table_name LIMIT [num <span class="keyword">of</span> <span class="keyword">rows</span>] <span class="keyword">OFFSET</span> [<span class="type">row</span> index]</span><br></pre></td></tr></table></figure>

<h3 id="Order-By子句"><a href="#Order-By子句" class="headerlink" title="Order By子句"></a>Order By子句</h3><p>ORDER BY子句是用来指定一个或多个列按升序或降序顺序来排列返回的数据，ASC为升序，DESC为降序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span><span class="operator">-</span>list <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> <span class="keyword">condition</span>][<span class="keyword">ORDER</span> <span class="keyword">BY</span> column1, ... columnN] [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>];</span><br></pre></td></tr></table></figure>

<h3 id="GROUP-BY子句"><a href="#GROUP-BY子句" class="headerlink" title="GROUP BY子句"></a>GROUP BY子句</h3><p>GROUP BY子句用来对相同的数据进行分组。必须放在WHERE子句中的条件之后，必须放在ORDER BY子句之前。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span><span class="operator">-</span>list <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> [ conditions ] <span class="keyword">GROUP</span> <span class="keyword">BY</span> col1, ... colN <span class="keyword">ORDER</span> <span class="keyword">BY</span> col1, ... colN;</span><br></pre></td></tr></table></figure>

<h3 id="Having子句"><a href="#Having子句" class="headerlink" title="Having子句"></a>Having子句</h3><p>HAVING子句允许指定条件来过滤由GROUP BY子句创建的分组结果。HAVING子句必须放在GROUP BY子句之后，在ORDER BY子句之前。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1, column2</span><br><span class="line"><span class="keyword">FROM</span> table1, table2</span><br><span class="line"><span class="keyword">WHERE</span> [ conditions ]</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> column1, column2</span><br><span class="line"><span class="keyword">HAVING</span> [ conditions ]</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> column1, column2;</span><br></pre></td></tr></table></figure>

<h3 id="Distinct子句"><a href="#Distinct子句" class="headerlink" title="Distinct子句"></a>Distinct子句</h3><p>DISTINCT子句与SELECT语句一起使用，来消除所有重复的记录，保证唯一性。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> column1, ... columnN <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> [<span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<h3 id="Unions子句"><a href="#Unions子句" class="headerlink" title="Unions子句"></a>Unions子句</h3><p>UNION子句用于合并多个SELECT语句的结果，不返回任何重复的行。前提条件是每个SELECT被选择的列数必须是相同的，相同数目的列表达式，相同的数据类型，并确保它们有相同的顺序，但不需要具有相同的长度。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1 [, column2 ]</span><br><span class="line"><span class="keyword">FROM</span> table1 [, table2 ]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>]</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> column1 [, column2 ]</span><br><span class="line"><span class="keyword">FROM</span> table1 [, table2 ]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>]</span><br></pre></td></tr></table></figure>

<h3 id="UNION-ALL子句"><a href="#UNION-ALL子句" class="headerlink" title="UNION ALL子句"></a>UNION ALL子句</h3><p>UNION ALL用于结合两个SELECT语句的结果，包括重复行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1 [, column2 ]</span><br><span class="line"><span class="keyword">FROM</span> table1 [, table2 ]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>]</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> column1 [, column2 ]</span><br><span class="line"><span class="keyword">FROM</span> table1 [, table2 ]</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>];</span><br></pre></td></tr></table></figure>

<hr>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/sqlite/sqlite-tutorial.html">https://www.runoob.com/sqlite/sqlite-tutorial.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/sql/sql-tutorial.html">https://www.runoob.com/sql/sql-tutorial.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/cpp/shared_ptr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/cpp/shared_ptr/" class="post-title-link" itemprop="url">C++ 智能指针</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-09 19:51:44" itemprop="dateModified" datetime="2022-06-09T19:51:44+08:00">2022-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在C++中，用new和delete动态内存管理经常会出现忘记或错误释放内存问题，为了更加容易和安全的使用动态内存，才引入了智能指针。</p>
<p>智能指针就是一个类，当超出了类的作用域时，类会自动调用析构函数，析构函数会自动释放资源。智能指针通过引用计数技术来维护对象的生命周期。每当有一个新指针指向这个对象时，这个对象的引用计数就加1，相反当指针不再指向对象时，这个对象的引用计数就减1，当对象的引用计数为0时，就会自动释放。</p>
<p>智能指针访问auto_ptr的成员函数用的是<code>.</code>，访问指向对象的成员时用的是<code>-&gt;</code>。</p>
<p>智能指针限制：</p>
<ul>
<li>不能delete get()返回的指针。</li>
<li>不要把一个原始指针给多个智能指针管理。</li>
<li>不要用get()返回的原始指针去初始化或reset另一个智能指针。</li>
<li>如果使用get()返回的指针，当最后一个对应的智能指针销毁后就无效。</li>
<li>智能指针管理的资源只会默认删除new分配的内存，如果不是则需要自定义删除器作参数。</li>
</ul>
<h2 id="auto-ptr"><a href="#auto-ptr" class="headerlink" title="auto_ptr"></a>auto_ptr</h2><p>auto_ptr已经被c++11弃用。对auto_ptr进行赋值时会隐式转移所有权，如p2 = p，p2会接管p原来的内存管理权，p会变为空指针，如果p2原来不为空，则它会释放原来的资源，基于这个原因，应该避免把auto_ptr放到容器中，因为算法对容器操作时对容器实现了赋值传递操作，这样会使容器中很多元素被置为NULL。</p>
<p>判断一个auto_ptr是否为空不能使用<code>if (p == NULL)</code>，应该使用<code>if (p.get() == NULL)</code>。</p>
<p>成员函数release()会把智能指针赋值为空，但只是释放了对资源的所有权，它指向的内存并没有被释放。可以使用<code>p.reset()</code>方法来提前释放资源。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Test</span>(string s) : <span class="built_in">str_</span>(s) &#123;&#125;</span><br><span class="line">    ~<span class="built_in">Test</span>() &#123;</span><br><span class="line">        cout &lt;&lt; str_ &lt;&lt; <span class="string">&quot; destory.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Printf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;printf: &quot;</span> &lt;&lt; str_ &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string str_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">auto_ptr&lt;Test&gt; <span class="title">p1</span><span class="params">(<span class="keyword">new</span> Test(<span class="string">&quot;p1&quot;</span>))</span></span>;</span><br><span class="line">    <span class="function">auto_ptr&lt;Test&gt; <span class="title">p2</span><span class="params">(<span class="keyword">new</span> Test(<span class="string">&quot;p2&quot;</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    Test *tmp = p1.<span class="built_in">get</span>();</span><br><span class="line">    tmp-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1 = p2;</span><br><span class="line">    <span class="keyword">if</span> (p2.<span class="built_in">get</span>() == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;auto_ptr p2 is null&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">Test</span>(<span class="string">&quot;p4&quot;</span>));</span><br><span class="line">    p1-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">release</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;p.release()&quot;</span> &lt;&lt; endl;</span><br><span class="line">    p1.<span class="built_in">reset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="unique-ptr"><a href="#unique-ptr" class="headerlink" title="unique_ptr"></a>unique_ptr</h2><p>unique_ptr是独占对象所有权的智能指针，是用于取代auto_ptr的，虽然不能拷贝构造或者赋值操作，但可以通过调用release()或reset()方法将指针所有权从一个非const的unique_ptr转移给另一个unique。虽然无法使两个unique_ptr指向同一个对象，但可进行移动构造和移动赋值操作。</p>
<table>
<thead>
<tr>
<th>成员方法</th>
<th>功 能</th>
</tr>
</thead>
<tbody><tr>
<td>operator*()</td>
<td>指针解引用</td>
</tr>
<tr>
<td>swap()</td>
<td>交换2个unique_ptr 指针的内容</td>
</tr>
<tr>
<td>reset()</td>
<td>重置指针，并销毁当前unique_ptr管理的对象</td>
</tr>
<tr>
<td>release()</td>
<td>解放指针，释放所有权，并不会销毁被管理的对象，会将其返回</td>
</tr>
<tr>
<td>get()</td>
<td>获取内部包含的原生指针</td>
</tr>
<tr>
<td>operator bool()</td>
<td>判断是否为空智能指针</td>
</tr>
</tbody></table>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Test</span>(string s) : <span class="built_in">str_</span>(s) &#123;&#125;</span><br><span class="line">    ~<span class="built_in">Test</span>() &#123;</span><br><span class="line">        cout &lt;&lt; str_ &lt;&lt; <span class="string">&quot; destory.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Printf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;printf: &quot;</span> &lt;&lt; str_ &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string str_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">unique_ptr&lt;Test&gt; <span class="title">p1</span><span class="params">(<span class="keyword">new</span> Test(<span class="string">&quot;p1&quot;</span>))</span></span>;</span><br><span class="line">    unique_ptr&lt;Test&gt; p2 = <span class="built_in">make_unique</span>&lt;Test&gt;(<span class="string">&quot;p2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Test *tmp = p1.<span class="built_in">get</span>();</span><br><span class="line">    tmp-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">swap</span>(p2);</span><br><span class="line">    p1-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1 = <span class="built_in">move</span>(p2); <span class="comment">//不能直接赋值</span></span><br><span class="line">    <span class="keyword">if</span> (p2) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;unique_ptr p2 is null&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">Test</span>(<span class="string">&quot;p4&quot;</span>));</span><br><span class="line">    p1-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// auto p6 = p1.release();</span></span><br><span class="line">    <span class="comment">// p6-&gt;Printf();</span></span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">reset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="shared-ptr"><a href="#shared-ptr" class="headerlink" title="shared_ptr"></a>shared_ptr</h2><p>shared_ptr 允许多个指针指向同一个对象。</p>
<table>
<thead>
<tr>
<th>成员方法</th>
<th>功 能</th>
</tr>
</thead>
<tbody><tr>
<td>operator=()</td>
<td>赋值运算符，同一类型的 shared_ptr 智能指针可以相互赋值</td>
</tr>
<tr>
<td>operator*()</td>
<td>指针解引用</td>
</tr>
<tr>
<td>swap()</td>
<td>交换2个shared_ptr 指针的内容</td>
</tr>
<tr>
<td>reset()</td>
<td>当参数为空时，重置为一个空指针，引用计数减1；当传入新堆内存时，则获得该存储空间的所有权，并且引用计数的初始值为1</td>
</tr>
<tr>
<td>get()</td>
<td>获取内部包含的原生指针</td>
</tr>
<tr>
<td>use_count()</td>
<td>返回引用计数</td>
</tr>
<tr>
<td>unique()</td>
<td>判断是否有其它 shared_ptr 对象指向它</td>
</tr>
<tr>
<td>operator bool()</td>
<td>判断是否为空智能指针</td>
</tr>
</tbody></table>
<p>对于申请的数组内存，可以自定义释放规则:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">shared_ptr&lt;<span class="type">int</span>&gt; <span class="title">p</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>[<span class="number">10</span>], [](<span class="type">int</span>* p) &#123; <span class="keyword">delete</span>[]p; &#125;)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Test</span>(string s) : <span class="built_in">str_</span>(s) &#123;&#125;</span><br><span class="line">    ~<span class="built_in">Test</span>() &#123;</span><br><span class="line">        cout &lt;&lt; str_ &lt;&lt; <span class="string">&quot; destory.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Printf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;printf: &quot;</span> &lt;&lt; str_ &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string str_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">shared_ptr&lt;Test&gt; <span class="title">p1</span><span class="params">(<span class="keyword">new</span> Test(<span class="string">&quot;p1&quot;</span>))</span></span>;</span><br><span class="line">    shared_ptr&lt;Test&gt; p2 = <span class="built_in">make_shared</span>&lt;Test&gt;(<span class="string">&quot;p2&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!p1) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;shared_ptr p is null&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;is unique: &quot;</span> &lt;&lt; p1.<span class="built_in">unique</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; p1.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    shared_ptr&lt;Test&gt; p3 = p1;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; p1.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;is unique: &quot;</span> &lt;&lt; p1.<span class="built_in">unique</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> tmp = p1.<span class="built_in">get</span>();</span><br><span class="line">    tmp-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">swap</span>(p2);</span><br><span class="line">    p1-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">Test</span>(<span class="string">&quot;p4&quot;</span>));</span><br><span class="line">    p1-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    p1.<span class="built_in">reset</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; p1.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="dynamic-pointer-cast"><a href="#dynamic-pointer-cast" class="headerlink" title="dynamic_pointer_cast"></a>dynamic_pointer_cast</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">U</span>&gt;</span><br><span class="line">  <span class="function">shared_ptr&lt;T&gt; <span class="title">dynamic_pointer_cast</span> <span class="params">(<span class="type">const</span> shared_ptr&lt;U&gt;&amp; sp)</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>dynamic_pointer_cast常用于shared_ptr之间的类型转换，它返回一个shared_ptr副本，其存储的指针从U *动态地转换为T *。</p>
<h2 id="weak-ptr"><a href="#weak-ptr" class="headerlink" title="weak_ptr"></a>weak_ptr</h2><p>weak_ptr 是用来解决2个shared_ptr相互引用时的死锁问题的，如果两个shared_ptr相互引用，那么这两个指针的引用计数永远不可能减少为0，资源永远不会释放。weak_ptr是对对象的一种弱引用，指向shared_ptr所管理的对象，不会改变对象的引用计数，和shared_ptr之间可以相互转化。</p>
<table>
<thead>
<tr>
<th>成员方法</th>
<th>功 能</th>
</tr>
</thead>
<tbody><tr>
<td>operator=()</td>
<td>赋值运算符，可以直接被 weak_ptr 或 shared_ptr 类型指针赋值</td>
</tr>
<tr>
<td>swap()</td>
<td>互换2个weak_ptr 指针内容</td>
</tr>
<tr>
<td>use_count()</td>
<td>返回和当前 weak_ptr 指针相同指向的 shared_ptr 指针的数量，每次lock后加1</td>
</tr>
<tr>
<td>reset()</td>
<td>将当前 weak_ptr 指针置为空指针</td>
</tr>
<tr>
<td>expired()</td>
<td>判断当前 weak_ptr 指针是否过期（为空或者已经被释放）</td>
</tr>
<tr>
<td>lock()</td>
<td>返回 shared_ptr 指针，有可能为空</td>
</tr>
</tbody></table>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    shared_ptr&lt;B&gt; pb_;</span><br><span class="line">    ~<span class="built_in">A</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;A delete&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Printf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; pb_.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// shared_ptr&lt;A&gt; pa_; </span></span><br><span class="line">    weak_ptr&lt;A&gt; pa_;</span><br><span class="line">    ~<span class="built_in">B</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;B delete&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Printf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; pa_.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">shared_ptr&lt;A&gt; <span class="title">pa</span><span class="params">(<span class="keyword">new</span> A())</span></span>;</span><br><span class="line">    <span class="function">shared_ptr&lt;B&gt; <span class="title">pb</span><span class="params">(<span class="keyword">new</span> B())</span></span>;</span><br><span class="line">    pb-&gt;pa_ = pa;</span><br><span class="line">    pa-&gt;pb_ = pb;</span><br><span class="line"></span><br><span class="line">    pa-&gt;<span class="built_in">Printf</span>();</span><br><span class="line">    pb-&gt;<span class="built_in">Printf</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">weak_ptr&lt;A&gt; <span class="title">wpa</span><span class="params">(pa)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; wpa.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">auto</span> tmp = wpa.<span class="built_in">lock</span>();</span><br><span class="line">    tmp-&gt;<span class="built_in">Printf</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;use_count: &quot;</span> &lt;&lt; wpa.<span class="built_in">use_count</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;expired: &quot;</span> &lt;&lt; wpa.<span class="built_in">expired</span>() &lt;&lt; endl;</span><br><span class="line">    wpa.<span class="built_in">reset</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;expired: &quot;</span> &lt;&lt; wpa.<span class="built_in">expired</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/tool/vimium/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/tool/vimium/" class="post-title-link" itemprop="url">vimium</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Vimium 是一个浏览器扩展，它本着 Vim 编辑器的精神提供基于键盘的导航和网络控制。可通过 <a target="_blank" rel="noopener" href="https://chrome.google.com/extensions/detail/dbepggeogbaibhgnhhndojpepiihcmeb">Chrome 网上应用店</a>安装。</p>
<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><p>修饰键分别指定为<code>&lt;c-x&gt;</code>、<code>&lt;m-x&gt;</code>、 和<code>&lt;a-x&gt;</code>，分别对应ctrl+x、meta+x 和 alt+x。键入<code>?</code>可以显示快捷键列表。</p>
<p><img src="/images/tool/vimium.png" alt="img"></p>
<p><strong>当前页面操作</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">?       显示帮助对话框以获取所有可用键的列表</span><br><span class="line">h       向左滚动一点</span><br><span class="line">j       向下滚动一点</span><br><span class="line">k       向上滚动一点</span><br><span class="line">l       向右滚动一点</span><br><span class="line">gg      滚动到页面顶部</span><br><span class="line">G       滚动到页面底部</span><br><span class="line">d       向下滚动半页</span><br><span class="line">u       向上滚动半页</span><br><span class="line">f       打开元素定位器，是在当前标签页打开</span><br><span class="line">F       打开元素定位器，是在新标签页打开</span><br><span class="line">r       刷新</span><br><span class="line">gs      查看源码</span><br><span class="line">i       进入插入模式 - 在您按Esc退出之前，将忽略所有命令</span><br><span class="line">yy      将当前网址复制到剪贴板</span><br><span class="line">yf      将链接URL复制到剪贴板</span><br><span class="line">gf      循环到下一帧(尤其在选择网页内置视频的时候很管用)</span><br><span class="line">gF      聚焦主/顶框架</span><br></pre></td></tr></table></figure>

<p><strong>新页面</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">o   从URL、书签、历史记录中搜索地址，回车打开</span><br><span class="line">O   从URL、书签、历史记录中搜索地址，回车在新标签页中打开</span><br><span class="line">b   仅从书签搜索地址，回车打开</span><br><span class="line">B   仅从书签搜索地址，回车新标签页中打开</span><br><span class="line">T   搜索当前浏览器的所有标签</span><br></pre></td></tr></table></figure>

<p><strong>查找</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/       进入查找模式 - 输入您的搜索查询并按Enter键进行搜索，或按Esc键取消</span><br><span class="line">n       查找下一个匹配项</span><br><span class="line">N       查找上一个匹配项</span><br></pre></td></tr></table></figure>

<p><strong>浏览历史记录</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">H       回到历史，也就是回到前一页</span><br><span class="line">L       在历史上前进，也就是回到后一页</span><br></pre></td></tr></table></figure>

<p><strong>标签</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">J, gT   跳到左标签</span><br><span class="line">K, gt   跳到右标签</span><br><span class="line">g0      跳转到第一个标签(根据不同的数字跳到第几个标签)</span><br><span class="line">g$      跳转到最后一个标签</span><br><span class="line">^       回到上一个访问的标签</span><br><span class="line">t       创建一个新的标签</span><br><span class="line">yt      复制当前页面，在新标签页打开</span><br><span class="line">x       关闭当前标签</span><br><span class="line">X       恢复关闭的上一个标签</span><br><span class="line">p       在当前标签页打开剪切板中的URL，如不是URL则默认引擎搜索</span><br><span class="line">P       在新标签页打开剪切板中的URL，如不是URL则默认引擎搜索</span><br><span class="line">T       在当前打开的所有标签中搜索</span><br><span class="line">W       将当前标签移动到新窗口</span><br><span class="line">&lt;a-p&gt;   pin/unpin current tab</span><br></pre></td></tr></table></figure>

<p><strong>标记</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ma      设置本地标记 a</span><br><span class="line">mA      设置全局标记 A </span><br><span class="line">`a      跳转到本地标记 a</span><br><span class="line">`A      跳转到q全局标记 a</span><br><span class="line">``      跳回到跳转之前的位置 (也就是说，在执行gg，G，n，N，或/ a 之前的位置）</span><br></pre></td></tr></table></figure>

<p><strong>其他高级浏览命令</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;      当前标签页向左移动  </span><br><span class="line">&gt;&gt;      当前标签页向右移动  </span><br><span class="line">&lt;a-f&gt;   在新标签中打开多个链接</span><br><span class="line">gi      聚焦页面上的第一个（或第n个）文本输入框</span><br><span class="line">gu      跳转到URL层次的父类(xxx.com/yyy/zzz 跳转到 xxx.com/yyy)</span><br><span class="line">gU      转到URL层次结构的根目录(也就是 xxx.com)</span><br><span class="line">ge      编辑当前URL</span><br><span class="line">gE      编辑当前URL并在新选项卡中打开</span><br><span class="line">zH      向左滚动</span><br><span class="line">zL      向右滚动</span><br><span class="line">v       进入预览模式;使用p / P粘贴，然后使用y来拷贝</span><br><span class="line">V       enter visual line mode</span><br><span class="line">&lt;a-m&gt;   开/关静音 </span><br><span class="line">&lt;a-p&gt;   固定标签栏 </span><br></pre></td></tr></table></figure>

<p><strong>预览模式</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">先用 / 定位，找到想要选择的字符</span><br><span class="line">    再按 v ,进入模式</span><br><span class="line">    然后使用</span><br><span class="line">        j：向下一行</span><br><span class="line">        k：向上一行</span><br><span class="line">        h：向左一个字符或标点（数字+h，可以移动多个字符）</span><br><span class="line">        l：向右一个字符或标点（数字+l，可以移动多个字符）</span><br><span class="line">        w：下一个标点符号后位置，包括看不见的换行符</span><br><span class="line">        e：下一个标点符号前位置</span><br><span class="line">        b：取消选中上一个字符，字符和标点算一个字符</span><br></pre></td></tr></table></figure>

<p>Vimium 支持命令重复，例如，点击<code>5t</code>将快速连续打开 5 个选项卡。<code>&lt;Esc&gt;</code> (或<code>&lt;c-[&gt;</code>) 将清除队列中的任何部分命令，并且还将退出插入和查找模式。</p>
<h2 id="自定义键映射"><a href="#自定义键映射" class="headerlink" title="自定义键映射"></a>自定义键映射</h2><p>您可以在选项页面的“自定义键映射”中重新映射或取消映射任何默认键绑定。每行输入以下键映射命令之一：</p>
<ul>
<li><code>map key command</code>: 将键映射到 Vimium 命令。覆盖 Chrome 的默认行为。</li>
<li><code>unmap key</code>：取消映射键并恢复 Chrome 的默认行为。</li>
<li><code>unmapAll</code>：清除映射的所有绑定。</li>
</ul>
<p>以下特殊键可用于映射：</p>
<ul>
<li><code>&lt;c-*&gt;</code>, <code>&lt;a-*&gt;</code>, <code>&lt;m-*&gt;</code>，使用任意键替换*。</li>
<li><code>&lt;left&gt;</code>, <code>&lt;right&gt;</code>, <code>&lt;up&gt;</code>,<code>&lt;down&gt;</code>方向键。</li>
<li><code>&lt;f1&gt;</code>通过<code>&lt;f12&gt;</code>功能键</li>
<li><code>&lt;space&gt;</code> 空格键</li>
<li><code>&lt;tab&gt;</code>, <code>&lt;enter&gt;</code>, <code>&lt;delete&gt;</code>, <code>&lt;backspace&gt;</code>, <code>&lt;insert&gt;</code>,<code>&lt;home&gt;</code>和<code>&lt;end&gt;</code></li>
</ul>
<h2 id="自定义搜索引擎"><a href="#自定义搜索引擎" class="headerlink" title="自定义搜索引擎"></a>自定义搜索引擎</h2><p>配置自定义搜索引擎，通过快捷键<code>o</code>或<code>O</code>调起搜索框，输入搜索引擎简写，再输入空格，再输入搜索词回车，则会调用对应的搜索引擎进行搜索</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;搜索引擎简写&gt; &lt;搜索引擎地址&gt; &lt;搜索引擎名字&gt;</span><br><span class="line">例如：BZ https://search.bilibili.com/all?keyword=%s b站</span><br></pre></td></tr></table></figure>

<p>在插件选项Custom search engines里自定义搜索引擎配置。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">w: https://www.wikipedia.org/w/index.php?title=Special:Search&amp;search=%s Wikipedia</span><br><span class="line"></span><br><span class="line"># More examples.</span><br><span class="line">#</span><br><span class="line"># (Vimium supports search completion Wikipedia, as</span><br><span class="line"># above, and for these.)</span><br><span class="line">#</span><br><span class="line">g: https://www.google.com/search?q=%s Google</span><br><span class="line">G: https://www.google.com/search?q=%s Google</span><br><span class="line">zh: https://www.zhihu.com/search?type=content&amp;q=%s 知乎</span><br><span class="line">ZH: https://www.zhihu.com/search?type=content&amp;q=%s 知乎</span><br><span class="line">tb https://s.taobao.com/search?q=%s 淘宝</span><br><span class="line">TB https://s.taobao.com/search?q=%s 淘宝</span><br><span class="line">jd https://search.jd.com/Search?keyword=%s 京东</span><br><span class="line">JD https://search.jd.com/Search?keyword=%s 京东</span><br><span class="line">bd: https://www.baidu.com/s?wd=%s 百度</span><br><span class="line">BD: https://www.baidu.com/s?wd=%s 百度</span><br><span class="line">bz https://search.bilibili.com/all?keyword=%s b站</span><br><span class="line">BZ https://search.bilibili.com/all?keyword=%s b站</span><br><span class="line">tm https://list.tmall.com/search_product.htm?q=%s 天猫</span><br><span class="line">TM https://list.tmall.com/search_product.htm?q=%s 天猫</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/cpp/lambda/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/cpp/lambda/" class="post-title-link" itemprop="url">C++ Lambda</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-09 19:51:44" itemprop="dateModified" datetime="2022-06-09T19:51:44+08:00">2022-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>对于有捕获的lambda，其等价于对象;对于没有捕获的lambda，其等价于函数。</p>
<p>Lambda表达式完整的声明格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[capture list] (params list) mutable exception-&gt; return type &#123; function body &#125;</span><br></pre></td></tr></table></figure>

<p>其中只有捕获外部变量列表和函数体是必要的，<code>mutable</code>指示符用来说明是否可以修改捕获的变量，不管是那种捕获方式。</p>
<p>在Lambda表达式中传递参数还有一些限制：</p>
<ol>
<li>参数列表中不能有默认参数</li>
<li>不支持可变参数</li>
<li>所有参数必须有参数名</li>
</ol>
<p><strong>捕获外部变量</strong></p>
<p>Lambda表达式捕获外部变量的方式有值捕获、引用捕获、隐式捕获。</p>
<table>
<thead>
<tr>
<th>捕获形式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>[]</td>
<td>不捕获任何外部变量</td>
</tr>
<tr>
<td>[变量名, …]</td>
<td>默认以值得形式捕获指定的多个外部变量（用逗号分隔），如果引用捕获，需要&amp;显示声明</td>
</tr>
<tr>
<td>[this]</td>
<td>以值的形式捕获this指针</td>
</tr>
<tr>
<td>[=]</td>
<td>以值的形式捕获所有外部变量</td>
</tr>
<tr>
<td>[&amp;]</td>
<td>以引用形式捕获所有外部变量</td>
</tr>
<tr>
<td>[=, &amp;x]</td>
<td>变量x以引用形式捕获，其余变量以传值形式捕获</td>
</tr>
<tr>
<td>[&amp;, x]</td>
<td>变量x以值的形式捕获，其余变量以引用形式捕获</td>
</tr>
</tbody></table>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun1 = [a] &#123; cout &lt;&lt; a &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">111</span>;</span><br><span class="line"><span class="built_in">fun1</span>(); <span class="comment">// a= 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun2 = [&amp;a] &#123; cout &lt;&lt; a &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">222</span>;</span><br><span class="line"><span class="built_in">fun2</span>(); <span class="comment">// a=222</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun3 = [=] &#123; cout &lt;&lt; a &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">333</span>;</span><br><span class="line"><span class="built_in">fun3</span>(); <span class="comment">// a= 333</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun4 = [&amp;] &#123; cout &lt;&lt; a &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">444</span>;</span><br><span class="line"><span class="built_in">fun4</span>(); <span class="comment">// a=444</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun5 = [&amp;]() <span class="keyword">mutable</span> &#123; a = <span class="number">666</span>; cout &lt;&lt; a &lt;&lt; endl; &#125;;</span><br><span class="line"><span class="built_in">fun5</span>(); <span class="comment">// a=666</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">auto</span> fun7 = [a, b]() <span class="keyword">mutable</span> &#123; cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">777</span>;</span><br><span class="line"><span class="built_in">fun7</span>(); <span class="comment">// a=666 b=0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun9 = [&amp;, b]() <span class="keyword">mutable</span> &#123; cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">777</span>;</span><br><span class="line">b = <span class="number">777</span>;</span><br><span class="line"><span class="built_in">fun9</span>(); <span class="comment">// a=666 b=0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fun8 = [=, &amp;b]() <span class="keyword">mutable</span> &#123; cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl; &#125;;</span><br><span class="line">a = <span class="number">888</span>;</span><br><span class="line">b = <span class="number">888</span>;</span><br><span class="line"><span class="built_in">fun8</span>(); <span class="comment">// a=666 b=888</span></span><br></pre></td></tr></table></figure>

<p><strong>泛型lambda表达式</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/cpp/stream_string/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/cpp/stream_string/" class="post-title-link" itemprop="url">C++ stream and string</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-09 19:51:44" itemprop="dateModified" datetime="2022-06-09T19:51:44+08:00">2022-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="iostream"><a href="#iostream" class="headerlink" title="iostream"></a>iostream</h2><ul>
<li>cout 标准输出流，通常被重定向到控制台。</li>
<li>cin 标准输入流，通常用于将数据读入变量。</li>
<li>cerr 用于显示错误信息的标准输出流。</li>
<li>clog 重定向到标准错误设备，但clog对象是缓冲的，会先存储在缓冲区，直到缓冲填满或者缓冲区刷新时才会输出。</li>
<li>fstream 用于操作文件的输入和输出流，继承了 ofstream 和 ifstream。</li>
<li>ofstream 用于操作文件的输出流类，即用于创建文件。</li>
<li>ifstream 用于操作文件的输入流类，即用于读取文件。</li>
<li>stringstream 用于操作字符串的输入和输出流类，继承了 istringstream 和 ostringstream，通常用于在字符串和其他类型之间进行转换。</li>
</ul>
<p>cout、cin 和cerr 分别是流类 ostream、istream 和 ostream 的全局对象。由于是全局对象，它们在main()开始之前就已初始化。</p>
<p><img src="/images/cpp/stream_opt.png" alt="常用于流的控制符"></p>
<h3 id="cin"><a href="#cin" class="headerlink" title="cin"></a>cin</h3><p>cin可以将输入直接写入变量，也可将输入直接写入char数组，但为了避免缓冲区溢出，应该使用get()函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> val;</span><br><span class="line">cin &gt;&gt; val;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buf[<span class="number">16</span>];</span><br><span class="line">cin.<span class="built_in">get</span>(buf, <span class="number">16</span>);</span><br></pre></td></tr></table></figure>

<h2 id="fstream"><a href="#fstream" class="headerlink" title="fstream"></a>fstream</h2><p>各种模式下打开文件流：</p>
<ul>
<li><code>ios_base::app</code>: 附加到现有文件末尾,而不是覆盖它。</li>
<li><code>ios_base::ate</code>: 切换到文件末尾,但可在文件的任何地方写入数据。</li>
<li><code>ios_base::trunc</code>: 导致现有文件被覆盖,这是默认设置。</li>
<li><code>ios_base::binary</code>: 创建二进制文件(默认为文本文件)。</li>
<li><code>ios_base::in</code>: 以只读方式打开文件。</li>
<li><code>ios_base::out</code>: 以只写方式打开文件。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ofstream file;</span><br><span class="line">    file.<span class="built_in">open</span>(<span class="string">&quot;./test&quot;</span>, ios_base::out);</span><br><span class="line">    <span class="keyword">if</span> (file.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">        file &lt;&lt; <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">        file.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ifstream read;</span><br><span class="line">    read.<span class="built_in">open</span>(<span class="string">&quot;./test&quot;</span>, ios_base::in);</span><br><span class="line">    string s;</span><br><span class="line">    <span class="keyword">if</span> (read.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">        <span class="built_in">getline</span>(read, s);</span><br><span class="line">        cout &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">        read.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><p>字符串类 std::string 和 std::wstring 分别模拟了普通字符串和宽字符串，其长度可以动态增长，提供了一些方便操作的函数和运算符。</p>
<p><strong>实例化</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">string s1;</span><br><span class="line">string s2 = s1;</span><br><span class="line"><span class="function">string <span class="title">s2</span><span class="params">(s1)</span></span>;</span><br><span class="line">string s3 = <span class="string">&quot;hello&quot;</span>;  <span class="comment">//拷贝初始化</span></span><br><span class="line"><span class="function">string <span class="title">s4</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;   <span class="comment">//直接初始化</span></span><br><span class="line"><span class="function">string <span class="title">s5</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>)</span></span>;   <span class="comment">//内容是10个c</span></span><br><span class="line"><span class="function">string <span class="title">s6</span><span class="params">(s4.begin(), s4.end())</span>)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>getline</strong></p>
<p>使用getline读取一整行，保留输入的空白符，直到换行符为止。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string line;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">getline</span>(cin, line))</span><br><span class="line">&#123;</span><br><span class="line">    cout &lt;&lt; line &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可使用下标运算符<code>[]</code>获取字符，使用成员函数c_str()返回字符串指针。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/c/array-as-function-param/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/c/array-as-function-param/" class="post-title-link" itemprop="url">二维数据作函数参数</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/c%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">c语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="二维数组作为函数参数"><a href="#二维数组作为函数参数" class="headerlink" title="二维数组作为函数参数"></a>二维数组作为函数参数</h2><p><strong>1. 二维数组在栈上分配，二维数组作为参数</strong></p>
<p>在栈上分配的二维数组，其各行地址空间是连续的，可以看作是一行排列的一维数组。其中二维数组的行数是可以省略的，所以也需要将行数作为参数传递。数组作为函数参数，其实传递的是指针，sizeof一下就知道了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func1</span><span class="params">(<span class="type">char</span> <span class="built_in">array</span>[<span class="number">3</span>][<span class="number">3</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">func2</span><span class="params">(<span class="type">char</span> <span class="built_in">array</span>[][<span class="number">3</span>], <span class="type">int</span> N)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> array1[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125; &#125;;</span><br><span class="line">    func1(array1);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> array2[][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125; &#125;;</span><br><span class="line">    func2(array2, (<span class="keyword">sizeof</span>(array2) / <span class="keyword">sizeof</span>(array2[<span class="number">0</span>][<span class="number">0</span>]) / <span class="number">3</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. 二维数组在栈上分配，指向一维数组的指针作为参数</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func3</span><span class="params">(<span class="type">char</span> (*<span class="built_in">array</span>)[<span class="number">3</span>], <span class="type">int</span> N)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> array1[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125; &#125;;</span><br><span class="line">    <span class="type">char</span> (*array3)[<span class="number">3</span>] = &amp;array1[<span class="number">0</span>];</span><br><span class="line">    func3(array3, (<span class="keyword">sizeof</span>(array1) / <span class="keyword">sizeof</span>(array1[<span class="number">0</span>][<span class="number">0</span>]) / <span class="number">3</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3. 二维数组在栈上分配，指向数组类型的指针作为参数</strong></p>
<p>需要将二维数组的首元素地址、行数、列数参数传入函数，通过加减指针再解引用来获取二维数组的値。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func4</span><span class="params">(<span class="type">char</span> *<span class="built_in">array</span>, <span class="type">int</span> N, <span class="type">int</span> M)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, *(<span class="built_in">array</span> + i * M + j));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i * M + j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> array1[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125; &#125;;</span><br><span class="line">    <span class="type">char</span> *array4 = &amp;array1[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    func4(array4, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4. 二维数组在栈上分配，指向数组类型的指针的指针作为参数</strong></p>
<p>因为可以当成一维数组来看，所以p[0][n]这样的取値方式也是可以的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func5</span><span class="params">(<span class="type">char</span> **<span class="built_in">array</span>, <span class="type">int</span> N, <span class="type">int</span> M)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *p = *<span class="built_in">array</span>;</span><br><span class="line">    <span class="type">char</span> *tmp = p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        tmp = p + i * M;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, tmp[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[<span class="number">0</span>][i * M + j]);</span><br><span class="line">            <span class="comment">// printf(&quot;%d &quot;, *(*array + i * M + j));  // also</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> array1[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125; &#125;;</span><br><span class="line">    <span class="type">char</span> *array4 = &amp;array1[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    <span class="type">char</span> **array5 = &amp;array4;</span><br><span class="line">    func5(array5, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5. 在堆上分配二维数组，指向数组类型的指针的指针作为参数</strong></p>
<p>在堆上分配的二维数组，各行地址空间不一定连续，但内存是固定的，可以使用p[n][m]这样方式取数组值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">oid <span class="title function_">func6</span><span class="params">(<span class="type">char</span> **<span class="built_in">array</span>, <span class="type">int</span> N, <span class="type">int</span> M)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, *(*(<span class="built_in">array</span> + i) + j));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> **array6 = (<span class="type">char</span> **)<span class="built_in">malloc</span>(<span class="number">3</span> * <span class="keyword">sizeof</span>(<span class="type">char</span> *));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        array6[i] = (<span class="type">char</span> *)<span class="built_in">malloc</span>(i * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            array6[i][j] = i * <span class="number">3</span> + j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func6(array6, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>6. 在堆上分配一维数组当作二维数组，指向数组类型的指针的指针作为参数</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func7</span><span class="params">(<span class="type">char</span> **<span class="built_in">array</span>, <span class="type">int</span> N, <span class="type">int</span> M)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, *(*<span class="built_in">array</span> + i*M + j));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">array</span>[<span class="number">0</span>][i * M + j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *array7 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">3</span> * <span class="number">3</span> * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            array7[i * <span class="number">3</span> + j] = i * <span class="number">3</span> + j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func7(&amp;array7, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/cpp/c++14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/cpp/c++14/" class="post-title-link" itemprop="url">C++14特性</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-09 19:51:44" itemprop="dateModified" datetime="2022-06-09T19:51:44+08:00">2022-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="组块分隔符"><a href="#组块分隔符" class="headerlink" title="组块分隔符"></a>组块分隔符</h2><p>组块分隔符(chunking separator)用单引号表示，提高代码的可读性。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> pi = <span class="number">3.141&#x27;592&#x27;653&#x27;59</span>;</span><br></pre></td></tr></table></figure>

<h2 id="二进制字面量"><a href="#二进制字面量" class="headerlink" title="二进制字面量"></a>二进制字面量</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num = <span class="number">0b1010</span>; <span class="comment">// binary 1010 = decimal 10</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/cpp/c++11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/cpp/c++11/" class="post-title-link" itemprop="url">C++11特性</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-09 19:51:44" itemprop="dateModified" datetime="2022-06-09T19:51:44+08:00">2022-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="列表初始化"><a href="#列表初始化" class="headerlink" title="列表初始化"></a>列表初始化</h2><p>当大范围的变量来初始化小范围变量时，可能会有缩窄转换的风险，列表初始化将初始化的变<br>量或值放在大括号{}内，可以禁止缩窄转换。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> largeNum = <span class="number">5000000</span>;</span><br><span class="line"><span class="type">short</span> num1&#123; largeNum &#125;; <span class="comment">// warning: narrowing conversion of ‘largeNum’ from ‘int’ to ‘short int’ inside &#123; &#125; [-Wnarrowing]</span></span><br><span class="line"><span class="type">int</span> num2&#123; largeNum &#125;;   <span class="comment">// OK</span></span><br></pre></td></tr></table></figure>

<h2 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h2><p>c++11引入<code>auto</code>类型说明符，能让编译器自动表达式所属的类型。当引用被当作初始値时，以引用对象的类型作为auto的类型。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> a = <span class="literal">true</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, sizeof(a) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(a) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> b = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">auto</span> c = b;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;c = &quot;</span> &lt;&lt; c &lt;&lt; <span class="string">&quot;, sizeof(c) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(c) &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>a = 1, sizeof(a) = 1<br>c = 100, sizeof(c) = 8</p>
</blockquote>
<p>C++14可以用auto作为函数的返回类型。</p>
<h2 id="constexpr"><a href="#constexpr" class="headerlink" title="constexpr"></a>constexpr</h2><p>常量表达式是指不会改变并且在编译过程就能得到结果的表达式。constexpr变量必须在编译时初始化，而const变量的初始化可以延迟到运行时，只保证运行时不被修改。</p>
<p>constexpr函数限制：</p>
<ol>
<li>函数必须有返回値，参数是常量表达式。</li>
<li>函数体只能有一条语句，且该语句必须是return语句，但允许包含static_assert、using、typedef等不产生实际代码语句，还可以使用递归（利用三元运算符实现）。</li>
<li>只能调用constexpr函数。</li>
<li>只能使用全局constexpr变量。</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">double</span> <span class="title">GetPi</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="number">22.0</span> / <span class="number">7</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>构造函数要求：</p>
<ol>
<li>只能通过初始化列表来初始化成员变量，函数体必须为空。</li>
<li>初始化列表只能由常量表达式来赋值。</li>
</ol>
<p>常量成员函数要求：</p>
<ol>
<li>不能修改成员变量，因为其被隐式定义为const成员函数。</li>
<li>不能是virtual函数。</li>
</ol>
<h2 id="范围for循环"><a href="#范围for循环" class="headerlink" title="范围for循环"></a>范围for循环</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> array[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : array) &#123;</span><br><span class="line">    cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="override"><a href="#override" class="headerlink" title="override"></a>override</h2><p>可使用限定符 override 来核实被覆盖的函数在基类中是否被声明为virtual。让程序员能够明确地表达对基类的虚函数进行覆盖的<br>意图，进而让编译器做如下检查:<br>• 基类函数是否是虚函数。<br>• 基类中相应虚函数的特征标是否与派生类中被声明为 override 的函数完全相同。</p>
<h2 id="final"><a href="#final" class="headerlink" title="final"></a>final</h2><p>声明为 final 的类不能用作基类，从而禁止继承。被声明为 final 的虚函数，不能在派生类中进行覆盖。</p>
<h2 id="static-assert"><a href="#static-assert" class="headerlink" title="static_assert"></a>static_assert</h2><p>static_assert是编译期间断言，不生成目标代码，因此不会造成任何运行期性能损失。</p>
<blockquote>
<p>static_assert(常量表达式，”提示字符串”)</p>
</blockquote>
<p>因为是编译期的检查，这里的表达式必须是常量表达式，也就是能够在编译时计算出来的值。错误字符串也必须是字面量，不能是字符串变量。表达式计算结果为false时，编译器就会报出错误，并显示错误字符串的信息。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">static_assert</span>(<span class="built_in">sizeof</span>(<span class="type">void</span>*) == <span class="number">8</span>, <span class="string">&quot;only 64bit is supported.&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>static_assert的实现原理是利用switch的各个case表达式不能相等的机制。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> static_assert(a, b) \</span></span><br><span class="line"><span class="meta">    do &#123; switch (0) case 0: case (a): ;&#125; while(0)</span></span><br></pre></td></tr></table></figure>

<h2 id="tuple"><a href="#tuple" class="headerlink" title="tuple"></a>tuple</h2><p>tuple(元组)是泛化的std::pair，将多个值组合成一个值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">tuple&lt;<span class="type">int</span>, string&gt; <span class="title">t1</span><span class="params">(<span class="number">3</span>, <span class="string">&quot;aaa&quot;</span>)</span></span>;</span><br><span class="line">    tuple&lt;<span class="type">int</span>, string&gt; t2 = <span class="built_in">make_pair</span>(<span class="number">6</span>, <span class="string">&quot;nnn&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    string name;</span><br><span class="line">    <span class="built_in">tie</span>(num, name) = t1;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(t1) &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="built_in">get</span>&lt;<span class="number">1</span>&gt;(t1) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(t2) &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="built_in">get</span>&lt;<span class="number">1</span>&gt;(t2) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::tuple&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">divide</span><span class="params">(<span class="type">int</span> dividend, <span class="type">int</span> divisor)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  &#123;dividend / divisor, dividend % divisor&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> [quotient, remainder] = <span class="built_in">divide</span>(<span class="number">12</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h2 id="mutable"><a href="#mutable" class="headerlink" title="mutable"></a>mutable</h2><p>用<code>mutable</code>修饰的类成员称为可变数据成员，意思是这个成员不算对象内部状态，在任何函数(包括const函数)都能修改它的値。mutable不能修饰静态数据成员，因为它不属于类对象，不用修饰也可以任意修改。</p>
<h2 id="右値引用"><a href="#右値引用" class="headerlink" title="右値引用"></a>右値引用</h2><p>在赋值号左边的表达式称为<strong>左値</strong>，所有非const变量和对象，会在内存分配空间的都是左値，是可以取地址的。不能出现赋值号左边的表达式称为<strong>右値</strong>，非引用返回的或运算表达式产生的临时变量、常量、原始字面量和lambda表达式等都是右値，。</p>
<p>右值引用就是必须绑定到右值的引用，可实现转移语义，消除两个对象交互时不必要的对象拷贝，节省运算存储资源，提高效率。可以通过右値引用来延长临时变量的生命周期。定义右値引用的格式如下：</p>
<blockquote>
<p>类型 &amp;&amp;引用名 = 右值表达式;</p>
</blockquote>
<h2 id="std-move"><a href="#std-move" class="headerlink" title="std::move()"></a>std::move()</h2><p>move函数将一个左値强制转化为右值引用，继而可以通过右值引用使用该值，以用于移动语义，等同于一个类型转换：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">typename</span> remove_reference&lt;T&gt;::<span class="function">type&amp;&amp; <span class="title">move</span><span class="params">(T&amp;&amp; t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">static_cast</span>&lt;<span class="keyword">typename</span>&gt; remove_reference&lt;T&gt;::type&amp;&amp;&gt;(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数参数T&amp;&amp;是一个指向模板类型参数的右值引用，通过引用折叠，此参数左值引用和右值引用都可以绑定，称为万能引用。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">string str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">vector&lt;string&gt; vec;</span><br><span class="line">vec.<span class="built_in">push_back</span>(str);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">vec.<span class="built_in">push_back</span>(<span class="built_in">move</span>(str));</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;move...&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; endl;  <span class="comment">// str = &quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="forward"><a href="#forward" class="headerlink" title="forward()"></a>forward()</h2><p>forward函数用于完美转发，能按参数原来的类型转发到另一个函数中，如果输入参数是左値，那么传递给下一个函数的参数也是左值，反之是右値。</p>
<h2 id="enable-shared-from-this"><a href="#enable-shared-from-this" class="headerlink" title="enable_shared_from_this"></a>enable_shared_from_this</h2><p>通过继承enable_shared_from_this类，然后调用继承过来的shared_from_this()方法，就能返回一个当前类的share_ptr。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>: <span class="keyword">public</span> std::enable_shared_from_this&lt;Test&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">std::shared_ptr&lt;Test&gt; <span class="title">getSharedFromThis</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">shared_from_this</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/c/getopt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/c/getopt/" class="post-title-link" itemprop="url">getopt() 函数使用</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/c%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">c语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="getopt"><a href="#getopt" class="headerlink" title="getopt"></a>getopt</h2><p>getopt()函数用于解析命令行参数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;getopt.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">getopt</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * <span class="type">const</span> argv[], <span class="type">const</span> <span class="type">char</span> *optstring)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span> *optarg;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> optind, opterr, optopt;</span><br></pre></td></tr></table></figure>

<p><strong>参数</strong></p>
<p>argc是main()函数传递过来的参数的个数，argv通常是main()函数传递过来的参数的字符串指针数组，optstring是作为选项的字符串的列表，格式为：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>单个字符</td>
<td>表示选项，没有参数</td>
</tr>
<tr>
<td>单字符加冒号:</td>
<td>表示选项有，且必须加参数，参数紧跟其后或者以空格隔开</td>
</tr>
<tr>
<td>单字符加2冒号::</td>
<td>表示选项可以有，也可以没有，选项与参数之间无空格</td>
</tr>
</tbody></table>
<p><strong>返回值</strong></p>
<ul>
<li>如果选项成功找到，返回选项字母。</li>
<li>如果所有命令行选项都解析完毕，返回 -1。</li>
<li>如果发现无效选项字符，返回字符 ‘?’。</li>
<li>如果遇到丢失参数，那么返回值依赖于 optstring 中第一个字符，如果第一个字符是 ‘:’，则返回’:’，否则返回’?’，并提示出错误信息。</li>
</ul>
<p>它还会用到4个外部变量：</p>
<ul>
<li>optarg：如果有参数，则指向当前选项参数的指针，否则为null。</li>
<li>optind：指示下一个要解析的argv索引值，初始时为1，注意如果一个进程里用了多次getopt，则需要手动复位该值。</li>
<li>opterr：设为0时将不打印错误信息。非零时，表示无效选项或缺少参数选项，并输出错误信息。</li>
<li>optopt：包含所发现的无效选项字符。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">// #include&lt;unistd.h&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;getopt.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> opt;</span><br><span class="line">	<span class="keyword">while</span> ((opt = getopt(argc, argv, <span class="string">&quot;a::b:c:d&quot;</span>))!= <span class="number">-1</span>)</span><br><span class="line">	&#123;  </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;opt = %c\n&quot;</span>, opt);</span><br><span class="line">	    <span class="built_in">printf</span>(<span class="string">&quot;opterr = %d\n&quot;</span>, opterr);</span><br><span class="line">	    <span class="built_in">printf</span>(<span class="string">&quot;optarg = %s\n&quot;</span>, optarg);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;optind = %d\n&quot;</span>, optind);</span><br><span class="line">	    <span class="built_in">printf</span>(<span class="string">&quot;optopt = %c\n&quot;</span>, optopt);</span><br><span class="line">	&#125;  </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="getopt-long"><a href="#getopt-long" class="headerlink" title="getopt_long"></a>getopt_long</h2><p>getopt函数只能处理一个字符的参数，但类似于–help，–version这样的参数，这种参数称为长参数，对于这样的参数，只能用getopt_long函数解析。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ubun2</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">203</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ubun2</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v5.4.2
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.7.2
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
