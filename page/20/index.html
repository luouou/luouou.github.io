<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="nullptr">
<meta property="og:url" content="http://example.com/page/20/index.html">
<meta property="og:site_name" content="nullptr">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ubun2">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/20/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>nullptr</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">nullptr</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">吾生也有涯 而知也无涯</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/motor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/motor/" class="post-title-link" itemprop="url">motor</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="步进电机"><a href="#步进电机" class="headerlink" title="步进电机"></a>步进电机</h2><h3 id="24BYJ48"><a href="#24BYJ48" class="headerlink" title="24BYJ48"></a>24BYJ48</h3><p>24BYJ48-5V型号的具体含义：</p>
<pre><code>24——表示此步进电机的有效最大外径是24mm。

B——表示是步进电机，“步”字的汉语拼音（Bu）开头字母。

Y——表示该步进电机是永磁式，“永”汉语拼音（Yong）开头字母。

J——表示该步进减速电机的减速型式，“减”汉语拼音（Jian）开头字母。

那么“BYJ”合起来就表示——永磁式减速步进电机。

48——表示四相八拍。

5V——表示这个步进电机的额定电压为5V。
</code></pre>
<ul>
<li><p><strong>参数</strong></p>
<p>  减速比:1/64<br>  步距角:5.625°/64<br>  驱动方式:4相8拍<br>  直流电阻:50Ω±7%(25℃)<br>  起动转矩100PPS g.cm ≥300<br>  起动频率PPS ≥500<br>  起位转矩g.cm ≥300<br>  空载牵入频率:≥500Hz<br>  空载牵出频率:≥900Hz<br>  牵入转矩:29.4mN.m(120Hz)<br>  自定位转矩:34.3mN.m<br>  绝缘电阻:＞50MΩ(500V)<br>  绝缘介电强度:600VAC/1mA/1S<br>  绝缘等级:A<br>  温升:＜40K(120Hz)<br>  噪音:＜40dB(120Hz)<br>  重量:大约40g<br>  转向：CCW</p>
</li>
<li><p><strong>内部结构</strong></p>
</li>
</ul>
<p>内圈上面有6个齿，分别标注为0～5，这个叫做转子，转子的每个齿上都带有永久的磁性，是一块永磁体，这就是“永磁式”的概念。外圈就是定子，它是跟电机的外壳固定在一起的，上面有8个齿，而每个齿上都缠上了一个线圈绕组，正对着的2个齿上的绕组又是串联在一起的，也就是说正对着的2个绕组总是会同时导通或关断的，如此就形成了4相，在图中分别标注为 A-B-C-D，这就是“4相”的概念。</p>
<p><img src="/images/motor/24BYJ48.png" alt="步进电机内部结构示意图"></p>
<ul>
<li><strong>工作原理</strong></li>
</ul>
<p>假定电机的起始状态就如图所示，B相绕组的开关闭合，B相绕组导通，那么导通电流就会在正上和正下两个定子齿上产生磁性，这两个定子齿上的磁性就会对转子上的0和3号齿产生最强的吸引力，转子的0号齿在正上、3号齿在正下而处于平衡状态。转子的1号齿与右上的定子齿也就是C相的一个绕组呈现一个很小的夹角。</p>
<p>接下来，我们把B相绕组断开，而使C相绕组导通，右上的定子齿将对转子1号齿产生最大的吸引力，转子就转过了起始状态时1号齿和C相绕组那个夹角的角度。再接下来，断开C相绕组，导通D相绕组，过程与上述的情况完全相同，最终将使转子2、5号齿与定子D相绕组对齐，转子又转过了上述同样的角度。</p>
<p>当A相绕组再次导通，完成一个 B-C-D-A 的四节拍操作后，转子的0、3号齿将由原来对齐到B相绕组上变为了对齐到A相绕组上，即转子转过了一个定子齿的角度。依此类推，再来一个四节拍，转子就将再转过一个齿的角度，8个四节拍后转子将转过完整的一圈，那么单个节拍使转子转过的角度为360度/(8*4)=11.25度，这个值就叫做步进角度。</p>
<p>在单四拍的两个节拍之间再插入一个双绕组导通的中间节拍，组成八拍模式。新插入的节拍使转子转了单四拍模式中步进角度的一半，即5.625度，转动精度增加了一倍，而转子转动一圈则需要8*8=64拍。另外还会在原来单四拍的两个节拍引力之间又加了一把引力，从而大大增加电机的扭力。</p>
<p><img src="/images/motor/24BYJ48_p.png" alt="线序"></p>
<p><img src="/images/motor/24BYJ48_2.png" alt="励磁方式"></p>
<p>对力矩要求高使用2相励磁，对精度要求高使用1-2相励磁。</p>
<h3 id="2相4线"><a href="#2相4线" class="headerlink" title="2相4线"></a>2相4线</h3><p><img src="/images/motor/2p4l.jpeg" alt="内部结构图"></p>
<p><img src="/images/motor/2p4l.jpg" alt="规格"></p>
<h2 id="舵机"><a href="#舵机" class="headerlink" title="舵机"></a>舵机</h2><p>舵机（Servo）由直流电机、减速齿轮组、传感器和控制电路组成的一套自动控制系统。通过发送信号，指定输出轴旋转角度。最大旋转180度。与普通直流电机的区别主要在，直流电机是一圈圈转动的，舵机只能在一定角度内转动，不能一圈圈转。</p>
<p>舵机内部有一个基准电路，产生周期为20ms、宽度为1.5ms的基准信号，将获得的直流偏置电压与电位器的电压比较，获得电压差输出。经过电路板IC方向判断，再驱动无核心马达开始转动，透过减速齿轮将动力传至摆臂，同时由位置检测器送回信号，判断是否已经到位。</p>
<p>舵机转动的角度是通过调节PWM的占空比来实现的。标准的PWM信号的<strong>周期固定为20ms，高电平脉宽应该在0.5~2.5ms范围之间</strong>，脉宽与转角0°—180°相对应。</p>
<p>0.5ms————-0度</p>
<p>1.0ms————45度</p>
<p>1.5ms————90度</p>
<p>2.0ms———–135度</p>
<p>2.5ms———–180度</p>
<p>![舵机]](/images/motor/servo.gif)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/gpio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/gpio/" class="post-title-link" itemprop="url">gpio structure</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-05 16:56:47" itemprop="dateModified" datetime="2022-07-05T16:56:47+08:00">2022-07-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>TTL电平</strong></p>
<p>TTL(Transistor-Transistor Logic)晶体管-晶体管逻辑，电路规格：</p>
<ul>
<li>输出高电平&gt;=2.4V，输出低电平&lt;=0.4V；</li>
<li>输入高电平&gt;=2.0V，输入低电平&lt;=0.8V。</li>
<li>噪声容限是0.4V。</li>
</ul>
<p>开漏输出要输出高电平需要接一个上拉电阻，I2C支持多个主设备与多个从设备在一条总线上，用推挽输出，会造成主从设备之间短路，故要用开漏输出。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/net/wifi-tool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/net/wifi-tool/" class="post-title-link" itemprop="url">wifi 调试工具</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:53:37" itemprop="dateModified" datetime="2022-06-08T17:53:37+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>wext为linux-2.6.18版本之前实现方式；用户空间使用ioctl方式访问驱动，设置无线参数或者获取无线参数，配置无线驱动进行联网操作；无线驱动事件到应用层的传递采用的netlink socket技术。</p>
<p>linux-2.6.18以后wifi驱动实现方式增加了nl80211，无论是用户层访问驱动还是驱动事件通知应用层、都采用的netlink技术。</p>
<p>用<code>lsusb</code>命令查看USB ID号，无线网上的硬件id为：0bda:xxxx。</p>
<h2 id="wpa-supplicant"><a href="#wpa-supplicant" class="headerlink" title="wpa_supplicant"></a>wpa_supplicant</h2><p>支持OPEN、WEP、WPA(TKIP)、WPA2(AES)无线加密方式。下载地址：<a target="_blank" rel="noopener" href="https://w1.fi/releases/">https://w1.fi/releases/</a><br>wpa_supplicant-0.8以前的版本，编译前对.config文件进行裁剪，去掉一些功能。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#CONFIG_DRIVER_HOSTAP=y</span><br><span class="line">#CONFIG_DRIVER_ATMEL=y</span><br><span class="line">#CONFIG_DRIVER_NL80211=y</span><br><span class="line">#CONFIG_DRIVER_WIRED=y</span><br><span class="line">CONFIG_WPS=y</span><br><span class="line">CONFIG_TLS=internal</span><br><span class="line">CONFIG_INTERNAL_LIBTOMMATH=y</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp defconfig .config</span><br><span class="line">make CC=arm-himix100-linux-gcc clean</span><br><span class="line">make CC=arm-himix100-linux-gcc -j4</span><br><span class="line">arm-himix100-linux-strip wpa_supplicant</span><br></pre></td></tr></table></figure>

<p>依赖libnl，openssl，dbus库，Makefie修改：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/dbus-1.12.10/<span class="keyword">include</span>/dbus-1.0</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/dbus-1.12.10/lib -ldbus-1</span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/expat-2.2.9/<span class="keyword">include</span>/</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/expat-2.2.9/lib </span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/openssl-1.1.1/<span class="keyword">include</span></span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/openssl-1.1.1/lib </span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/libnl-3.4.0/<span class="keyword">include</span>/libnl3</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/libnl-3.4.0/lib </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.linuxfromscratch.org/blfs/view/svn/basicnet/wpa_supplicant.html">http://www.linuxfromscratch.org/blfs/view/svn/basicnet/wpa_supplicant.html</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=/var/run/wpa_supplicant/</span><br><span class="line">update_config=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">network=<span class="punctuation">&#123;</span></span><br><span class="line">    ssid=<span class="string">&quot;SECULINK  R&amp;D&quot;</span></span><br><span class="line">    scan_ssid=<span class="number">1</span></span><br><span class="line">    psk=<span class="string">&quot;secueye1&quot;</span></span><br><span class="line">    key_mgmt=WPA-PSK WPA-EAP IEEE8021X NONE</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">#连接无密码的ssid字段，需要添加key_mgmt=NONE去连接这个网络</span><br><span class="line">network=<span class="punctuation">&#123;</span></span><br><span class="line">        key_mgmt=NONE</span><br><span class="line">        ssid=<span class="string">&quot;wifi-name&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./wpa_supplicant -i wlan0 -D wext -c wpa_supplicant.conf -B -dd</span><br></pre></td></tr></table></figure>

<p>加<code>-dd</code>选项，显示调试打印。</p>
<ul>
<li><strong>错误</strong></li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">rfkill: <span class="title">Cannot</span> <span class="title">open</span> <span class="title">RFKILL</span> <span class="title">control</span> <span class="title">device</span></span></span><br></pre></td></tr></table></figure>

<p>打开rfkill失败，这是一个控制接口应该在/dev/rfkill，看了下板子上，确实没有这个设备接口。打开内核配置<code>CONFIG_RFKILL</code></p>
<h2 id="wpa-cli"><a href="#wpa-cli" class="headerlink" title="wpa_cli"></a>wpa_cli</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">wpa_cli -i wlan0 scan 　       #搜索wifi热点</span><br><span class="line">wpa_cli -i wlan0 scan_result 　#显示搜索wifi热点</span><br><span class="line">wpa_cli -i wlan0 status      　#当前WPA/EAPOL/EAP通讯状态</span><br><span class="line">wpa_cli -i wlan0 ping        　#ping wpa_supplicant</span><br><span class="line"></span><br><span class="line">wpa_cli -i wlan0 add_network   #添加一个网络连接,会返回&lt;network id&gt;</span><br><span class="line">wpa_cli set_network &lt;network id&gt; ssid &#x27;&quot;name&quot;&#x27;  #ssid名称</span><br><span class="line">wpa_cli set_network &lt;network id&gt; psk &#x27;“psk”&#x27;    #密码</span><br><span class="line">wpa_cli set_network &lt;network id&gt; scan_ssid 1</span><br><span class="line">wpa_cli set_network &lt;network id&gt; priority 1     #优先级</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接指定的ssid</span></span><br><span class="line">wpa_cli -i wlan0 select_network &lt;network id&gt;   </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接无密码热点</span></span><br><span class="line">wpa_cli set_network &lt;network id&gt; ssid &quot;wifi-name&quot;</span><br><span class="line">wpa_cli set_network &lt;network id&gt; key_mgmt NONE</span><br><span class="line">       </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">断开连接</span></span><br><span class="line">wpa_cli -i wlan0 disable_network &lt;network id&gt;   </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">信息保存到默认的配置文件中</span></span><br><span class="line">wpa_cli -i wlan0 save_config </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">列举保存过得连接</span></span><br><span class="line">wpa_cli -i wlan0 list_network     </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使能制定的ssid</span></span><br><span class="line">wpa_cli -i wlan0 enable_network &lt;network id&gt;   </span><br></pre></td></tr></table></figure>

<h2 id="iwconfig"><a href="#iwconfig" class="headerlink" title="iwconfig"></a>iwconfig</h2><p>Wireles stools用来设置支持LinuxWireless Extension的无线设备。Wireles stools for Linux 和Linux Wireless Extension 由 Jean Tourrilhes在维护，由HP惠普赞助。</p>
<p>WirelessExtension (WE)是一组通用的API，能在用户空间对通用Wireless LANs进行配置和统计。它的好处在于仅通过一组单一的工具就能对各种各样的WirelessLANs进行管理，不管它们是什么类型，只要其驱动支持WirelessExtension就行；另一个好处就是不用重启驱动或Linux就能改变这些参数。</p>
<p>WirelessTools (WT)就是用来操作Wireless Extensions的工具集，它们使用字符界面，支持所有WirelessExtension。WirelessTools包括以下工具：</p>
<p>-　iwconfig：设置基本无线参数<br>-　iwlist：扫描、列出频率，比特率，密钥等<br>-　iwspy：获取每个节点链接的质量<br>-　iwpriv：操作WirelessExtensions 特定驱动<br>-　ifrename： 基于各种静态标准命名接口</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html">https://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html</a><br>修改Makefile，编译。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CC = arm-himix100-linux-gcc</span><br><span class="line">AR = arm-himix100-linux-ar</span><br><span class="line">RANLIB = arm-himix100-linux-anlib</span><br><span class="line">BUILD_STATIC = y</span><br></pre></td></tr></table></figure>

<p>只适用于OPEN和WEP加密方式。建议用iw工具替代。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iwlist wlan0 scan   #搜索ap</span><br><span class="line">iwconfig wlan0 key &lt;psk&gt;  #验证密码</span><br><span class="line">iwconfig wlan0 key open   #密码验证功能打开</span><br><span class="line">iwconfig wlan0 essid &lt;ssid&gt;  #连接ap</span><br></pre></td></tr></table></figure>

<p>在设置监听模式之前需要将无线网卡down掉，开启监听模式再up，然后在锁定信道.。</p>
<h2 id="iw"><a href="#iw" class="headerlink" title="iw"></a>iw</h2><p>iw 是一种新的基于 nl80211 的用于无线设备的CLI配置实用程序。只能连接 OPEN和WEP 加密方式的热点。下载地址：<a target="_blank" rel="noopener" href="https://mirrors.edge.kernel.org/pub/software/network/iw/">https://mirrors.edge.kernel.org/pub/software/network/iw/</a></p>
<p>修改Makefile，依赖libnl库。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CC = arm-anykav200-linux-uclibcgnueabi-gcc</span><br><span class="line">CFLAGS += -I/home/luoyou/home/usr/anyka/libnl-3.4.0/<span class="keyword">include</span>/libnl3</span><br><span class="line">LIBS += -L/home/luoyou/home/usr/anyka/libnl-3.4.0/lib</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PKG_CONFIG_PATH=/home/luoyou/home/usr/anyka/libnl-3.4.0/lib/pkgconfig</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">iw help    # 帮助</span><br><span class="line">iw list    # 获得所有设备的功能，如带宽信息和802.11n的信息</span><br><span class="line">iw dev wlan0 scan   # 扫描</span><br><span class="line">iw event            # 监听事件 </span><br><span class="line">iw dev wlan0 link   # 获得链路状态 </span><br><span class="line"></span><br><span class="line">iw wlan0 connect &lt;essid&gt;       # 连接开放的AP</span><br><span class="line">iw wlan0 connect &lt;essid&gt; 2432  # 连接到2432频道的AP </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">连接WEP的AP，d:default, 0:第0个密码, 1:第0个密码</span></span><br><span class="line">iw wlan0 connect foo keys 0:abcde d:1:123456    </span><br><span class="line"></span><br><span class="line">iw dev wlan1 station dump    # 获取station 的统计信息</span><br><span class="line">iw dev wlan1 station get     # 获得station对应的peer统计信息</span><br><span class="line">iw wlan0 set bitrates legacy-2.4 12 18 24    # 修改传输比特率 </span><br><span class="line">iw dev wlan0 set bitrates mcs-5 4    # 修改tx HT MCS的比特率 </span><br><span class="line">iw dev wlan0 set bitrates mcs-2.4 10  </span><br><span class="line">iw dev wlan0 set bitrates mcs-5  # 清除所有tx比特率和设置的东西来恢复正常</span><br><span class="line">iw dev　set txpower  []   #设置传输功率</span><br><span class="line">iw phy　set txpower  []   #设置传输功率</span><br><span class="line">iw dev wlan0 set power_save on  #设置省电模式</span><br><span class="line">iw dev wlan0 get power_save     #查询当前的节电设定</span><br><span class="line">iw phy phy0 interface add moni0 type monitor  #添加一个monitor接口</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/phy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/phy/" class="post-title-link" itemprop="url">PHY</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PHY（Physical Layer）即物理接口收发器，它实现OSI模型的物理层。包括MII/GMII（介质独立接口）子层、PCS（物理编码子层）、PMA（物理介质附加）子层、PMD（物理介质相关）子层、MDI子层。PHY是IEEE802.3中定义的一个标准模块，STA（station management entity，管理实体，一般为MAC或CPU）通过SMI（Serial Manage Interface）对PHY的行为、状态进行管理和控制，而具体管理和控制动作是通过读写PHY内部的寄存器实现的。<br>10BaseT 和 100BaseTX PHY两种实现的帧格式是一样的，但信令机制不同，而且10BaseT采用曼彻斯特编码，100BaseTX 采用4B/5B编码。</p>
<p><img src="/images/net/phy/PHY.png" alt="img"></p>
<p>PHY里面的部分寄存器是IEEE定义的，这样PHY把自己的目前的状态反映到寄存器里面，MAC通过SMI总线不断的读取PHY的状态寄存器以得知目前PHY的状态，例如连接速度，双工的能力等。当然也可以通过SMI设置PHY的寄存器达到控制的目的，例如流控的打开关闭，自协商模式还是强制模式等。不论是物理连接的MII总线和SMI总线还是PHY的状态寄存器和控制寄存器都是有IEEE的规范的，因此不同公司的MAC和PHY一样可以协调工作。当然为了配合不同公司的PHY的自己特有的一些功能，驱动需要做相应的修改。</p>
<ul>
<li><strong>工作过程</strong></li>
</ul>
<p>PHY在发送数据的时候，收到MAC过来的数据(对PHY来说，没有帧的概念，对它来说，都是数据而不管什么地址，数据还是CRC)，每4bit就增加1bit的检错码，然后把并行数据转化为串行流数据，再按照物理层的编码规则(10Based-T的NRZ编码或100based-T的曼彻斯特编码)把数据编码，再变为模拟信号把数据送出去。收数据时的流程反之。</p>
<h2 id="PHY寄存器"><a href="#PHY寄存器" class="headerlink" title="PHY寄存器"></a>PHY寄存器</h2><p>PHY寄存器的地址空间为5位，从0到31最多可以定义32个寄存器（随着芯片功能不断增加，很多PHY芯片采用分页技术来扩展地址空间以定义更多的寄存器），IEEE802.3定义了地址为0-15这16个寄存器的功能，地址16-31的寄存器留给芯片制造商自由定义，如下表所示。</p>
<p><img src="/images/net/phy/PHY_REG.png" alt="PHY_REG"></p>
<h3 id="Control-Register-Register-0"><a href="#Control-Register-Register-0" class="headerlink" title="Control Register (Register 0)"></a>Control Register (Register 0)</h3><p>寄存器0是PHY控制寄存器，通过Control Register可以对PHY的主要工作状态进行设置。应该保证控制寄存器每个位的默认值，以便在没有管理干预的情况下，上电或复位时PHY的初始状态为正常操作状态。Control Register的每一位完成的功能见下。</p>
<p><img src="/images/net/phy/PHY_CTRL_REG.png" alt="PHY_CTRL_REG"></p>
<ul>
<li><strong>Reset：</strong> 通过将位0.15设置为逻辑1来完成复位PHY。 该操作应将状态和控制寄存器设置为其默认状态。 因此，此操作可能会改变PHY的内部状态以及与PHY关联的物理链路的状态。复位过程中Bit15保持为1，复位完成之后该位应该自动清零。在复位过程完成之前，PHY不需要接受对控制寄存器的写入操作，并且在复位过程完成之前写入0.15以外的控制寄存器位可能不起作用。 复位过程应在0.15位设置的0.5 s内完成。</li>
</ul>
<blockquote>
<p>（1）一般要改变端口的工作模式（如速率、双工、流控或协商信息等）时，在设置完相应位置的寄存器之后，需要通过Reset位复位PHY来使配置生效。<br>（2）该比特位的默认值为 0。</p>
</blockquote>
<ul>
<li><strong>Loopback：</strong> 当位0.14被设置为逻辑1时，PHY应置于环回操作模式。 当位0.14置位时，PHY接收电路应与网络介质隔离，并且MII或GMII处的TX_EN断言不应导致网络介质上的数据传输。 当位0.14置位时，PHY应接受来自MII或GMII发送数据路径的数据，并将其返回给MII或GMII接收数据路径，以响应TX_EN的断言。 当位0.14置位时，从断言TX_EN到断言RX_DV的延迟应小于512 BT。 当位0.14置位时，除非设置了位0.7，否则COL信号应始终保持无效，在这种情况下，COL信号的行为应如22.2.4.1.9所述。 清0.14位为零允许正常操作。</li>
</ul>
<p>Loopback是一个调试以及故障诊断中常用的功能，Bit14置1之后，PHY和外部MDI的连接在逻辑上将被断开，从MAC经过MII/GMII（也可能是其他的MAC/PHY接口）发送过来的数据将不会被发送到MDI上，而是在PHY内部（一般在PCS）回环到本端口的MII/GMII接收通道上，通过Loopback功能可以检查MII/GMII以及PHY接口部分是否工作正常，对于端口不通的情况可用于故障定位。</p>
<blockquote>
<p>（1）需要注意的是，很多时候PHY设置Loopback后端口可能就Link down了，MAC无法向该端口发帧，这时就需要通过设置端口Force Link up才能使用Loopback功能。<br>（2）该比特位的默认值为 0。</p>
</blockquote>
<ul>
<li><p><strong>Speed Selection：</strong> <em><strong>Bit13和Bit6两位联合实现</strong></em>对端口的速率控制功能。链接速度可以通过自动协商过程或手动速度选择来选择。 通过将位0.12清零来禁用自动协商时，允许手动速度选择。</p>
</li>
<li><p>当禁用自动协商并将位0.6清除为逻辑0时，将位0.13设置为逻辑1将PHY配置为100 Mb / s操作，并将位0.13清除为逻辑0将PHY配置为10 Mb / s操作 。</p>
</li>
<li><p>当禁用自动协商并将位0.6设置为逻辑1时，将位0.13清零为逻辑0会选择1000 Mb / s的操作。 将位0.6和0.13设置为逻辑1的组合保留用于未来的标准化。</p>
</li>
<li><p>当使能自动协商时，可以读取或写入位0.6和0.13，但位0.6和位0.13的状态对链路配置没有影响，位0.6和位0.13不需要反映当它被读取时链接。</p>
</li>
</ul>
<p>如果PHY通过比特1.15：9和比特15.15：12报告它不能工作在所有速度时，则比特0.6和0.13的值应该与PHY可以操作的速度相对应。并且任何试图将该位设置为无效的操作均将被忽略。</p>
<blockquote>
<p>（1）对Speed Selection的修改设置，往往需要复位端口才能配置生效。因此在设置该位置的时候需要检查自动协商的设置并通过Bit15复位端口。<br>（2）位0.6和0.13的默认值是根据位1.15：9和15.15：12所指示的PHY可以操作的最高数据速率的编码组合。</p>
</blockquote>
<ul>
<li><strong>Auto-Negotiation Enable：</strong> 自动协商过程应通过将位0.12设置为逻辑1来启用。 如果位0.12设置为逻辑1，则位0.13、0.8和0.6不应对链路配置和除了自动协商协议规定之外的站操作产生影响。 如果将位0.12清零为逻辑0，则无论链路配置和自动协商过程的先前状态如何，位0.13、0.8和0.6都将确定链路配置。</li>
</ul>
<p>如果PHY通过位1.3报告它缺乏执行自动协商的能力，则PHY应在位0.12返回零值。 如果PHY通过位1.3报告它缺乏执行自动协商的能力，则位0.12应该始终写为0，并且任何尝试将1写入位0.12都应该被忽略。</p>
<blockquote>
<p>必须注意的是，对于1000BASE-T接口,自动协商必须打开。</p>
</blockquote>
<ul>
<li><strong>Power Down：</strong> 通过将位0.11设置为逻辑1，可以将PHY置于低功耗状态。 清0.11位为零允许正常操作。 PHY在掉电状态下的具体行为是特定实现的。 处于掉电状态时，PHY应响应管理事务。 在转换到掉电状态期间和处于掉电状态期间，PHY不应在MII或GMII上产生寄生信号。</li>
</ul>
<p>当位0.11或位0.10被设置为逻辑1时，PHY不需要满足RX_CLK和TX_CLK信号功能要求。 在位0.11和0.10清零后，PHY应在0.5 s内满足22.2.2中定义的RX_CLK和TX_CLK信号功能要求。</p>
<blockquote>
<p>（1）Power Down模式一般在软件shut down端口的时候使用，需要注意的是端口从Power Down模式恢复，需要复位端口以保证端口可靠的连接。<br>（2）该位的默认值为 0。</p>
</blockquote>
<ul>
<li><strong>Isolate：</strong> 通过将位0.10设置为逻辑1，PHY可能被迫将其数据路径与MII或GMII电隔离。 清零位0.10允许正常操作。 当PHY与MII或GMII隔离时，它不会响应TXD数据包和TX_EN，TX_ER、GTX_CLK的输入。并且它的TX_CLK，RX_CLK，RX_DV，RX_ER，RXD数据包、COL和CRS输出均应为高阻态。 当PHY与MII或GMII隔离时，它将响应管理事务（MDC/MDIO接口的信号）。</li>
</ul>
<blockquote>
<p>（1）IEEE802.3没有对Isolate 时MDI接口的状态进行规范，此时MDI端可能还在正常运行。Isolate在实际应用中并没有用到。<br>（2）由于目前很多百兆的PHY芯片其MAC接口主流的都是SMII/S3MII，8个端口的接口是相互关联的，一个端口设置Isolate可能会影响其他端口的正常使用，因此在使用中注意不要随意更改bit10的状态。</p>
</blockquote>
<ul>
<li><strong>Restart Auto-Negotiation：</strong> 如果PHY通过位1.3报告它缺乏执行自动协商的能力，或者如果自动协商被禁用，则PHY应在位0.9返回零值。 如果PHY通过位1.3报告它缺乏执行自动协商的能力，或者如果禁用了自动协商，则应将位0.9始终写为0，并且任何尝试将1写入位0.9应被忽略。</li>
</ul>
<p>Bit9置1将重新启动端口的自动协商进程，当然前提是Auto-Negotiation Enable是使能的。</p>
<blockquote>
<p>一般在修改端口的自动协商能力信息之后通过Bit9置1重新启动自动协商来使端口按照新的配置建立link。</p>
</blockquote>
<ul>
<li><strong>Duplex Mode：</strong> 可以通过自动协商过程或手动双面选择来选择双工模式。 通过将位0.12清零来禁用自动协商时，允许手动双面选择。</li>
</ul>
<ul>
<li>当禁用自动协商时，将位0.8设置为逻辑1将PHY配置为全双工操作，并将位0.8清零以将逻辑0配置为用于半双工操作的PHY。</li>
<li>当启用自动协商时，可以读取或写入位0.8，但位0.8的状态对链路配置没有影响。</li>
</ul>
<p>如果PHY通过位1.15：9和15.15：12报告它只能在一个双工模式下工作，则位0.8的值应该与PHY可以工作的模式相对应，并且任何尝试改变将该位0.8修改为无效指的操作应被忽略。</p>
<blockquote>
<p>对Duplex Mode的修改配置也需要复位端口才能生效。</p>
</blockquote>
<ul>
<li><strong>Collision Test：</strong> 冲突信号（COL）测试开关。在需要对COL信号进行测试时，可以通过Bit7置1，这时PHY将输出一个COL脉冲以供测试。实际测试操作中也可以将端口配置为半双工状态，通过发帧冲突来测试COL信号，因此该配置实用价值不大。</li>
<li><strong>Unidirectional enable：</strong> 如果PHY通过比特1.7报告它不具备编码和传输来自媒体独立接口的数据的能力，而不管PHY是否确定已建立有效链路，则PHY应在比特0.5中返回零值，并且 任何尝试写一个到位0.5应该被忽略。</li>
</ul>
<h3 id="Status-register"><a href="#Status-register" class="headerlink" title="Status register"></a>Status register</h3><p>寄存器1是PHY状态寄存器，主要包含PHY的状态信息，大多数bit的值都是由芯片厂家确定的，每一个bit的功能在表3种已有详细说明。</p>
<p><img src="/images/net/phy/PHY_STA_REG.png" alt="PHY_STA_REG"></p>
<ul>
<li><strong>100BASE-T4 ability：</strong> 当读为逻辑1时，位1.15指示PHY有能力使用100BASE-T4信令规范执行链路发送和接收。 当读为逻辑0时，位1.15表示PHY缺乏使用100BASE-T4信令规范执行链路发送和接收的能力。</li>
<li><strong>100BASE-X full duplex ability：</strong> 当读为逻辑1时，位1.14指示PHY有能力使用100BASE-X信令规范执行全双工链路传输和接收。 当作为逻辑0读取时，bit1.14表示PHY缺乏使用100BASE-X信令规范执行全双工链路传输和接收的能力。</li>
<li><strong>100BASE-X half duplex ability：</strong> 当读为逻辑1时，位1.13指示PHY有能力使用100BASE-X信令规范执行半双工链路传输和接收。 当读为逻辑0时，位1.13指示PHY缺乏使用100BASE-X信令规范执行半双工链路传输和接收的能力。</li>
<li><strong>Unidirectional ability：</strong> 当读为逻辑1时，位1.7指示PHY具有编码和传输来自媒体独立接口的数据的能力，而不管PHY是否确定已建立有效链路。 当读为逻辑0时，位1.7指示PHY只有在PHY确定已建立有效链路时才能从媒体独立接口传输数据。</li>
<li><strong>MF preamble suppression ability：</strong> 当读为逻辑1时，位1.6指示PHY能够接受管理帧，而不管它们是否在22.2.4.5.2中描述的前导码模式之前。 当读为逻辑0时，位1.6指示PHY不能接受管理帧，除非它们之前是22.2.4.5.2中描述的前导码模式。</li>
<li><strong>Auto-Negotiation Complete：</strong> 当读为逻辑1时，位1.5指示自动协商过程已完成，并且由自动协商协议（条款28或条款37）实施的扩展寄存器的内容是有效的。 当读为逻辑0时，位1.5指示自动协商过程尚未完成，并且扩展寄存器的内容由自动协商协议的当前状态定义，或者为手动配置写入。 如果自动协商通过清除位0.12禁用，则PHY应在位1.5返回零值。 如果PHY缺乏执行自动协商的能力，它还应在位1.5返回零值。</li>
</ul>
<blockquote>
<p>在调试以及异常故障处理时，可以通过该位寄存器的状态判断AN是否成功，从而进一步的检查AN相关的设置是否正确，或者芯片的AN功能是否正常等。</p>
</blockquote>
<ul>
<li><strong>Remote Fault：</strong> 当读为逻辑1时，位1.4表示检测到远程故障状态。 故障类型以及故障检测的标准和方法是PHY特定的。 远程故障位必须使用锁存功能来实现，以便发生远程故障将导致远程故障位置位，并保持置位状态直至被清除。 每当通过管理接口读取寄存器1时，远程故障位应清零，并且还应通过PHY复位清零。</li>
</ul>
<p>远端错误指示位。Bit4=1代表连接对端（Link Partner）出错，至于出错的具体类型以及错误检测机制在规范中并没有定义，由PHY的制造商自由发挥，一般的厂商都会在其他的寄存器（Register16-31由厂商自行定义）指示比较详细的错误类型。在与端口相关的故障查证中，Remote Fault是一个重要的指示信息，通过互联双方的Remote Fault信息（可能要加上其他的具体错误指示），可以帮助定位故障原因。</p>
<ul>
<li><p><strong>Auto-Negotiation ability：</strong> 当读为逻辑1时，位1.3指示PHY有能力执行自动协商。 当读为逻辑0时，位1.3指示PHY缺乏执行自动协商的能力。</p>
</li>
<li><p><strong>Link Status：</strong> 当读为逻辑1时，位1.2指示PHY已经确定已建立有效链路。 当作为逻辑0读取时，位1.2指示该链接无效。 确定链路有效性的标准是PHY特定的。 链路状态位应该使用锁存功能来实现，以便发生链路故障情况将导致链路状态位清零并保持清零，直到通过管理接口读取。 此状态指示旨在支持在30.5.1.1.4，aMediaAvailable中定义的管理属性。</p>
</li>
</ul>
<p>实际应用中一般都是通过Bit2来判断端口的状态。而且，一般的MAC芯片也是通过轮询PHY的这个寄存器值来判断端口的Link状态的（这个过程可能有不同的名称，比如BCM叫做Link Scan，而Marvell叫做PHY Polling。）如前所述，在AN Enable的情况下，Link Status的信息只有在Auto-Negotiation Complete指示已经完成的情况下才是正确可靠的，否则有可能出错。</p>
<ul>
<li><strong>Jabber Detect：</strong> 当作为逻辑1读取时，位1.1指示已经检测到爆音条件。 此状态指示旨在支持30.5.1.1.6中定义的管理属性，aJabber和30.5.1.3.1 nJabber中定义的MAU通知。 检测Jabber条件的标准是PHY特定的。 Jabber检测位应该使用锁存功能来实现，以便发生Jabber条件将导致Jabber检测位置位，并保持置位状态直至被清除。 每次通过管理接口读取寄存器1时，Jabber检测位应清零，并且还应通过PHY复位清零。</li>
</ul>
<p>IEEE802.3对Jabber的解释是“A condition wherein a station transmits for a period of time longer than the maximum permissible packet length, usually due to a fault condition”。这一位指示的是Link Partner发送的时间超过了规定的最大长度。值得注意的是，Jabber Detect只有在10BASE-T模式下才有意义，100和1000M模式是没有定义Jabber这一功能的。</p>
<h3 id="PHY-Identifier-Register"><a href="#PHY-Identifier-Register" class="headerlink" title="PHY Identifier Register"></a>PHY Identifier Register</h3><p>寄存器2和3存放PHY芯片的型号代码，寄存器2(PHY ID1)为高16位，而寄存器3(PHY ID2)为低16位。由芯片制造商自行定义，实际应用中软件通过读取这两个寄存器的内容可以识别PHY的型号和版本。</p>
<p>PHY标识符应由由IEEE分配给PHY制造商的组织唯一标识符（OUI）的（<em>只需要使用第3至第24位，共22位</em>），加上6位制造商的型号以及4位制造商的修订版编号组成。 PHY标识符旨在提供足够的信息来支持30.1.2中所要求的oResourceTypeID对象。</p>
<p>OUI的第三位分配给位2.15，OUI的第四位分配给位2.14，依此类推。 位2.0包含OUI的第十八位。 位3.15包含OUI的第十九位，位3.10包含OUI的第二十四位。 位3.9包含制造商型号的MSB。 位3.4包含制造商型号的LSB。 位3.3包含制造商版本号的MSB，位3.0包含制造商版本号的LSB。具体如下图所示：</p>
<p><img src="/images/net/phy/PHY_ID_REG.png" alt="PHY_ID_REG"></p>
<h3 id="Auto-Negotiation-Advertisement-Register-Register-4-R-W"><a href="#Auto-Negotiation-Advertisement-Register-Register-4-R-W" class="headerlink" title="Auto-Negotiation Advertisement Register (Register 4) (R/W)"></a>Auto-Negotiation Advertisement Register (Register 4) (R/W)</h3><p>寄存器4是自动协商的能力通告寄存器，在AN Enable的前提下（见寄存器0），端口根据该寄存器的相关配置将自动协商信息通过FLP在MDI上进行通告。当AN配置为Disable状态的时候，寄存器4的配置将不起作用，端口的工作模式由控制寄存器中的配置决定。</p>
<p>该寄存器包含PHY的通告能力，它们将在自动协商期间传送给其链接伙伴。 基本页的位定义在IEEE标准的28.2.1.2中定义。 上电时，在自动协商开始之前，该寄存器应具有以下默认配置：</p>
<ul>
<li><strong>Selector Field （4.4：0）：</strong> 被设置为适当的代码，如IEEE标准的附件28A中所规定。</li>
<li><strong>Reserved（4.14）：</strong> 被设置为逻辑0。</li>
<li><strong>Technology Ability Field（4.11：5）：</strong> <em><strong>根据MII状态寄存器（寄存器1）（1.15：11）中设置的值或等效值设置</strong></em>。 另见28.2.1.2.3和附件28D。</li>
</ul>
<p><img src="/images/net/phy/PHY_REG_4.png" alt="PHY_REG_4"></p>
<h3 id="Link-codeword-encoding（基本链路码字）"><a href="#Link-codeword-encoding（基本链路码字）" class="headerlink" title="Link codeword encoding（基本链路码字）"></a>Link codeword encoding（基本链路码字）</h3><p>在FLP Burst内传输的基本链路代码字（基本页面）应该传达如图28-7所示的编码。 自动协商功能可以使用下一页功能支持其他页面。 下一页交换中使用的链接代码字的编码在28.2.3.4中定义。 在FLP Burst中，D0应该是第一个传输的位。</p>
<p><img src="/images/net/phy/20180428154543415.png" alt="这里写图片描述"></p>
<h3 id="Next-Page-function"><a href="#Next-Page-function" class="headerlink" title="Next Page function"></a>Next Page function</h3><p>下一页功能使用标准的自动协商仲裁机制来允许交换任意的数据。 数据由可选的下一页信息携带，其遵循用于基本链接码字的传输和确认过程。 定义了四种类型的下一页编码：消息页面，未格式化页面，扩展消息页面和扩展的未格式化页面。</p>
<p>关于该部分，具体见IEEE标准的<strong>28.2.3.4 Next Page function</strong>。</p>
<p>在IEEE标准中，Auto-Negotiation Advertisement Register中的各部分全部是在独立章节中进行介绍的。具体如下：</p>
<ul>
<li><strong>Selector Field：</strong> 选择器字段（S [4：0]）是一个5位宽的字段，编码32个可能的消息。 链路码字中的选择器字段S [4：0]应用于识别自动协商发送的消息的类型。 下表列出了可能发送的消息的类型。 随着新消息的发展，该表格将相应更新。</li>
</ul>
<p><img src="/images/net/phy/20180428155653138.png" alt="Selector Field"></p>
<p>未指定的组合保留供将来使用。 不会传输选择器字段的预留组合。<em><strong>我们所接触的以太网PHY遵从IEEE802.3规范，Selector Field=0001，该区域不可随意更改（很多PHY将此区域设计为只读寄存器，以免被修改）</strong></em>。</p>
<ul>
<li><strong>Technology Ability Field：</strong> 技术能力字段（A [6：0]）是一个7位宽的字段，其中包含指示选择器字段值特定的支持技术的信息。 这些位被映射到各个技术，以便能够针对单个选择器字段值并行通告能力。 附录28B.2和附件28D描述了IEEE 802.3选择器的技术能力字段编码。 链接代码字中可能会公布多种技术。 设备应支持其宣传的技术的数据服务能力。</li>
</ul>
<p><img src="/images/net/phy/20180428152215994.png" alt="Technology Ability Field"></p>
<ul>
<li><p><strong>Extended Next Page：</strong> 扩展下一页（XNP）被编码在基本链路码字的位D12中。 扩展下一页位指示本地设备在设置为逻辑1时支持扩展下一页的传输，并指示本地设备在设置为逻辑0时不支持扩展下一页。 Extended Next Page的使用与协商的数据速率，媒体或链接技术是正交的。 扩展下一页位按照28.2.3.4中的扩展下一页功能规范使用。</p>
</li>
<li><p><strong>Next Page：</strong> 无论选择器字段值还是链接码字编码，下一页（NP）都在D15位编码。 支持附加链接码字编码的传输和接收是可选的。 如果不支持Next Page功能，NP位应始终设置为逻辑0。 如果设备实现下一页功能并希望进行下一页交换，则应将NP位设置为逻辑1。 设备可以实现下一页功能，并通过将NP位设置为逻辑0来选择不参与下一页交换。 下一页功能在28.2.3.4中定义。</p>
</li>
<li><p><strong>Remote Fault：</strong> 远程故障（RF）编码在基本链路码字的位D13中。 默认值是逻辑零。 远程故障位为传输简单的故障信息提供了一种标准的传输机制。 当自动协商通告寄存器（寄存器4）中的RF位设置为逻辑1时，发送的基本链路码字中的RF位被设置为逻辑1。 当接收到的基本链路代码字中的RF位被设置为逻辑1时，如果存在MII管理功能，则MII状态寄存器（寄存器1）中的远程故障位将被设置为逻辑1。</p>
</li>
</ul>
<h3 id="Auto-Negotiation-Link-Partner-ability-register-Register-5-RO"><a href="#Auto-Negotiation-Link-Partner-ability-register-Register-5-RO" class="headerlink" title="Auto-Negotiation Link Partner ability register (Register 5) (RO)"></a>Auto-Negotiation Link Partner ability register (Register 5) (RO)</h3><p>寄存器5保存的是本端PHY接收到的对端PHY所通告的端口能力，寄存器5的结构和寄存器4基本一致。</p>
<h3 id="Auto-Negotiation-Expansion-Register-Register-6-RO"><a href="#Auto-Negotiation-Expansion-Register-Register-6-RO" class="headerlink" title="Auto-Negotiation Expansion Register (Register 6) (RO)"></a>Auto-Negotiation Expansion Register (Register 6) (RO)</h3><p>寄存器6保存了PHY自动协商过程的异常信息。从这个寄存其中我们可以获取到Link Partner子否支持自动协商以及自动协商下一页有没有收到的信息。</p>
<p><img src="/images/net/phy/20180428163901700.png" alt="Auto-Negotiation Expansion Register"></p>
<h3 id="Auto-Negotiation-Next-Page-transmit-register-Register-7-R-W"><a href="#Auto-Negotiation-Next-Page-transmit-register-Register-7-R-W" class="headerlink" title="Auto-Negotiation Next Page transmit register (Register 7) (R/W)"></a>Auto-Negotiation Next Page transmit register (Register 7) (R/W)</h3><p>自动协商下一页发送寄存器包含在支持下一页功能时要发送的下一页链接码字。 （见表28-6）内容在28.2.3.4中定义。 上电时，该寄存器应包含默认值2001H，该值表示消息代码设置为Null消息的消息页面。 该值可以由设备希望传输的任何有效的下一页消息代码替换。 写入该寄存器应将mr_next_page_loaded设置为true。</p>
<p><img src="/images/net/phy/2018042816462224.png" alt="Register 7"></p>
<h3 id="Auto-Negotiation-Link-Partner-Received-Next-Page-register-Register-8-RO"><a href="#Auto-Negotiation-Link-Partner-Received-Next-Page-register-Register-8-RO" class="headerlink" title="Auto-Negotiation Link Partner Received Next Page register (Register 8) (RO)"></a>Auto-Negotiation Link Partner Received Next Page register (Register 8) (RO)</h3><p><img src="/images/net/phy/20180428164942266.png" alt="Register 8"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/mii/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/mii/" class="post-title-link" itemprop="url">Media Independent Interface</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="MII"><a href="#MII" class="headerlink" title="MII"></a>MII</h2><p>MII（Media Independent Interface）即媒体独立接口，MII接口是MAC与PHY连接的标准接口。它是IEEE-802.3定义的以太网行业标准。MII接口提供了MAC与PHY之间、PHY与STA(Station Management)之间的互联技术，该接口支持10Mb/s与100Mb/s的数据传输速率，单向传输的数据线有4根，整个接口由14根线组成。媒体独立的意思，是指不管铜轴、光纤、电缆等媒体的变化，媒体处理的相关工作都由PHY和MAC的芯片完成。</p>
<p>MII接口主要包括四个部分。一是从MAC层到PHY层的发送数据接口，二是从PHY层到MAC层的接收数据接口，三是从PHY层到MAC层的状态指示信号，四是MAC层和PHY层之间传送控制和状态信息的MDIO接口。</p>
<p><img src="/images/net/mii/MII.jpg" alt="MII"></p>
<ul>
<li><p>TXD[3:0]：数据发送信号，共4根信号线；</p>
</li>
<li><p>TX_CLK：发送数据使用的时钟信号，对于10M位/s的数据传输，此时钟为2.5MHz，对于100M位/s的数据传输，此时钟为25MHz。</p>
</li>
<li><p>TX_ER（transmit coding error）： TX_ER同步于TX_CLK，在数据传输过程中，如果TX_ER有效超过一个时钟周期，并且此时TX_EN是有效的，则数据通道中传输的数据是无效的，没用的。注：当TX_ER有效并不影响工作在10Mb/s的PHY或者TX_EN无效时的数据传输。在MII接口的连线中，如果TX_ER信号线没有用到，必须将它下拉接地。</p>
</li>
<li><p>TX_EN：传输使能信号，此信号必需与数据前导符的起始位同步出现，并在传输完毕前一直保持。</p>
</li>
<li><p>TXD[3:0]：发送数据线，每次传输4位数据，数据在TX_EN信号有效时有效。当TX_EN信号无效时，PHY忽略传输的数据。</p>
</li>
<li><p>RX_CLK：接收数据使用的时钟信号，对于10M位/s的数据传输，此时钟为2.5MHz，对于100M位/s的数据传输，此时钟为25MHz。</p>
</li>
<li><p>RXD[3:0]：接收数据线，每次接收4位数据，数据在RX_DV信号有效时有效。当RX_EN无效，而RX_ER有效时，RXD[3:0]数据值代表特定的信息。</p>
</li>
<li><p>RX_DV：接收数据使能信号，由PHY控制，当PHY准备好数据供MAC接收时，使能该信号。此信号必需和帧数据的首位同步出现，并保持有效直到数据传输完成。在传送最后4位数据后的第一个时钟之前，此信号必需变为无效状态。为了正确的接收一个帧，有效电平不能滞后于数据线上的SFD位出现。</p>
</li>
<li><p>RX_ER：接收出错信号，保持一个或多个时钟周期(RX_CLK)的有效状态，表明MAC在接收过程中检测到错误。具体错误原因需配合RX_DV的状态及RXD[3:0]的数据值。</p>
</li>
<li><p>CRS：载波侦听信号，仅工作在半双工模式下，由PHY控制，当发送或接收的介质非空闲时，使能此信号。 PHY必需保证CRS信号在发生冲突的整个时间段内都保持有效，不需要此信号与发送/接收的时钟同步。</p>
</li>
<li><p>COL：冲突检测信号，仅工作在半双工模式下，由PHY控制，当检测到介质发生冲突时，使能此信号，并且在整个冲突的持续时间内，保持此信号有效。此信号不需要和发送/接收的时钟同步。</p>
</li>
<li><p>MDC：配置接口时钟。</p>
</li>
<li><p>MDIO：配置接口I/O，是PHY和STA之间的双向信号。 它用于在PHY和STA之间传输控制信息和状态。 控制信息由STA同步地针对MDC驱动并且由PHY同步地采样。 状态信息由PHY针对MDC同步驱动并由STA同步采样。需要1.5K电阻上拉。</p>
</li>
</ul>
<p>MII接口的类型有很多，常用的有MII、RMII、SMII、SSMII、SSSMII、GMII、RGMII、SGMII、TBI、RTBI、XGMII、XAUI、XLAUI等。</p>
<table>
<thead>
<tr>
<th></th>
<th>MII</th>
<th>RMII</th>
<th>GMII</th>
<th>RGMII</th>
<th>SMII</th>
</tr>
</thead>
<tbody><tr>
<td>传输速度</td>
<td>100/10M</td>
<td>100/10M</td>
<td>1000/100/10M</td>
<td>1000/100/10M</td>
<td>100M</td>
</tr>
<tr>
<td>单向数据线数</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>时钟速率</td>
<td>25/2.5M</td>
<td>50/5M</td>
<td>25/2.5M</td>
<td>125/25/2.5M</td>
<td>125M</td>
</tr>
</tbody></table>
<h2 id="RMII"><a href="#RMII" class="headerlink" title="RMII"></a>RMII</h2><p>RMII即Reduced MII，是简化的MII接口。连线数量由MII的16根减少为8根，对于10Mbps线速，MII的时钟速率是2.5MHz就可以了，RMII则需要5MHz；对于100Mbps线速，MII需要的时钟速率是25MHz，RMII则是50MHz。</p>
<p><img src="/images/net/mii/RMII.jpg" alt="RMII"></p>
<ul>
<li><p>TXD[1:0]：数据发送信号线，数据位宽为2</p>
</li>
<li><p>RXD[1:0]：数据接收信号线，数据位宽为2</p>
</li>
<li><p>TX_EN(Transmit Enable)：数据发送使能信号</p>
</li>
<li><p>RX_ER(Receive Error)：数据接收错误提示信号</p>
</li>
<li><p>CLK_REF：是由外部时钟源提供的50MHz参考时钟，与MII接口不同，MII接口中的接收时钟和发送时钟是分开的，而且都是由PHY芯片提供给MAC芯片的。这里需要注意的是，由于数据接收时钟是由外部晶振提供而不是由载波信号提取的，所以在PHY层芯片内的数据接收部分需要设计一个FIFO，用来协调两个不同的时钟,在发送接收的数据时提供缓冲。PHY层芯片的发送部分则不需要FIFO，它直接将接收到的数据发送到MAC就可以了。</p>
</li>
<li><p>CRS_DV：此信号是由MII接口中的RX_DV和CRS两个信号合并而成。当介质不空闲时，CRS_DV和RE_CLK相异步的方式给出。当CRS比RX_DV早结束时(即载波消失而队列中还有数据要传输时)，就会出现CRS_DV在半位元组的边界以25MHz/2.5MHz的频率在0、1之间的来回切换。因此，MAC能够从 CRS_DV中精确的恢复出RX_DV和CRS。</p>
</li>
</ul>
<p>在100Mbps速率时，TX/RX每个时钟周期采样一个数据；在10Mbps速率时，TX/RX每隔10个周期采样一个数据，因而TX/RX数据需要在数据线上保留10个周期，相当于一个数据发送10次。</p>
<p>当PHY层芯片收到有效的载波信号后，CRS_DV信号变为有效，此时如果FIFO中还没有数据，则它会发送出全0的数据给MAC，然后当FIFO中填入有效的数据帧，数据帧的开头是“101010—”交叉的前导码，当数据中出现“01”的比特时，代表正式数据传输开始，MAC芯片检测到这一变化，从而开始接收数据。</p>
<p>当外部载波信号消失后，CRS_DV会变为无效，但如果FIFO中还有数据要发送时，CRS_DV在下一周期又会变为有效，然后再无效再有效，直到FIFO中数据发送完为止。在接收过程中如果出现无效的载波信号或者无效的数据编码，则RX_ER会变为有效，表示物理层芯片接收出错。</p>
<h2 id="SMII"><a href="#SMII" class="headerlink" title="SMII"></a>SMII</h2><p>SMII即Serial MII，串行MII的意思，跟RMII相比，连线进一步减少到4根。只用一根信号线传送发送数据，一根信号线传输接受数据，所以在时钟上为了满足100的需求，它的时钟频率高达到125M，数据线里面还会传送一些控制信息。所有端口的数据收发都公用同一个外部的125M时钟。</p>
<p><img src="/images/net/mii/SMII.jpg" alt="SMII"></p>
<ul>
<li>TXD：发送数据信号，位宽为1；</li>
<li>RXD：接收数据信号，位宽为1；</li>
<li>SYNC：收发数据同步信号，每10个时钟周期置1次高电平，指示同步。</li>
<li>CLK_REF：所有端口共用的一个参考时钟，频率为125MHz，为什么100Mbps速率要用125MHz时钟？因为在每8位数据中会插入2位控制信号，请看下面介绍。</li>
</ul>
<p>TXD/RXD以10比特为一组，以SYNC为高电平来指示一组数据的开始，在SYNC变高后的10个时钟周期内，TXD上依次输出的数据是：TXD[7:0]、TX_EN、TX_ER，控制信号的含义与MII接口中的相同；RXD上依次输出的数据是：RXD[7:0]、RX_DV、CRS，RXD[7:0]的含义与RX_DV有关，当RX_DV为有效时(高电平)，RXD[7:0]上传输的是物理层接收的数据。当RX_DV为无效时(低电平)，RXD[7:0]上传输的是物理层的状态信息数据。见下表：</p>
<p><img src="/images/net/mii/SMII2.jpg" alt="img"></p>
<p>当速率为10Mbps时，每一组数据要重复10次，MAC/PHY芯片每10个周期采样一次。MAC/PHY芯片在接收到数据后会进行串/并转换。</p>
<h2 id="SSMII"><a href="#SSMII" class="headerlink" title="SSMII"></a>SSMII</h2><p>SSMII即Serial Sync MII，叫串行同步接口，跟SMII接口很类似，只是收发使用独立的参考时钟和同步时钟，不再像SMII那样收发共用参考时钟和同步时钟，传输距离比SMII更远。</p>
<p><img src="/images/net/mii/SSMII.jpg" alt="img"></p>
<h2 id="SSSMII"><a href="#SSSMII" class="headerlink" title="SSSMII"></a>SSSMII</h2><p>SSSMII即Source Sync Serial MII，叫源同步串行MII接口，SSSMII与SSMII的区别在于参考时钟和同步时钟的方向，SSMII的TX/RX参考时钟和同步时钟都是由PHY芯片提供的，而SSSMII的TX参考时钟和同步时钟是由MAC芯片提供的，RX参考时钟和同步时钟是由PHY芯片提供的，所以顾名思义叫源同步串行。</p>
<p><img src="/images/net/mii/SSSMII.jpg" alt="img"></p>
<h2 id="GMII"><a href="#GMII" class="headerlink" title="GMII"></a>GMII</h2><p>GMII(Gigabit MII)是千兆网的MII接口。GMII采用8位接口数据，工作时钟125MHz，因此传输速率可达1000Mbps。同时兼容MII所规定的10/100 Mbps工作方式。GMII接口数据结构符合IEEE 802.3-2000以太网标准。</p>
<p>与MII接口相比，GMII的数据宽度由4位变为8位，GMII接口中的控制信号如TX_ER、TX_EN、RX_ER、RX_DV、CRS和COL的作用同MII接口中的一样，发送参考时钟GTX_CLK和接收参考时钟RX_CLK的频率均为125MHz(1000Mbps/8=125MHz)。</p>
<p>发送参考时钟GTX_CLK，它和MII接口中的TX_CLK是不同的，MII接口中的TX_CLK是由PHY芯片提供给MAC芯片的，而GMII接口中的GTX_CLK是由MAC芯片提供给PHY芯片的。两者方向不一样。绝大多数GMII接口都是兼容MII接口的，所以GMII接口都有两个发送参考时钟：TX_CLK和GTX_CLK(两者方向不一样)，在用作MII模式时，使用TX_CLK和8根数据线中的4根。</p>
<p><img src="/images/net/mii/GMII.jpg" alt="GMII"></p>
<p>在千兆速率下，向PHY提供GTXCLK信号、TXD、TXEN、TXER信号与此时钟信号同步。否则在10/100Mbps速率下，PHY提供TXCLK时钟信号，其它信号与此信号同步。其工作频率为25MHz(100M网络)或2.5MHz(10M网络)。</p>
<h2 id="RGMII"><a href="#RGMII" class="headerlink" title="RGMII"></a>RGMII</h2><p>RGMII即Reduced GMII，是GMII的简化版本，将接口信号线数量从24根减少到14根，时钟频率仍旧为125MHz，TX/RX数据宽度从8为变为4位，为了保持1000Mbps的传输速率不变，RGMII接口在时钟的上升沿和下降沿都采样数据。在参考时钟的上升沿发送GMII接口中的TXD[3:0]/RXD[3:0]，在参考时钟的下降沿发送GMII接口中的TXD[7:4]/RXD[7:4]。RGMI同时也兼容100Mbps和10Mbps两种速率，此时参考时钟速率分别为25MHz和2.5MHz。</p>
<p>TX_EN信号线上传送TX_EN和TX_ER两种信息，在TX_CLK的上升沿发送TX_EN，下降沿发送TX_ER；同样的，RX_DV信号线上也传送RX_DV和RX_ER两种信息，在RX_CLK的上升沿发送RX_DV，下降沿发送RX_ER。</p>
<p><img src="/images/net/mii/RGMII.jpg" alt="RGMII"></p>
<p><img src="/images/net/mii/RGMII2.jpg" alt="img"></p>
<h2 id="SGMII"><a href="#SGMII" class="headerlink" title="SGMII"></a>SGMII</h2><p>SGMII即Serial GMII，串行GMII，收发各一对差分信号线，时钟频率625MHz，在时钟信号的上升沿和下降沿均采样，参考时钟RX_CLK由PHY提供，是可选的，主要用于MAC侧没有时钟的情况，一般情况下，RX_CLK不使用。收发都可以从数据中恢复出时钟。</p>
<p>在TXD发送的串行数据中，每8比特数据会插入TX_EN/TX_ER 两比特控制信息，同样，在RXD接收数据中，每8比特数据会插入RX_DV/RX_ER 两比特控制信息，所以总的数据速率为1.25Gbps=625Mbps*2。</p>
<p>其实，大多数MAC芯片的SGMII接口都可以配置成SerDes接口(在物理上完全兼容，只需配置寄存器即可)，直接外接光模块，而不需要PHY层芯片，此时时钟速率仍旧是625MHz，不过此时跟SGMII接口不同，SGMII接口速率被提高到1.25Gbps是因为插入了控制信息，而SerDes端口速率被提高是因为进行了8B/10B变换，本来8B/10B变换是PHY芯片的工作，在SerDes接口中，因为外面不接PHY芯片，此时8B/10B变换在MAC芯片中完成了。8B/10B变换的主要作用是扰码，让信号中不出现过长的连“0”和连“1”情况，影响时钟信息的提取，关于8B/10B变换知识，我后续会单独介绍。</p>
<p><img src="/images/net/mii/SGMII.jpg" alt="SGMII"></p>
<h2 id="TBI"><a href="#TBI" class="headerlink" title="TBI"></a>TBI</h2><p>TBI即Ten Bit Interface，接口数据位宽由GMII接口的8位增加到10位，其实，TBI接口跟GMII接口的差别不是很大，多出来的2位数据主要是因为在TBI接口下，MAC芯片在将数据发给PHY芯片之前进行了8B/10B变换(8B/10B变换本是在PHY芯片中完成的，前面已经说过了)，另外，RX_CLK+/-是从接收数据中恢复出来的半频时钟，频率为62.5MHz，RX_CLK+/-不是差分信号，而是两个独立的信号，两者之间有180度的相位差，在这两个时钟的上升沿都采样数据。RX_CLK+/-也叫伪差分信号。除掉上面说到的之外，剩下的信号都跟GMII接口中的相同。大多数芯片的TBI接口和GMII接口兼容。在用作TBI接口时，CRS和COL一般不用。</p>
<p><img src="/images/net/mii/TBI.jpg" alt="img"></p>
<h2 id="RTBI"><a href="#RTBI" class="headerlink" title="RTBI"></a>RTBI</h2><p>RTBI即Reduced TBI，简化版TBI，接口数据位宽为5bit，时钟频率为125MHz，在时钟的上升沿和下降沿都采样数据，同RGMII接口一样，TX_EN线上会传送TX_EN和TX_ER两种信息，在时钟的上升沿传TX_EN，下降沿传TX_ER；RX_DV线上传送RX_DV和RX_ER两种信息，在RX_CLK上升沿传RX_DV，下降沿传RX_ER。</p>
<p><img src="/images/net/mii/RTBI.jpg" alt="img"></p>
<h2 id="XGMII"><a href="#XGMII" class="headerlink" title="XGMII"></a>XGMII</h2><p>XGMII–10 Gigabit Media Independent Interface 即10Gb独立于媒体的接口，X对应罗马数字10。</p>
<p><img src="/images/net/mii/XGMII.jpg" alt="XGMII"></p>
<p>XGMII接口共74根连线，单端信号，采用HSTL/SSTL_2逻辑，端口电压1.5V/2.5V，由于SSTL_2的端口电压高，功耗大，现在已很少使用。</p>
<ul>
<li><p>TXD[31:0]：数据发送通道，32位并行数据。</p>
</li>
<li><p>RXD[31:0]：数据接收通道，32位并行数据。</p>
</li>
<li><p>TXC[3:0]：发送通道控制信号，TXC=0时，表示TXD上传输的是数据；TXC=1时，表示TXD上传输的是控制字符。TXC[3:0]分别对应TXD[31:24], TXD[23:16], TXD[15:8], TXD[7:0]。</p>
</li>
<li><p>RXC[3:0]：接收通道控制信号，RXC=0时，表示RXD上传输的是数据；RXC=1时，表示RXD上传输的是控制字符。RXC[3:0]分别对应RXD[31:24], RXD[23:16], RXD[15:8], RXD[7:0]。</p>
</li>
<li><p>TX_CLK：TXD和TXC的参考时钟，时钟频率156.25MHz，在时钟信号的上升沿和下降沿都采样数据。156.25MHz - 2 - 32 = 10Gbps 。</p>
</li>
<li><p>RX_CLK：RXD和RXC的参考时钟，时钟频率156.25MHz，在时钟信号的上升沿和下降沿都采样数据。</p>
</li>
</ul>
<p>HSTL即High Speed Transceiver Logic，高速发送逻辑的意思。</p>
<p>SSTL，即Stub Series Terminated Logic，短路终止逻辑，主要用于高速内存接口，SSTL目前存在两种标准，SSTL_3是3.3V标准；SSTL_2是2.5V标准。</p>
<h2 id="XAUI"><a href="#XAUI" class="headerlink" title="XAUI"></a>XAUI</h2><p>由于受电气特性的影响，XGMII接口的PCB走线最大传输距离仅有7cm，并且XGMII接口的连线数量太多，给实际应用带来不便，因此，在实际应用中，XGMII接口通常被XAUI接口代替，XAUI即10 Gigabit attachment unit interface，将XGMII集成到芯片内部，XAUI在XGMII的基础上实现了XGMII接口的物理距离扩展，将PCB走线的传输距离增加到50cm，使背板走线成为可能。</p>
<p>源端XGMII把收发32位宽度数据流分为4个独立的lane通道，每个lane通道对应一个字节，经XGXS(XGMII Extender Sublayer)完成8B/10B编码后，将4个lane分别对应XAUI的4个独立通道，XAUI端口速率为：<code>2.5Gbps - 1.25 - 4＝12.5Gbps</code>。</p>
<p><img src="/images/net/mii/XAUI.jpg" alt="img"></p>
<p>在发送端的XGXS模块中，将TXD[31:0]/ RXD[31:0],TXC[3:0]/ RXC[3:0], TX_CLK/ RX_CLK转换成串行数据从TX Lane[3:0]/ RX Lane[3:0]中发出去，在接收端的XGXS模块中，串行数据被转换成并行，并且进行时钟恢复和补偿，完成时钟去抖，经过5B/4B解码后，重新聚合成XGMII。</p>
<p>万兆以太网接口的端口速率为10Gbps，主要有XGMII和XAUI两种，另外还有HIGIG。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/rj45/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/rj45/" class="post-title-link" itemprop="url">RJ45 interface</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>以太网信号最终是通过RJ45接头接入网络的。RJ是Registered Jack的缩写，意思是注册的插座。在FCC（美国联邦通信委员会标准和规章）中RJ是描述公用电信网络的接口，计算机网络的RJ45是标准8位模块化接口的俗称。连接器由插头（8P8C接头，水晶头）和插座组成。</p>
<p>RJ45型网线插头又称水晶头，有两种连接方式，分别称作 T568A 线序和 T568B 线序。两者的主要区别是橙色和绿色双绞线进行了交换。</p>
<p>这两种标准只是在线缆颜色上有所区别，目的是在线缆侧实现交叉互连。直连线常用于异种网络之间的互连（比如计算机交换机之间），交叉线常用于同种网络之间的互联（比如计算机与之间）。</p>
<p><img src="/images/net/RJ45/RJ-45_T568AB.jpg" alt="RJ-45接线图"></p>
<p><img src="/images/net/RJ45/T568AB.bmp" alt="RJ-45接线图2"></p>
<p>交叉互连，所谓交叉是指网线的一端和另一端与 RJ45 网线插头的接法不同，一端按 T568A 线序接，另一端按 T568B 线序接，即有几根网线在另一端是先做了交叉才接到 RJ45 插头上去的，适用的场合：</p>
<ul>
<li>电脑——电脑，称对等网连接</li>
<li>集线器——集线器</li>
<li>交换机——交换机</li>
</ul>
<p>直连线互连的网线的两端均按T568B接线，适用场合：</p>
<ul>
<li>电脑——ADSL 猫</li>
<li>ADSL猫——ADSL 路由器的 WAN 口</li>
<li>电脑——ADSL 路由器的 LAN 口</li>
<li>电脑——集线器或交换机</li>
</ul>
<p>现在PHY芯片大部分具有自动交叉（auto MDI-X）的能力，它可以实现RJ-45接口的传送信号线和接收信号线的功能自动互相交换，有的PHY甚至支持一对线中的正信号和负信号的功能自动交换，这样就不必考虑选用直连网线还是交叉网线，只需要直连即可。</p>
<p><img src="/images/net/RJ45/T-568A.jpg" alt="T-568A"></p>
<p><img src="/images/net/RJ45/T-568B.jpg" alt="T-568B"></p>
<p><img src="/images/net/RJ45/RJ45-pinout.jpg" alt="RJ45-pinout"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/net/eth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/net/eth/" class="post-title-link" itemprop="url">ethernet and MAC</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="网卡"><a href="#网卡" class="headerlink" title="网卡"></a>网卡</h2><p>以太网接口由MAC控制器物理层接口PHY组成。PHY整合了大量模拟硬件，而MAC是典型的全数字器件。考虑到芯片面积及模拟/数字混合架构的原因，通常，将MAC集成进微控制器而将PHY留在片外。</p>
<p><img src="/images/net/eth/eth-arch.png" alt="基本构成"></p>
<p><img src="/images/net/eth/eth-arch2.jpg" alt="cpu内部框架"></p>
<p>网卡工作在osi的最后两层，物理层和数据链路层，物理层定义了数据传送与接收所需要的电与光信号、线路状态、时钟基准、数据编码和电路等，并向数据链路层设备提供标准接口。物理层的芯片称之为PHY。数据链路层则提供寻址机构、数据帧的构建、数据差错检查、传送控制、向网络层提供标准的数据接口等功能。以太网卡中数据链路层的芯片称之为MAC控制器。很多网卡的这两个部分是做到一起的。他们之间的关系是pci总线接mac总线，mac接phy，phy接网线。</p>
<p>隔离变压器的作用是防干扰，防雷击。长距离连接的两个以太网设备，很可能不共地，地线之间有电压差，如果不隔离，电流会经网线走，网卡接口就很容易坏了。</p>
<p>RJ-45接头实现了网卡和网线的连接，10M网卡的RJ-45插口也只用了1,2,3,6四根，而100M或1000M网卡使用八根。其中100M的网络中1,2是传送数据的，3,6是接收数据的，1,2之间是一对差分信号，也就是说它们的波形一样，但是相位相差180度。</p>
<h2 id="MAC"><a href="#MAC" class="headerlink" title="MAC"></a>MAC</h2><p>MAC（Media Access Control），即媒体访问控制子层协议。该协议位于OSI七层协议中数据链路层的下半部分，实现了数据链路层。支持 10Mbit/s 或 100Mbit/s 两种速率。主要负责控制与连接物理层的物理介质。在发送数据的时候，MAC协议可以事先判断是否可以发送数据，如果可以发送将给数据加上一些控制信息，最终将数据以及控制信息以规定的格式发送到物理层;在接收数据的时候，MAC协议首先判断输入的信息并是否发生传输错误,如果没有错误,则去掉控制信息发送至LLC层。该层协议是以太网MAC由IEEE-802.3以太网标准定义。</p>
<p><img src="/images/net/eth/mac.png" alt="OSI-MAC"></p>
<p>最新的MAC同时支持 10Mbps和100Mbps两种速率。以太网数据链路层其实包含MAC(介质访问控制)子层和LLC(逻辑链路控制)。</p>
<p>目标的MAC地址由ARP协议确定。第一次传送某个目的IP地址的数据的时候，先会发出一个ARP包，其MAC的目标地址是广播地址，因为是广播包，所有这个局域网的主机都收到了这个ARP请求。收到请求的主机将这个IP地址和自己的相比较，如果不相同就不予理会，如果相同就发出ARP响应包。这个IP地址的主机收到这个ARP请求包后回复的ARP响应。这个包里面就包括了他的MAC地址。以后的给这个IP地址的帧的目标MAC地址就被确定了。</p>
<p>IP地址和MAC地址之间的关联关系保存在主机系统里面，叫做ARP表。</p>
<p><img src="/images/net/eth/MAC.jpg" alt="MAC"></p>
<p>以太网MAC芯片的一端接计算机PCI总线，另外一端就接到PHY芯片上。CPU上有两组寄存器用与MAC。一组用户数据的收发，对应上面的DMA；一组用户MIIM，用户对PHY进行配置，两组寄存器由于都在CPU上，配置方式与其他CPU上寄存器一样，直接读写即可。数据的转发通过DMA完成。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/c/datatype/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/c/datatype/" class="post-title-link" itemprop="url">c语言数据类型</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-17 19:44:05" itemprop="dateModified" datetime="2022-06-17T19:44:05+08:00">2022-06-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/c%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">c语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <table>
<thead>
<tr>
<th align="center">Data Type</th>
<th align="center">ILP32</th>
<th align="center">LP32</th>
<th align="center">ILP64</th>
<th align="center">LP64</th>
<th align="center">LLP64</th>
</tr>
</thead>
<tbody><tr>
<td align="center">宏定义</td>
<td align="center">_</td>
<td align="center">_</td>
<td align="center">_</td>
<td align="center"><strong>LP64</strong></td>
<td align="center"><strong>LLP64</strong></td>
</tr>
<tr>
<td align="center">平台</td>
<td align="center">Win32 API  / Unix 和 Unix 类的系统 （Linux，Mac OS X）</td>
<td align="center">Win16 API</td>
<td align="center"></td>
<td align="center">Unix 和 Unix 类的系统 （Linux，Mac OS X)</td>
<td align="center">Win64 API</td>
</tr>
<tr>
<td align="center">char</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">16</td>
<td align="center">16</td>
<td align="center">16</td>
<td align="center">16</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">32</td>
<td align="center">16</td>
<td align="center">64</td>
<td align="center">32</td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">32</td>
<td align="center">32</td>
<td align="center">64</td>
<td align="center">64</td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">long long</td>
<td align="center">64</td>
<td align="center">64</td>
<td align="center">64</td>
<td align="center">64</td>
<td align="center">64</td>
</tr>
<tr>
<td align="center">pointer</td>
<td align="center">32</td>
<td align="center">32</td>
<td align="center">64</td>
<td align="center">64</td>
<td align="center">64</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">32</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">32</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">64</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">64</td>
<td align="center"></td>
</tr>
</tbody></table>
<ol>
<li>格式化打印，long使用%ld或%lx，指针使用%p</li>
<li>对于long类型，常量要加L，如：long a = 1L&lt;&lt;32</li>
<li>ssize_t在32位机器上等同与int，在64位机器上等同与long，size_t是无符号型的ssize_t。</li>
<li>指针大小在32位机器上是4字节，64位是8字节。指针p+1 = p + sizeof(p指向的数据类型)。</li>
<li>int, short, long都是signed的，char可能是signed的，也可能是unsigned的，由编译器决定，一般x86上是有符号，arm上是无符号的。</li>
</ol>
<p>stdint.h 里定义了一些数据类型的别名和范围。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">signed</span> <span class="type">char</span>    <span class="type">int8_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">short</span> <span class="type">int</span>      <span class="type">int16_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span>            <span class="type">int32_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __WORDSIZE == 64</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">int</span>       <span class="type">int64_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span>    <span class="type">int64_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span>        <span class="type">uint8_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span>   <span class="type">uint16_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>         <span class="type">uint32_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __WORDSIZE == 64</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span>   <span class="type">uint64_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span>  <span class="type">uint64_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __WORDSIZE == 64</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">int</span>            <span class="type">intptr_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span>   <span class="type">uintptr_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span>                 <span class="type">intptr_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>        <span class="type">uintptr_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT8_MIN        (-128)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT16_MIN       (-32767-1)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT32_MIN       (-2147483647-1)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT64_MIN       (-__INT64_C(9223372036854775807)-1)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT8_MAX        (127)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT16_MAX       (32767)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT32_MAX       (2147483647)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> INT64_MAX       (__INT64_C(9223372036854775807))</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> UINT8_MAX        (255)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> UINT16_MAX       (65535)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> UINT32_MAX       (4294967295U)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> UINT64_MAX       (__UINT64_C(18446744073709551615))</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/media/audio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/media/audio/" class="post-title-link" itemprop="url">audio</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:32:36" itemprop="dateModified" datetime="2022-06-08T17:32:36+08:00">2022-06-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><h3 id="声音"><a href="#声音" class="headerlink" title="声音"></a>声音</h3><p>声音三要素：音调、响度、音色。<br>-　音调：声音的高低，由频率决定，频率越高音调越高。<br>-　响度：又称音量、音强，由振幅和距离声源的距离决定。<br>-　音色：又称音品，由发声物体本身材料、结构决定。</p>
<p>分贝用于度量声音强度，单位是dB。</p>
<p><img src="/images/media/audio/dB.png" alt="分贝"></p>
<h3 id="采样率"><a href="#采样率" class="headerlink" title="采样率"></a>采样率</h3><p>采样率（sample rate）表示单位时间内对声音信号的采样次数，单位Hz。在当今的主流采集卡上，采样频率一般共分为 22.05KHz、44.1KHz、48KHz三个等级，对于高于48KHz的采样频率人耳已无法辨别出来了。</p>
<p><img src="/images/media/audio/sample_rate.png" alt="采样率"></p>
<h3 id="位深度"><a href="#位深度" class="headerlink" title="位深度"></a>位深度</h3><p>位深度也叫采样位数就是采样值用多少位0和1来表示，也叫采样精度，代表取样中对声音强度记录的精细程度。音频的位深度决定动态范围。采样声波时，为每个采样指定最接近原始声波振幅的振幅值。较高的位深度可提供更多可能的振幅值，产生更大的动态范围、更低的噪声基准和更高的保真度。</p>
<p><img src="/images/media/audio/bit_deep.png" alt="位深"></p>
<h3 id="声道"><a href="#声道" class="headerlink" title="声道"></a>声道</h3><p>声道（channel）分为单声道mono；立体声stereo；还可以是多声道，叫环绕立体声。如果是单声道的文件，采样数据按时间的先后顺序依次存入。如果是双声道的文件，采样数据按时间先后顺序交叉的存入。</p>
<p><img src="/images/media/audio/pcm.png" alt="PCM格式"></p>
<h3 id="比特率"><a href="#比特率" class="headerlink" title="比特率"></a>比特率</h3><p>比特率（bitrate）也叫码率，表示压缩编码后每秒的音频数据量大小。比特率 = 采样率 x 采样精度 x 声道数（单位kbps，这里的k为1000）</p>
<h3 id="音频帧"><a href="#音频帧" class="headerlink" title="音频帧"></a>音频帧</h3><p>音频数据是流式的，本身没有明确的一帧帧的概念，在实际的应用中，为了音频算法处理/传输的方便，一般约定俗成取2.5ms~60ms为单位的数据量为一帧音频。这个时间被称之为“采样时间”，其长度没有特别的标准，它是根据编解码器和具体应用的需求来决定的。</p>
<h3 id="码率模式"><a href="#码率模式" class="headerlink" title="码率模式"></a>码率模式</h3><p>VBR（VariableBitrate）动态比特率。也就是没有固定的比特率，压缩软件在压缩时根据音频数据即时确定使用什么比特率。这是新发展的算法，他们将一首歌的复杂部分用高Bitrate编码，简单部分用低Bitrate编码。主意虽然不错，可惜新编码器的VBR算法很差，音质与CBR相去甚远。幸运的是， Lame完美地优化了VBR算法，使之成为MP3的最佳编码模式。这是以质量为前提兼顾文件大小的方式时推荐的编码模式。</p>
<p>ABR（Average Bitrate）平均比特率，是VBR的一种插值参数。Lame针对CBR不佳的文件体积比和VBR生成文件大小不定的特点独创了这种编码模式。ABR也被称为“Safe VBR”，它是在指定的平均Bitrate内，以每50帧（30帧约1秒）为一段，低频和不敏感频率使用相对低的流量，高频和大动态表现时使用高流量。举例来说，当指定用192kbps ABR对一段wav文件进行编码时，Lame会将该文件的85%用192kbps固定编码，然后对剩余15%进行动态优化：复杂部分用高于192kbps 来编码、简单部分用低于192kbps来编码。与192kbps CBR相比，192kbps ABR在文件大小上相差不多，音质却提高不少。ABR编码在速度上是VBR编码的2到3倍，在128-256kbps范围内质量要好于CBR。可以做为 VBR和CBR的一种折衷选择。</p>
<p>CBR（ConstantBitrate），常数比特率，指文件从头到尾都是一种位速率。相对于VBR和ABR来讲，它压缩出来的文件体积很大，但音质却不会有明显的提高。</p>
<h2 id="音频编码"><a href="#音频编码" class="headerlink" title="音频编码"></a>音频编码</h2><p>根据编码方式的不同，音频编码技术分为三种：波形编码、参数编码和混合编码。波形编码的话音质量高，但编码速率也很高；参数编码的编码速率很低，产生的合成语音的音质不高；混合编码使用参数编码技术和波形编码技术，编码速率和音质介于它们之间。</p>
<p> PCM 即脉冲编码调制(Pulse Code Modulation)。 在PCM 过程中，将输入的模拟信号进行采样、量化和编码，用二进制进行编码的数来代表模拟信号的幅度；接收端再将这些编码还原为原来的模拟信号。</p>
<h3 id="音频数据格式"><a href="#音频数据格式" class="headerlink" title="音频数据格式"></a>音频数据格式</h3><p>PCM数据是最原始的音频数据完全无损，所以PCM数据虽然音质优秀但体积庞大，为了解决这个问题先后诞生了一系列的音频格式，这些音频格式运用不同的方法对音频数据进行压缩，其中有无损压缩（WAV，PCM，ALS，TAK，WavPack　ALAC、APE、FLAC）和有损压缩（MP3、AAC、OGG、WMA）两种。</p>
<h4 id="WAV"><a href="#WAV" class="headerlink" title="WAV"></a>WAV</h4><p>WAV是WaveFom的简写，也称为波形文件，可直接存储声音波形。WAV格式支持MSADPCM、CCITT A律、CCITT μ律和其他压缩算法，支持多种音频位数、采样频率和声道；但其文件尺寸较大，多用于存储简短的声音片段</p>
<h4 id="MIDI"><a href="#MIDI" class="headerlink" title="MIDI"></a>MIDI</h4><p>MIDI是Musical InstrumentDigital Interface的缩写，又称作乐器数字接口，是数字音乐/电子合成乐器的统一国际标准。它定义了计算机音乐程序、数字合成器及其它电子设备交换音乐信号的方式，规定了不同厂家的电子乐器与计算机连接的电缆和硬件及设备间数据传输的协议，可以模拟多种乐器的声音。MIDI文件就是MIDI格式的文件，在MIDI文件中存储的是一些指令。把这些指令发送给声卡，由声卡按照指令将声音合成出来。</p>
<h4 id="WMA"><a href="#WMA" class="headerlink" title="WMA"></a>WMA</h4><p>Windows Media Audio是微软公司开发的一种声音文件格式，也叫波形声音文件，压缩率低。 所需频宽 320～112kbps（压缩10～12倍），当Bitrate小于128K时，WMA最为出色且编码后得到的音频文件很小 ，当Bitrate大于128K时，WMA音质损失过大。WMA标准不开放。</p>
<h4 id="MP1"><a href="#MP1" class="headerlink" title="MP1"></a>MP1</h4><p>MPEG-1 audio layer 1声音压缩编码是国际上第一个高保真声音数据压缩的国际标准，编码简单，用于数字盒式录音磁带，2声道，VCD中使用的音频压缩方案就是MPEG-1层Ⅰ。所需频宽：384kbps（压缩4倍）。压缩方式相对时域压缩技术而言要复杂得多，同时编码效率、声音质量也大幅提高，编码延时相应增加。可以达到“完全透明”的声音质量（EBU音质标准）。</p>
<h4 id="MUSICAM"><a href="#MUSICAM" class="headerlink" title="MUSICAM"></a>MUSICAM</h4><p>MPEG-1 audio layer 2（MP2），所需频宽：256～192kbps（压缩6～8倍），算法复杂度中等，用于数字音频广播(DAB)和VCD等，2声道，而MUSICAM由于其适当的复杂程度和优秀的声音质量，在数字演播室、DAB、DVB等数字节目的制作、交换、存储、传送中得到广泛应用。</p>
<h4 id="MP3"><a href="#MP3" class="headerlink" title="MP3"></a>MP3</h4><p>MP3全称是动态影像专家压缩标准音频层面3（Moving Picture Experts Group Audio Layer III）。是一种有损压缩的音频格式，设计这种格式的目的就是为了大幅度的减小音频的数据量，它舍弃PCM音频数据中人类听觉不敏感的部分。所需频宽：128～112kbps（压缩10～12倍），编码复杂，用于互联网上的高质量声音的传输，如MP3音乐压缩10倍，2声道。MP3是在综合MUSICAM和ASPEC的优点的基础上提出的混合压缩技术，在当时的技术条件下，MP3的复杂度显得相对较高，编码不利于实时，但由于MP3在低码率条件下高水准的声音质量，使得它成为软解压及网络广播的宠儿。优点：压缩比高，适合用于互联网上的传播，缺点：MP3在128KBitrate及以下时，会出现明显的高频丢失。</p>
<p>所谓的MP3也就是指的是MPEG标准中的音频部分，也就是MPEG音频层。根据压缩质量和编码处理的不同分为3层，分别对应mp1/mp2/mp3这3种声音文件。需要提醒大家注意的地方是：MPEG音频文件的压缩是一种有损压缩，MPEG3音频编码具有10：1~12：1的高压缩率，同时基本保持低音频部分不失真，但是牺牲了声音文件中12KHz到16KHz高音频这部分的质量来换取文件的尺寸，相同长度的音乐文件，用*.mp3格式来储存，一般只有*.wav文件的1/10，而音质要次于CD格式或WAV格式的声音文件。由于其文件尺寸小，音质好;所以在它问世之初还没有什么别的音频格式可以与之匹敌，因而为*.mp3格式的发展提供了良好的条件。</p>
<p>MP3格式中的数据通常由两部分组成，一部分为ID3用来存储歌名、演唱者、专辑、音轨数等信息，另一部分为音频数据。音频数据部分以帧(frame)为单位存储，每个音频都有自己的帧头，如图所示就是一个MP3文件帧结构图（图片同样来自互联网）。MP3中的每一个帧都有自己的帧头，其中存储了采样率等解码必须的信息，所以每一个帧都可以独立于文件存在和播放，这个特性加上高压缩比使得MP3文件成为了音频流播放的主流格式。帧头之后存储着音频数据，这些音频数据是若干个PCM数据帧经过压缩算法压缩得到的，对CBR的MP3数据来说每个帧中包含的PCM数据帧是固定的，而VBR是可变的。</p>
<p><img src="/images/media/audio/mp3_format.webp" alt="mp3文件格式"></p>
<h4 id="AAC"><a href="#AAC" class="headerlink" title="AAC"></a>AAC</h4><p>AAC实际上是高级音频编码(Advanced Audio Coding–AAC)的缩写。AAC是由Fraunhofer IIS-A、杜比和AT&amp;T共同开发的一种音频格式，它是MPEG-2规范的一部分。成为继MPEG-2音频标准（ISO/IEC13818-3）之后的新一代音频压缩标准。制定者：MPEG，所需频宽：96-128 kbps。</p>
<p>AAC所采用的运算法则与MP3的运算法则有所不同，AAC通过结合其他的功能来提高编码效率。AAC的音频算法在压缩能力上远远超过了以前的一些压缩算法。它还同时支持多达48个音轨、15个低频音轨、更多种采样率和比特率、多种语言的兼容能力、更高的解码效率。总之，AAC可以在比MP3文件缩小30%的前提下提供更好的音质。</p>
<p>AAC支持多声道，可提供1到48路之间任意数目的音频声道组合、包括15路低频效果声道、配音/多语音声道，以及15路数据。它可同时传送16套节目，每套节目的音频及数据结构可任意规定。最高支持96KHz的采样频率。</p>
<p>AAC主要可能的应用范围集中在因特网网络传播、数字音频广播，包括卫星直播和数字AM、以及数字电视及影院系统等方面。AAC使用了一种非常灵活的熵编码核心去传输编码频谱数据。具有48个主要音频通道，16 个低频增强通道，16 个集成数据流, 16 个配音，16 种编排。</p>
<h4 id="GSM-AMR"><a href="#GSM-AMR" class="headerlink" title="GSM-AMR"></a>GSM-AMR</h4><p>GSM-ASM(Adaptive Multi-Rate)是一种广泛使用在GPRS和W-CDMA网络上的音频标准。在规范ETSI GSM06.90中对GSM-AMR进行了定义。AMR语音编码是GSM 2+和WCDMA的默认编码标准，是第三代无线通讯系统的语音编码标准。GSM-AMR标准基于ACELP（代数激励线性预测）编码。它能在广泛的传输条件下提供高品质的语音效果。制定者：飞利浦，所需频宽：8Kbps(4.75 Kbps~12.2 Kbps)，可以对语音进行替换和消音，平滑噪音，支持间断式传输，对语音进行动态侦查。能在各种网络条件下提供优质的语音效果。</p>
<h4 id="EVRC"><a href="#EVRC" class="headerlink" title="EVRC"></a>EVRC</h4><p>Enhanced Variable Rate Coder，增强型可变速率编码器广泛使用于CDMA网络。EVRC标准遵循规范TIA IS-127的内容。EVRC编码基于RCELP（松弛码激励线性预测）标准。该编码可以以Rate 1（171bits/packet），Rate 1/2（80bits/packet）或是Rate 1/8（16bits/packet）的容量进行操作。在要求下，它也能产生空包（0bits/packet）。制定者：Qualcomm，所需频宽：8Kbps或13Kbps，支持三种码率（9.6 Kbps, 4.8 Kbps 和 1.2 Kbps），噪声抑制，邮件过滤。能在各种网络条件下提供优质的语音效果。</p>
<h4 id="ADPCM"><a href="#ADPCM" class="headerlink" title="ADPCM"></a>ADPCM</h4><p>ADPCM(adaptive difference pulse code modulation，　自适应差分PCM)综合了APCM的自适应特性和DPCM系统的差分特性，是一种性能比较好的波形编码。它的核心想法是利用自适应的思想改变量化阶的大小，即使用小的量化阶(step-size)去编码小的差值，使用大的量化阶去编码大的差值；使用过去的样本值估算下一个输入样本的预测值，使实际样本值和预测值之间的差值总是最小。针对 16bit (或者更高) 声音波形数据的一种有损压缩算法, 它将声音流中每次采样的 16bit 数据以 4bit 存储, 所以压缩比 1:4. 而压缩/解压缩算法非常的简单, 所以是一种低空间消耗,高质量声音获得的好途径。制定者：ITU-T，所需频宽：32Kbps，优点：算法复杂度低，压缩比小（CD音质&gt;400kbps），编解码延时最短。，缺点：声音质量一般</p>
<h4 id="MP3Pro"><a href="#MP3Pro" class="headerlink" title="MP3Pro"></a>MP3Pro</h4><p>MP3Pro是由瑞典Coding科技公司开发的，其中包含了两大技术：一是来自于Coding科技公司所特有的解码技术，二是由MP3的专利持有者法国汤姆森多媒体公司和德国Fraunhofer集成电路协会共同研究的一项译码技术。MP3Pro可以在基本不改变文件大小的情况下改善原先的MP3音乐音质。它能够在用较低的比特率压缩音频文件的情况下，最大程度地保持压缩前的音质。</p>
<h4 id="RealAudio"><a href="#RealAudio" class="headerlink" title="RealAudio"></a>RealAudio</h4><p>RealAudio是由Real Networks公司推出的一种文件格式，最大的特点就是可以实时传输音频信息，尤其是在网速较慢的情况下，仍然可以较为流畅地传送数据，因此RealAudio主要适用于网络上的在线播放。现在的RealAudio文件格式主要有RA(RealAudio)、RM（RealMedia，RealAudio G2）、RMX(RealAudio Secured)等三种，这些文件的共同性在于随着网络带宽的不同而改变声音的质量，在保证大多数人听到流畅声音的前提下，令带宽较宽敞的听众获得较好的音质。</p>
<p>RA采用的是有损压缩技术，由于它的压缩比相当高，因此音质相对较差，但是文件也是最小的，因此在高压缩比条件下表现好，但若在中、低压缩比条件下时，表现却反而不及其他同类型档案格式了。此外RA可以随网络带宽的不同而改变声音质量，以使用户在得到流畅声音的前提下，尽可能高地提高声音质量。由于RA格式的这些特点，因此特别适合在网络传输速度较低的互联网上使用，互联网上许多的网络电台、音乐网站的歌曲试听都在使用这种音频格式。</p>
<h4 id="Ogg-Vorbis"><a href="#Ogg-Vorbis" class="headerlink" title="Ogg Vorbis"></a>Ogg Vorbis</h4><p>Ogg Vorbis 是一种新的音频压缩格式，类似于MP3等现有的音乐格式。但有一点不同的是，它是完全免费、开放和没有专利限制的。Vorbis 是这种音频压缩机制的名字，而Ogg则是一个计划的名字，该计划意图设计一个完全开放性的多媒体系统。VORBIS也是有损压缩，但通过使用更加先进的声学模型去减少损失，因此，同样位速率(Bit Rate)编码的OGG与MP3相比听起来更好一些。</p>
<h4 id="APE"><a href="#APE" class="headerlink" title="APE"></a>APE</h4><p>APE是Monkey’s Audio提供的一种无损压缩格式,是一种无损压缩音频格式,在音质不降低的前提下，大小压缩到传统无损格式 WAV 文件的一半,而且可以无须解压而直接播放。APE的采样率最高可达1400kbps，接近于音乐CD格式。</p>
<h4 id="FLAC"><a href="#FLAC" class="headerlink" title="FLAC"></a>FLAC</h4><p>FLAC即是Free Lossless AudioCodec的缩写，是一套著名的自由音频无损压缩编码，其特点是无损压缩。</p>
<h2 id="音频处理"><a href="#音频处理" class="headerlink" title="音频处理"></a>音频处理</h2><p>音频处理是指对PCM数据进行处理，从而达到想要的效果。对音频编码前的PCM数据进行处理叫音频前处理，主要用于语音中，来去除各种干扰，使声音更清晰，主要有回声消除、噪声抑制、增益控制等。对音频解码后的PCM数据进行处理叫音频后处理，主要用于音乐中，来产生各种音效，使音乐更动听，主要有均衡器、混响等。</p>
<h3 id="重采样"><a href="#重采样" class="headerlink" title="重采样"></a>重采样</h3><p>音频输入和音频输出模块支持对音频数据实施重采样。如果启用 AI 重采样功能，内部将会先执行重采样处理，再返回处理后的数据。如果启用了 AO 重采样功能，则音频数据在发送给 AO 之前，内部先执行重采样处理，处理完成后再发送给 AO 通道进行播放。重采样仅支持处理单声道。</p>
<h3 id="ANR"><a href="#ANR" class="headerlink" title="ANR"></a>ANR</h3><p>ANR 为语音降噪（ Audio Noise Reduction ）模块，主要工作在需要去除外界噪声，保<br>留语音输入的场景下。与 RNR 算法比起来， ANR 更讲究噪声处理的干净程度。 ANR 会滤除一些环境声音，主要保留语音数据，并会带来一定的细节丢失。所以 ANR 算法更适用于 NVR 和 IPC<br>场景。在这两个场景下，我们更希望能够着重保留人声，滤除其他噪声。</p>
<h3 id="RNR"><a href="#RNR" class="headerlink" title="RNR"></a>RNR</h3><p>RNR 为录音噪声消除（ Record Noise Reduction ）模块，主要工作在需要去除环境噪声，但保留小信号输入的场景下。与 ANR 算法比起来， RNR 更讲究细节输入（小信号）的保留度， RNR 会在降噪的同时保留小信号的输入，所以降噪力度会低一点，但能更多的保留现场声音，真实还原场景，适用于运动 DV 场景。</p>
<h3 id="AEC"><a href="#AEC" class="headerlink" title="AEC"></a>AEC</h3><p>AEC 为回声抵消（ Acoustic Echo Cancellation ）模块，主要工作在需要进行去除回声的<br>场景下：如 IPC 对讲，远端语音数据在 AO 设备上播放，此时在本地通过 MIC 采集语<br>音数据，它支持消除录制的语音数据中的 AO 设备播放的声音（回声）。</p>
<h3 id="AGC"><a href="#AGC" class="headerlink" title="AGC"></a>AGC</h3><p>AGC 为自动增益控制（ Auto Gain Control ）模块，主要负责增益控制输出电平，在声音输入音量有大小变化时，能将输出音量控制在比较一致的范围内，主要工作在需要保证声音不至于过大或过小的场景下。AGC 更多起到的作用是放大输入源的声音，以保证音源过小时，经过算法处理后的声音依然很大。</p>
<h3 id="DRC"><a href="#DRC" class="headerlink" title="DRC"></a>DRC</h3><p>DRC 为动态压缩控制（ Dynamic Range Control ）模块，负责控制输出电平，将输出增益控制在一个范围，主要工作在需要保证声音不至于过大或过小的场景下。DRC 与 AGC 作用相似，但算法实现及调节力度不同。其配合 RNR 使用在运动 DV 场景，与 AEC/ANR 互斥。</p>
<h3 id="HDR"><a href="#HDR" class="headerlink" title="HDR"></a>HDR</h3><p>HDR 为高动态范围（ High Dynamic Range ）模块，主要用于 Codec 输入音量控制，通过动态调节 Codec 增益控制 Codec 音量在合理范围内，保证声音不至于过大或过小。</p>
<h3 id="HPF"><a href="#HPF" class="headerlink" title="HPF"></a>HPF</h3><p>HPF 为高通滤波（ high-pass filte ）模块，主要负责去除低频噪声。</p>
<h3 id="PEQ"><a href="#PEQ" class="headerlink" title="PEQ"></a>PEQ</h3><p>PEQ 为参量均衡器（ Parameter Equalizer ）模块，主要对音频数据进行均衡处理，以调节音频数据中各频段声音的增益。PEQ 与 EQ 均为均衡处理器，但是 PEQ 调节方式更灵活，适用于运动 DV 场景。</p>
<h3 id="EQ"><a href="#EQ" class="headerlink" title="EQ"></a>EQ</h3><p>EQ 模块为均衡处理器（ Equalizer ）模块，主要对音频数据进行均衡处理，以调节音频数据中各频段声音的增益。</p>
<p>均衡器的调整方法：</p>
<ul>
<li>超低音： 20Hz-40Hz，适当时声音强而有力。能控制雷声、低音鼓、管风琴和贝司的声音。过度提升会使音乐变得混浊不清</li>
<li>低音： 40Hz-150Hz，是声音的基础部份，其能量占整个音频能量的70%，是表现音乐风格的重要成份。适当时，低音张弛得宜，声音丰满柔和，不足时声音单薄，150Hz，过度提升时会使声音发闷，明亮度下降，鼻音增强</li>
<li>中低音： 150Hz-500Hz，是声音的结构部分，人声位于这个位置，不足时，演唱声会被音乐淹没，声音软而无力，适当提升时会感到浑厚有力，提高声音的力度和响度。提升过度时会使低音变得生硬，300Hz处过度提升3-6dB，如再加上混响，则会严重影响声音的清晰度</li>
<li>中音： 500Hz-2KHz，包含大多数乐器的低次谐波和泛音，是小军鼓和打击乐器的特征音。适当时声音透彻明亮，不足时声音朦胧。过度提升时会产生类似电话的声音</li>
<li>中高音： 2KHz-5KHz，是弦乐的特征音（拉弦乐的弓与弦的摩搡声，弹拔乐的手指触弦的声音某）。不足时声音的穿透力下降，过强时会掩蔽语言音节的识别</li>
<li>高音： 7KHz-8KHz，是影响声音层次感的频率。过度提升会使短笛、长笛声音突出，语言的齿音加重和音色发毛</li>
<li>极高音： 8KHz-10KHz 合适时，三角铁和立*的金属感通透率高，沙钟的节奏清晰可辨。过度提升会使声音不自然，易烧毁高频单元。</li>
</ul>
<h2 id="耳机插头"><a href="#耳机插头" class="headerlink" title="耳机插头"></a>耳机插头</h2><p><img src="/images/media/audio/hp1.png" alt="耳机插头"></p>
<p><img src="/images/media/audio/hp2.png" alt="耳机插头"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/media/video/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/media/video/" class="post-title-link" itemprop="url">video</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:36:20" itemprop="dateModified" datetime="2022-06-08T17:36:20+08:00">2022-06-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="码流"><a href="#码流" class="headerlink" title="码流"></a>码流</h3><p>码流是指视频文件在单位时间内使用的数据流量，也叫码率或码流率，通俗一点的理解就是取样率,是视频编码中画面质量控制中最重要的部分，一般我们用的单位是kb/s或者Mb/s。一般来说同样分辨率下，视频文件的码流越大，压缩比就越小，画面质量就越高。码流越大，说明单位时间内取样率越大，数据流，精度就越高，处理出来的文件就越接近原始文件，图像质量越好，画质越清晰，要求播放设备的解码能力也越高。</p>
<h3 id="采样率"><a href="#采样率" class="headerlink" title="采样率"></a>采样率</h3><p>采样率（也称为采样速度或者采样频率）定义了每秒从连续信号中提取并组成离散信号的采样个数，它用赫兹（Hz）来表示。采样率是指将模拟信号转换成数字信号时的采样频率，也就是单位时间内采样多少点。</p>
<h3 id="比特率"><a href="#比特率" class="headerlink" title="比特率"></a>比特率</h3><p>比特率是指每秒传送的bit数。单位为bps(Bit Per Second)，表示经过编码后的音视频数据每秒钟需要用多少个bit来表示。</p>
<h3 id="码率"><a href="#码率" class="headerlink" title="码率"></a>码率</h3><p>码率就是数据传输时单位时间传送的数据位数,一般我们用的单位是kbps即千位每秒。也就是取样率（并不等同与采样率，采样率的单位是Hz，表示每秒采样的次数），单位时间内取样率越大，精度就越高，处理出来的文件就越接近原始文件。</p>
<p>$码率 = 采样率 x 位深度 x 声道$</p>
<p>$文件大小 = 码率（KBit） / 8  x  时长$  （用bits/s码流计算容量记得要除8）</p>
<h3 id="帧率"><a href="#帧率" class="headerlink" title="帧率"></a>帧率</h3><p>帧率fps(Frames Per Second)就是在1秒钟时间里传输的图片的帧数，也可以理解为图形处理器每秒钟能够刷新几次。每秒显示的图片数影响画面流畅度，与画面流畅度成正比：帧率越大，画面越流畅；帧率越小，画面越有跳动感。由于人类眼睛的特殊生理结构，如果所看画面之帧率高于16的时候，就会认为是连贯的，此现象称之为视觉暂留。并且当帧速达到一定数值后，再增长的话，人眼也不容易察觉到有明显的流畅度提升了。</p>
<p>帧率影响画面流畅度，与画面流畅度成正比：帧率越大，画面越流畅；帧率越小，画面越有跳动感。如果码率为变量，则帧率也会影响体积，帧率越高，每秒钟经过的画面越多，需要的码率也越高，体积也越大。</p>
<h3 id="分辨率"><a href="#分辨率" class="headerlink" title="分辨率"></a>分辨率</h3><p>分辨率就是帧大小或尺寸，影响图像大小，与图像大小成正比：分辨率越高，图像越大；分辨率越低，图像越小。</p>
<p>标清(standard definition)，是物理分辨率在720p以下的一种视频格式，一般是480p。</p>
<p>高清(high definition)，有720p、1080i与1080p三种标准形式，1080p又叫全高清(超清)。1080p是逐行扫描(Progressive scan)，1080i是隔行扫描(Interlaced scan)。720p格式，分辨率为1280×720p/60Hz，行频为45kHz。</p>
<p>4K分辨率是1080p的4倍 3840×2160 = 1920×2×1080×2，8K分辨率是4K的4倍 7680×4320 = 3840×2×2160×2</p>
<p><img src="/images/media/video/res.png" alt="res"></p>
<table>
<thead>
<tr>
<th align="center">格式</th>
<th>分辨率</th>
<th>PAL</th>
<th>NTSC</th>
<th align="center">码率</th>
<th align="center">视频高宽比</th>
</tr>
</thead>
<tbody><tr>
<td align="center">8K</td>
<td>3310万像素</td>
<td>7680x4320</td>
<td>7680x4320</td>
<td align="center">40-60Mbps</td>
<td align="center">16:9</td>
</tr>
<tr>
<td align="center">5K</td>
<td>1470万像素</td>
<td>5120x2880</td>
<td>5120x2880</td>
<td align="center">25-35Mbps</td>
<td align="center">16:9</td>
</tr>
<tr>
<td align="center">4K</td>
<td>880万像素</td>
<td>4096x2160</td>
<td>4096x2160</td>
<td align="center">20-30Mbps</td>
<td align="center">256:135</td>
</tr>
<tr>
<td align="center">5MP</td>
<td>500万像素</td>
<td>2592x1944</td>
<td>2592x1944</td>
<td align="center">8Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">2K</td>
<td>310万像素</td>
<td>2048x1080</td>
<td>2048x1080</td>
<td align="center">10-15Mbps</td>
<td align="center">256:135</td>
</tr>
<tr>
<td align="center">3MP</td>
<td>300万像素</td>
<td>2047x1536</td>
<td>2047x1536</td>
<td align="center">6Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">1080p</td>
<td>130万像素</td>
<td>1920x1080</td>
<td>1920x1080</td>
<td align="center">2Mbps</td>
<td align="center">16:9</td>
</tr>
<tr>
<td align="center">2MP</td>
<td>200万像素</td>
<td>1600x1200</td>
<td>1600x1200</td>
<td align="center">4Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">1.3MP</td>
<td>130万像素</td>
<td>1280x1024</td>
<td>1280x1024</td>
<td align="center">2Mbps</td>
<td align="center">5:4</td>
</tr>
<tr>
<td align="center">960p</td>
<td>130万像素</td>
<td>1280x960</td>
<td>1280x960</td>
<td align="center">2Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">720p</td>
<td>100万像素</td>
<td>1280x720</td>
<td>1280x720</td>
<td align="center">2Mbps</td>
<td align="center">16:9</td>
</tr>
<tr>
<td align="center">960H</td>
<td>50万像素</td>
<td>960x480</td>
<td>960x480</td>
<td align="center">1Mbps</td>
<td align="center">2:1</td>
</tr>
<tr>
<td align="center">D1(4CIF)</td>
<td>40万像素</td>
<td>704x576</td>
<td>704x480</td>
<td align="center">&gt;1Mbps</td>
<td align="center">22:15</td>
</tr>
<tr>
<td align="center">VGA</td>
<td>30万像素</td>
<td>640x480</td>
<td>640x480</td>
<td align="center">&gt;1Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">Half D1</td>
<td>20万像素</td>
<td>352x576</td>
<td>352x480</td>
<td align="center">&gt;1Mbps</td>
<td align="center">11:15</td>
</tr>
<tr>
<td align="center">2CIF</td>
<td>20万像素</td>
<td>704x288</td>
<td>704x240</td>
<td align="center">&gt;0.5Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">BCIF</td>
<td>20万像素</td>
<td>528x288</td>
<td>528x240</td>
<td align="center">&gt;0.5Mbps</td>
<td align="center">22:9</td>
</tr>
<tr>
<td align="center">QVGA</td>
<td>10万像素</td>
<td>320x240</td>
<td>320x240</td>
<td align="center">&gt;0.5Mbps</td>
<td align="center">4:3</td>
</tr>
<tr>
<td align="center">CIF</td>
<td>10万像素</td>
<td>352x288</td>
<td>352x240</td>
<td align="center">&gt;0.5Mbps</td>
<td align="center">11:9</td>
</tr>
<tr>
<td align="center">QCIF</td>
<td>10万像素</td>
<td>176x144</td>
<td>176x144</td>
<td align="center">&gt;0.5Mbps</td>
<td align="center">11:9</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Idx</th>
<th>Name</th>
<th>W</th>
<th>H</th>
<th>Pxs</th>
<th>gcd</th>
<th>Per</th>
<th>C</th>
<th>P</th>
<th>T</th>
<th>V</th>
<th>Memo</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td></td>
<td>8</td>
<td>8</td>
<td>64</td>
<td>8</td>
<td>p1_1</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Macro Block</td>
</tr>
<tr>
<td>1</td>
<td>SQCIF</td>
<td>128</td>
<td>96</td>
<td>12,288</td>
<td>32</td>
<td>p4_3</td>
<td></td>
<td>Y</td>
<td></td>
<td>Y</td>
<td>Sub Quarter CIF</td>
</tr>
<tr>
<td>2</td>
<td></td>
<td>128</td>
<td>128</td>
<td>16,384</td>
<td>128</td>
<td>p1_1</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td></td>
<td>160</td>
<td>100</td>
<td>16,000</td>
<td>20</td>
<td>p8_5</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>QQVGA</td>
<td>160</td>
<td>120</td>
<td>19,200</td>
<td>40</td>
<td>p4_3</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Quarter-QVGA</td>
</tr>
<tr>
<td>5</td>
<td></td>
<td>160</td>
<td>128</td>
<td>20,480</td>
<td>32</td>
<td>p5_4</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>QCIF</td>
<td>176</td>
<td>144</td>
<td>25,344</td>
<td>16</td>
<td>p11_9</td>
<td></td>
<td>Y</td>
<td></td>
<td>Y</td>
<td>Quarter CIF</td>
</tr>
<tr>
<td>7</td>
<td></td>
<td>208</td>
<td>176</td>
<td>36,608</td>
<td>16</td>
<td>p7_5</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>. Nokia</td>
</tr>
<tr>
<td>8</td>
<td></td>
<td>220</td>
<td>176</td>
<td>38,720</td>
<td>44</td>
<td>p5_4</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>HQVGA</td>
<td>240</td>
<td>160</td>
<td>38,400</td>
<td>80</td>
<td>p3_2</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Half-QVGA</td>
</tr>
<tr>
<td>10</td>
<td>SCIF</td>
<td>256</td>
<td>192</td>
<td>49,152</td>
<td>64</td>
<td>p4_3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>CGA</td>
<td>320</td>
<td>200</td>
<td>64,000</td>
<td>40</td>
<td>p8_5</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>QVGA</td>
<td>320</td>
<td>240</td>
<td>76,800</td>
<td>80</td>
<td>p4_3</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td>Quarter Video Graphics Array</td>
</tr>
<tr>
<td>13</td>
<td></td>
<td>350</td>
<td>240</td>
<td>84,000</td>
<td>10</td>
<td>p13_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. Video CD</td>
</tr>
<tr>
<td>14</td>
<td>SIF(525)</td>
<td>352</td>
<td>240</td>
<td>84,480</td>
<td>16</td>
<td>p13_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>Source Input Format(NTSC). VCD(MPEG1)</td>
</tr>
<tr>
<td>15</td>
<td>CIF</td>
<td>352</td>
<td>288</td>
<td>101,376</td>
<td>32</td>
<td>p11_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>Common Intermediate Format. SIF(625)(PAL). VDC(MPEG1)</td>
</tr>
<tr>
<td>16</td>
<td>WQVGA</td>
<td>376</td>
<td>240</td>
<td>90,240</td>
<td>8</td>
<td>p11_7</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-QVGA. Apple iPod nano</td>
</tr>
<tr>
<td>17</td>
<td>WQVGA</td>
<td>384</td>
<td>240</td>
<td>92,160</td>
<td>48</td>
<td>p8_5</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-QVGA</td>
</tr>
<tr>
<td>18</td>
<td></td>
<td>384</td>
<td>288</td>
<td>110,592</td>
<td>96</td>
<td>p4_3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>. Display for SIF</td>
</tr>
<tr>
<td>19</td>
<td>WQVGA</td>
<td>400</td>
<td>240</td>
<td>96,000</td>
<td>80</td>
<td>p5_3</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-QVGA</td>
</tr>
<tr>
<td>20</td>
<td>WQVGA</td>
<td>432</td>
<td>240</td>
<td>103,680</td>
<td>48</td>
<td>p9_5</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-QVGA</td>
</tr>
<tr>
<td>21</td>
<td>HVGA</td>
<td>480</td>
<td>272</td>
<td>130,560</td>
<td>16</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Half-size VGA</td>
</tr>
<tr>
<td>22</td>
<td></td>
<td>480</td>
<td>300</td>
<td>144,000</td>
<td>60</td>
<td>p8_5</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. Umatic, Betamax, VHS, Video8</td>
</tr>
<tr>
<td>23</td>
<td>HVGA</td>
<td>480</td>
<td>320</td>
<td>153,600</td>
<td>160</td>
<td>p3_2</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Half-size VGA</td>
</tr>
<tr>
<td>24</td>
<td></td>
<td>480</td>
<td>350</td>
<td>168,000</td>
<td>10</td>
<td>p11_8</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. Super Betamax, Betacam (pro)</td>
</tr>
<tr>
<td>25</td>
<td>HVGA</td>
<td>480</td>
<td>360</td>
<td>172,800</td>
<td>120</td>
<td>p4_3</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td>Half-size VGA</td>
</tr>
<tr>
<td>26</td>
<td></td>
<td>480</td>
<td>420</td>
<td>201,600</td>
<td>60</td>
<td>p8_7</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. LaserDisc, Super VHS, Hi8</td>
</tr>
<tr>
<td>27</td>
<td></td>
<td>500</td>
<td>480</td>
<td>240,000</td>
<td>20</td>
<td>p1_1</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. Analog broadcast</td>
</tr>
<tr>
<td>28</td>
<td>DCIF</td>
<td>528</td>
<td>384</td>
<td>202,752</td>
<td>48</td>
<td>p11_8</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Double CIF</td>
</tr>
<tr>
<td>29</td>
<td>HVGA</td>
<td>640</td>
<td>240</td>
<td>153,600</td>
<td>80</td>
<td>p8_3</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Half-size VGA</td>
</tr>
<tr>
<td>30</td>
<td>EGA</td>
<td>640</td>
<td>350</td>
<td>224,000</td>
<td>10</td>
<td>p11_6</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>31</td>
<td></td>
<td>640</td>
<td>352</td>
<td>225,280</td>
<td>32</td>
<td>p11_6</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>. nHD for Video(32x32 macroblocks)</td>
</tr>
<tr>
<td>32</td>
<td>nHD</td>
<td>640</td>
<td>360</td>
<td>230,400</td>
<td>40</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>one ninth of a full HD 1080p frame</td>
</tr>
<tr>
<td>33</td>
<td></td>
<td>640</td>
<td>368</td>
<td>235,520</td>
<td>16</td>
<td>p7_4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>. nHD for Video(16x16 macroblocks)</td>
</tr>
<tr>
<td>34</td>
<td>VGA</td>
<td>640</td>
<td>480</td>
<td>307,200</td>
<td>160</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Video Graphics Array</td>
</tr>
<tr>
<td>35</td>
<td></td>
<td>670</td>
<td>480</td>
<td>321,600</td>
<td>10</td>
<td>p7_5</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. Enhanced Definition Betamax</td>
</tr>
<tr>
<td>36</td>
<td>HALF D1</td>
<td>704</td>
<td>288</td>
<td>202,752</td>
<td>32</td>
<td>p22_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>HALF D1 = 2× CIF</td>
</tr>
<tr>
<td>37</td>
<td>4SIF(525)</td>
<td>704</td>
<td>480</td>
<td>337,920</td>
<td>32</td>
<td>p13_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>4× SIF(525)</td>
</tr>
<tr>
<td>38</td>
<td>4CIF</td>
<td>704</td>
<td>576</td>
<td>405,504</td>
<td>64</td>
<td>p11_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>4× CIF, D1, 4× SIF(625)</td>
</tr>
<tr>
<td>39</td>
<td></td>
<td>720</td>
<td>348</td>
<td>250,560</td>
<td>12</td>
<td>p60_29</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Hercules</td>
</tr>
<tr>
<td>40</td>
<td>NTSC</td>
<td>720</td>
<td>480</td>
<td>345,600</td>
<td>240</td>
<td>p3_2</td>
<td></td>
<td></td>
<td>Y</td>
<td></td>
<td>National Television System Committee</td>
</tr>
<tr>
<td>41</td>
<td>EDTV</td>
<td>720</td>
<td>576</td>
<td>414,720</td>
<td>144</td>
<td>p5_4</td>
<td></td>
<td></td>
<td>Y</td>
<td></td>
<td>Enhanced-definition television</td>
</tr>
<tr>
<td>42</td>
<td>PAL</td>
<td>768</td>
<td>576</td>
<td>442,368</td>
<td>192</td>
<td>p4_3</td>
<td></td>
<td></td>
<td>Y</td>
<td></td>
<td>Phase Alternating Line</td>
</tr>
<tr>
<td>43</td>
<td>WVGA</td>
<td>800</td>
<td>480</td>
<td>384,000</td>
<td>160</td>
<td>p5_3</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-VGA</td>
</tr>
<tr>
<td>44</td>
<td>SVGA</td>
<td>800</td>
<td>600</td>
<td>480,000</td>
<td>200</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Super Video Graphics Array</td>
</tr>
<tr>
<td>45</td>
<td>WVGA</td>
<td>848</td>
<td>480</td>
<td>407,040</td>
<td>16</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-VGA</td>
</tr>
<tr>
<td>46</td>
<td>WVGA</td>
<td>852</td>
<td>480</td>
<td>408,960</td>
<td>12</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-VGA</td>
</tr>
<tr>
<td>47</td>
<td>FWVGA</td>
<td>854</td>
<td>480</td>
<td>409,920</td>
<td>2</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>Full Wide VGA</td>
</tr>
<tr>
<td>48</td>
<td>qHD</td>
<td>960</td>
<td>540</td>
<td>518,400</td>
<td>60</td>
<td>p16_9</td>
<td></td>
<td>Y</td>
<td></td>
<td></td>
<td>one quarter of a full HD 1080p frame</td>
</tr>
<tr>
<td>49</td>
<td>WSVGA</td>
<td>1024</td>
<td>576</td>
<td>589,824</td>
<td>64</td>
<td>p16_9</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-SVGA</td>
</tr>
<tr>
<td>50</td>
<td>WSVGA</td>
<td>1024</td>
<td>600</td>
<td>614,400</td>
<td>8</td>
<td>p12_7</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td>wide-SVGA</td>
</tr>
<tr>
<td>51</td>
<td></td>
<td>1024</td>
<td>640</td>
<td>655,360</td>
<td>128</td>
<td>p8_5</td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>52</td>
<td>XGA</td>
<td>1024</td>
<td>768</td>
<td>786,432</td>
<td>256</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>eXtended Graphics Array</td>
</tr>
<tr>
<td>53</td>
<td></td>
<td>1152</td>
<td>720</td>
<td>829,440</td>
<td>144</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>54</td>
<td>XGA+</td>
<td>1152</td>
<td>768</td>
<td>884,736</td>
<td>384</td>
<td>p3_2</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>eXtended Graphics Array Plus</td>
</tr>
<tr>
<td>55</td>
<td>XGA+</td>
<td>1152</td>
<td>864</td>
<td>995,328</td>
<td>288</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>eXtended Graphics Array Plus</td>
</tr>
<tr>
<td>56</td>
<td>HD720</td>
<td>1280</td>
<td>720</td>
<td>921,600</td>
<td>80</td>
<td>p16_9</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>High-definition television 720p</td>
</tr>
<tr>
<td>57</td>
<td>WXGA</td>
<td>1280</td>
<td>768</td>
<td>983,040</td>
<td>256</td>
<td>p5_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>wide-XGA</td>
</tr>
<tr>
<td>58</td>
<td>WXGA</td>
<td>1280</td>
<td>800</td>
<td>1,024,000</td>
<td>160</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>wide-XGA</td>
</tr>
<tr>
<td>59</td>
<td></td>
<td>1280</td>
<td>854</td>
<td>1,093,120</td>
<td>2</td>
<td>p3_2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>60</td>
<td>SXGA-</td>
<td>1280</td>
<td>960</td>
<td>1,228,800</td>
<td>320</td>
<td>p4_3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>61</td>
<td>SXGA</td>
<td>1280</td>
<td>1024</td>
<td>1,310,720</td>
<td>256</td>
<td>p5_4</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Super eXtended Graphics Array</td>
</tr>
<tr>
<td>62</td>
<td>HD</td>
<td>1360</td>
<td>768</td>
<td>1,044,480</td>
<td>16</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td>Y</td>
<td></td>
<td>HD, wide-XGA</td>
</tr>
<tr>
<td>63</td>
<td>HD</td>
<td>1365</td>
<td>768</td>
<td>1,048,320</td>
<td>3</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>HD, wide-XGA</td>
</tr>
<tr>
<td>64</td>
<td>HD</td>
<td>1366</td>
<td>768</td>
<td>1,049,088</td>
<td>2</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td>Y</td>
<td></td>
<td>HD, wide-XGA</td>
</tr>
<tr>
<td>65</td>
<td>SXGA+</td>
<td>1400</td>
<td>1050</td>
<td>1,470,000</td>
<td>350</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Super eXtended Graphics Array Plus</td>
</tr>
<tr>
<td>66</td>
<td>16SIF(525)</td>
<td>1408</td>
<td>960</td>
<td>1,351,680</td>
<td>64</td>
<td>p13_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>16× SIF(525)</td>
</tr>
<tr>
<td>67</td>
<td>16CIF</td>
<td>1408</td>
<td>1152</td>
<td>1,622,016</td>
<td>128</td>
<td>p11_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>16× CIF, 16× SIF(625)</td>
</tr>
<tr>
<td>68</td>
<td>WXGA+</td>
<td>1440</td>
<td>900</td>
<td>1,296,000</td>
<td>180</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide eXtended Graphics Array Plus</td>
</tr>
<tr>
<td>69</td>
<td></td>
<td>1440</td>
<td>960</td>
<td>1,382,400</td>
<td>480</td>
<td>p3_2</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>70</td>
<td></td>
<td>1440</td>
<td>1080</td>
<td>1,555,200</td>
<td>360</td>
<td>p4_3</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. HDV (miniDV)</td>
</tr>
<tr>
<td>71</td>
<td>UWXGA</td>
<td>1600</td>
<td>768</td>
<td>1,228,800</td>
<td>64</td>
<td>p25_12</td>
<td></td>
<td></td>
<td></td>
<td>ultra-wide-XGA</td>
<td></td>
</tr>
<tr>
<td>72</td>
<td>HD+</td>
<td>1600</td>
<td>900</td>
<td>1,440,000</td>
<td>100</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>73</td>
<td>UGA</td>
<td>1600</td>
<td>1200</td>
<td>1,920,000</td>
<td>400</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Ultra eXtended Graphics Array</td>
</tr>
<tr>
<td>74</td>
<td>WSXGA+</td>
<td>1680</td>
<td>1050</td>
<td>1,764,000</td>
<td>210</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td>Y</td>
<td>Widescreen Super eXtended Graphics Array Plus</td>
</tr>
<tr>
<td>75</td>
<td>HD1080</td>
<td>1920</td>
<td>1080</td>
<td>2,073,600</td>
<td>120</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>High-definition television 1080p</td>
</tr>
<tr>
<td>76</td>
<td>WUXGA</td>
<td>1920</td>
<td>1200</td>
<td>2,304,000</td>
<td>240</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Widescreen Ultra eXtended Graphics Array</td>
</tr>
<tr>
<td>77</td>
<td>2K</td>
<td>2048</td>
<td>1080</td>
<td>2,211,840</td>
<td>8</td>
<td>p17_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>2K Digital Cinema</td>
</tr>
<tr>
<td>78</td>
<td>QWXGA</td>
<td>2048</td>
<td>1152</td>
<td>2,359,296</td>
<td>128</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Quad Wide eXtended Graphics Array</td>
</tr>
<tr>
<td>79</td>
<td>QXGA</td>
<td>2048</td>
<td>1536</td>
<td>3,145,728</td>
<td>512</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Quad eXtended Graphics Array</td>
</tr>
<tr>
<td>80</td>
<td></td>
<td>2304</td>
<td>1440</td>
<td>3,317,760</td>
<td>288</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>. GDM-FW900 &amp; A7217A</td>
</tr>
<tr>
<td>81</td>
<td>WQHD</td>
<td>2560</td>
<td>1440</td>
<td>3,686,400</td>
<td>160</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td></td>
<td>Y</td>
<td>Wide Quad High Definition</td>
</tr>
<tr>
<td>82</td>
<td>WQXGA</td>
<td>2560</td>
<td>1600</td>
<td>4,096,000</td>
<td>320</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Quad eXtended Graphics Array</td>
</tr>
<tr>
<td>83</td>
<td></td>
<td>2560</td>
<td>1920</td>
<td>4,915,200</td>
<td>640</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>. Viewsonic P225f</td>
</tr>
<tr>
<td>84</td>
<td>QSXGA</td>
<td>2560</td>
<td>2048</td>
<td>5,242,880</td>
<td>512</td>
<td>p5_4</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Quad Super eXtended Graphics Array</td>
</tr>
<tr>
<td>85</td>
<td>WQSXGA</td>
<td>3200</td>
<td>2048</td>
<td>6,553,600</td>
<td>128</td>
<td>p14_9</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Quad Super eXtended Graphics Array</td>
</tr>
<tr>
<td>86</td>
<td>QUXGA</td>
<td>3200</td>
<td>2400</td>
<td>7,680,000</td>
<td>800</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Quad Ultra Extended Graphics Array</td>
</tr>
<tr>
<td>87</td>
<td>WQSXGA</td>
<td>3280</td>
<td>2048</td>
<td>6,717,440</td>
<td>16</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>WQSXGA. Coronis Fusion 6MP DL</td>
</tr>
<tr>
<td>88</td>
<td></td>
<td>3840</td>
<td>2048</td>
<td>7,864,320</td>
<td>256</td>
<td>p15_8</td>
<td></td>
<td></td>
<td>Y</td>
<td></td>
<td>. UHDTV</td>
</tr>
<tr>
<td>89</td>
<td>QFHD</td>
<td>3840</td>
<td>2160</td>
<td>8,294,400</td>
<td>240</td>
<td>p16_9</td>
<td></td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>Quad Full High Definition</td>
</tr>
<tr>
<td>90</td>
<td>WQUXGA</td>
<td>3840</td>
<td>2400</td>
<td>9,216,000</td>
<td>480</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Quad Ultra eXtended Graphics Array</td>
</tr>
<tr>
<td>91</td>
<td>4K-</td>
<td>4096</td>
<td>1716</td>
<td>7,028,736</td>
<td>4</td>
<td>p19_8</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td>92</td>
<td>4K</td>
<td>4096</td>
<td>2160</td>
<td>8,847,360</td>
<td>16</td>
<td>p17_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>4K Digital Cinema</td>
</tr>
<tr>
<td>93</td>
<td></td>
<td>4096</td>
<td>2304</td>
<td>9,437,184</td>
<td>256</td>
<td>p16_9</td>
<td></td>
<td></td>
<td></td>
<td>Y</td>
<td>. YouTube</td>
</tr>
<tr>
<td>94</td>
<td>HXGA</td>
<td>4096</td>
<td>3072</td>
<td>12,582,912</td>
<td>1024</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Hex[adecatuple] Extended Graphics Array</td>
</tr>
<tr>
<td>95</td>
<td></td>
<td>5120</td>
<td>3072</td>
<td>15,728,640</td>
<td>1024</td>
<td>p5_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>. WHXGA-</td>
</tr>
<tr>
<td>96</td>
<td>WHXGA</td>
<td>5120</td>
<td>3200</td>
<td>16,384,000</td>
<td>640</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Hex[adecatuple] Extended Graphics Array</td>
</tr>
<tr>
<td>97</td>
<td>HSXGA</td>
<td>5120</td>
<td>4096</td>
<td>20,971,520</td>
<td>1024</td>
<td>p5_4</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Hex[adecatuple] Super Extended Graphics Array</td>
</tr>
<tr>
<td>98</td>
<td>WHSXGA</td>
<td>6400</td>
<td>4096</td>
<td>26,214,400</td>
<td>256</td>
<td>p14_9</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Hex[adecatuple] Super Extended Graphics Array</td>
</tr>
<tr>
<td>99</td>
<td>HUXGA</td>
<td>6400</td>
<td>4800</td>
<td>30,720,000</td>
<td>1600</td>
<td>p4_3</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Hex[adecatuple] Ultra Extended Graphics Array</td>
</tr>
<tr>
<td>100</td>
<td>UHDTV</td>
<td>7680</td>
<td>4320</td>
<td>33,177,600</td>
<td>480</td>
<td>p16_9</td>
<td>Y</td>
<td></td>
<td>Y</td>
<td></td>
<td>Ultra High Definition Television</td>
</tr>
<tr>
<td>101</td>
<td>WHUXGA</td>
<td>7680</td>
<td>4800</td>
<td>36,864,000</td>
<td>960</td>
<td>p8_5</td>
<td>Y</td>
<td></td>
<td></td>
<td></td>
<td>Wide Hex[adecatuple] Ultra Extended Graphics Array</td>
</tr>
</tbody></table>
<p><em>Idx：顺序。Name：命名了的分辨率。W：宽度。H：高度。Pxs：总像素。gcd：宽度、高度的最大公约数。Per：比例。p16_9表示16:9。C：是否电脑屏幕分辨率；P：是否手机屏幕分辨率；T：是否电视屏幕分辨率；V：是否视频设备分辨率。</em></p>
<h3 id="码率模式"><a href="#码率模式" class="headerlink" title="码率模式"></a>码率模式</h3><p>-　VBR（Variable Bitrate）动态比特率也就是没有固定的比特率，用的是动态编码的方式，压缩软件在压缩时根据音频数据即时确定使用什么比特率，把较高的采样率用于复杂的动态画面，而把较低的采样率用于静态画面，合理利用资源，达到画质与体积可兼得的效果。</p>
<p>-　ABR（Average Bitrate）平均比特率是VBR的一种插值参数。LAME针对CBR不佳的文件体积比和VBR生成文件大小不定的特点独创了这种编码模式。ABR在指定的文件大小内，以每50帧（30帧约1秒）为一段，低频和不敏感频率使用相对低的流量，高频和大动态表现时使用高流量，可以做为VBR和CBR的一种折衷选择。</p>
<p>-　CBR（Constant Bitrate）常数比特率指文件从头到尾都是一种位速率。相对于VBR和ABR来讲，它压缩出来的文件体积很大，而且音质相对于VBR和ABR不会有明显的提高。</p>
<h3 id="QP"><a href="#QP" class="headerlink" title="QP"></a>QP</h3><p>Quantizer Parameter，量化参数，反映了空间细节压缩情况。值越小，量化越精细，图像质量越高，产生的码流也越长。如QP小，大部分的细节都会被保留；QP增大，一些细节丢失，码率降低，但图像失真加强和质量下降。</p>
<h3 id="profile-level"><a href="#profile-level" class="headerlink" title="profile level"></a>profile level</h3><ul>
<li><p>BP-Baseline Profile：基本画质。支持I/P 帧，只支持无交错（Progressive）和CAVLC；</p>
</li>
<li><p>EP-Extended profile：进阶画质。支持I/P/B/SP/SI 帧，只支持无交错（Progressive）和CAVLC；</p>
</li>
<li><p>MP-Main profile：主流画质。提供I/P/B 帧，支持无交错（Progressive）和交错（Interlaced），也支持CAVLC 和CABAC 的支持；</p>
</li>
<li><p>HP-High profile：高级画质。在main Profile 的基础上增加了8x8内部预测、自定义量化、无损视频编码和更多的YUV 格式。</p>
</li>
</ul>
<h2 id="视频编码"><a href="#视频编码" class="headerlink" title="视频编码"></a>视频编码</h2><p>视频是由不同的帧画面连续播放形成的。这些帧，主要分为三类，分别是I帧，B帧，P帧。</p>
<ul>
<li><p>I帧，是自带全部信息的独立帧，是最完整的画面，无需参考其它图像便可独立进行解码。视频序列中的第一个帧，始终都是I帧。</p>
</li>
<li><p>P帧，帧间预测编码帧，需要参考前面的I帧和/或P帧的不同部分，才能进行编码。P帧对前面的P和I参考帧有依赖性。但是，P帧压缩率比较高，占用的空间较小。</p>
</li>
</ul>
<p><img src="/images/media/video/Pframe.jpg" alt="P帧"></p>
<p>*　B帧，双向预测编码帧，以前帧和后作为参考帧。不仅参考前面，还参考后面的帧，所以，它的压缩率最高，可以达到200:1。不过，因为依赖后面的帧，所以不适合实时传输。</p>
<p><img src="/images/media/video/Bframe.jpg" alt="B帧"></p>
<p><img src="/images/media/video/venc.jpg" alt="venc"></p>
<h3 id="IDR"><a href="#IDR" class="headerlink" title="IDR"></a>IDR</h3><p>Instantaneous Decoding Refresh，即时解码刷新。为将首个I帧和其他I帧区别开，定义首个I帧为IDR帧。</p>
<h3 id="GOP"><a href="#GOP" class="headerlink" title="GOP"></a>GOP</h3><p>Group of picture，关键帧的周期，也就是两个IDR帧之间的距离，一个帧组的最大帧数，一般而言，每一秒视频至少需要使用 1 个关键帧。增加关键帧个数可改善质量，但是同时增加带宽和网络负载。<br>需要说明的是，通过提高GOP值来提高图像质量是有限度的，在遇到场景切换的情况时，H.264编码器会自动强制插入一个I帧，此时实际的GOP值被缩短了。另一方面，在一个GOP中，P、B帧是由I帧预测得到的，当I帧的图像质量比较差时，会影响到一个GOP中后续P、B帧的图像质量，直到下一个GOP开始才有可能得以恢复，所以GOP值也不宜设置过大。</p>
<p>同时，由于P、B帧的复杂度大于I帧，所以过多的P、B帧会影响编码效率，使编码效率降低。另外，过长的GOP还会影响Seek操作的响应速度，由于P、B帧是由前面的I或P帧预测得到的，所以Seek操作需要直接定位，解码某一个P或B帧时，需要先解码得到本GOP内的I帧及之前的N个预测帧才可以，GOP值越长，需要解码的预测帧就越多，seek响应的时间也越长。</p>
<p><img src="/images/media/video/gop.png" alt="gop"></p>
<p>-　H.265和H.264的区别</p>
<p>　　1．H.265是新的编码协议，也即是H.264的升级版。H.265标准保留H.264原来的某些技术，同时对一些相关的技术加以改进。新技术使用先进的技术用以改善码流、编码质量、延时和算法复杂度之间的关系，达到最优化设置。</p>
<p>　　2．H.265相比H.264最主要的改变是采用了块的四叉树划分结构，采用了从64×64～8×8像素的自适应块划分，并基于这种块划分结构采用一系列自适应的预测和变换等编码技术。</p>
<p>　　3．H.264由于算法优化，可以低于1Mbps的速度实现标清数字图像传送；H.265则可以实现利用1~2Mbps的传输速度传送720P（分辨率1280×720）普通高清音视频传送。</p>
<p>　　4．同样的画质和同样的码率，H.265比H2.64 占用的存储空间要少理论50%。</p>
<p>　　5．比起H.264/AVC，H.265/HEVC提供了更多不同的工具来降低码率，以编码单位来说，H.264中每个宏块（macroblock/MB）大小都是固定的16×16像素，而H.265的编码单位可以选择从最小的8×8到最大的64×64。</p>
<p>　　6．在相同的图象质量下，相比于H.264，通过H.265编码的视频大小将减少大约39～44%。</p>
<p>-　H.265的优势</p>
<p>　　1．H.265/HEVC的编码架构大致上和H.264/AVC的架构相似，主要也包含，帧内预测（intra prediction）、帧间预测（inter prediction）、转换（transform）、量化（quantization）、去区块滤波器（deblocking filter）、熵编码（entropy coding）等模块。</p>
<p>　　但在HEVC编码架构中，整体被分为了三个基本单位，分别是编码单位（coding unit, CU）、预测单位（predict unit, PU）和转换单位（transform unit, TU）。</p>
<p>　　2．比起H.264/AVC，H.265/HEVC提供了更多不同的工具来降低码率，以编码单位来说，H.264中每个宏块（macroblock/MB）大小都是固定的16x16像素，而H.265的编码单位可以选择从最小的8×8到最大的64×64。</p>
<p>　　3．H.265的帧内预测模式支持33种方向（H.264只支持8种），并且提供了更好的运动补偿处理和矢量预测方法。</p>
<p>　　4．反复的质量比较测试已经表明，在相同的图象质量下，相比于H.264，通过H.265编码的视频大小将减少大约39～44%。由于质量控制的测定方法不同，这个数据也会有相应的变化。</p>
<p>　　5．通过主观视觉测试得出的数据显示，在码率减少51～74%的情况下，H.265编码视频的质量还能与H.264编码视频近似甚至更好，其本质上说是比预期的信噪比（PSNR）要好。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/19/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><span class="page-number current">20</span><a class="page-number" href="/page/21/">21</a><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/21/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ubun2</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">214</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ubun2</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v5.4.2
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.7.2
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
