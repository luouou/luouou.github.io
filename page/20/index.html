<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="nullptr">
<meta property="og:url" content="http://example.com/page/20/index.html">
<meta property="og:site_name" content="nullptr">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ubun2">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/20/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>nullptr</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">nullptr</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">吾生也有涯 而知也无涯</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/uart-bus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/uart-bus/" class="post-title-link" itemprop="url">串口通信协议</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-05 17:04:27" itemprop="dateModified" datetime="2022-07-05T17:04:27+08:00">2022-07-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="UART"><a href="#UART" class="headerlink" title="UART"></a>UART</h2><p>UART通用异步接收器/发送。传输数据包由起始位、数据帧、奇偶校验位和停止位组成。</p>
<p><img src="/images/uart/uart.png" alt="img"></p>
<p><strong>起始位</strong></p>
<p>当不传输数据时，UART数据传输线通常保持高电压电平。若要开始数据传输，发送UART会将传输线从高电平拉到低电平并保持1个时钟周期。当接收UART检测到高到低电压跃迁时，便开始以波特率对应的频率读取数据帧中的位。</p>
<p><strong>数据帧</strong></p>
<p>数据帧包含所传输的实际数据，如果使用奇偶校验位，数据帧长度可以是5 - 8位。如果不使用奇偶校验位，数据帧长度可以是9位。低位先发送。</p>
<p><strong>校验</strong></p>
<p>通过奇偶校验位，接收器就可以判断传输期间是否有数据发生改变，当奇偶校验位与数据匹配时，则认为传输未出错。</p>
<ul>
<li>奇校验(odd parity)：让传输的数据（包含校验位）中1的个数是否为奇数，即如果传输字节中1的个数是偶数，则校验位就要为1，否则为0。</li>
<li>偶校验(even parity)：传输的数据（包含校验位）中1的个数是否为偶数，即如果传输字节中1的个数是偶数，则校验位就要为0，否则为0。</li>
<li>1校验(mark parity): 校验位始终为1。</li>
<li>0校验(space parity): 校验位始终为0。</li>
</ul>
<p><strong>停止位</strong></p>
<p>表示一帧数据的结束，发送端将数据传输线从低电压驱动到高电压并保持1、1.5、2bit的时间。</p>
<p>波特率：意思是每秒传输这么多个比特位数(bit)。</p>
<p>1、当为奇数校验：”A”字符的8个bit位中有两个1,那么奇偶校验位为1才能满足1的个数为奇数(奇校验)。图-1的波形就是这种情况。<br>2、当为偶数校验：”A”字符的8个bit位中有两个1,那么奇偶校验位为0才能满足1的个数为偶数(偶校验)。<br>此位还可以去除，即不需要奇偶校验位。</p>
<h2 id="RS232"><a href="#RS232" class="headerlink" title="RS232"></a>RS232</h2><p>RS232是串口的一个标准，RS232是负逻辑电平，它定义+5 ~ +12V为低电平，而-12 ~ -5V为高电平。</p>
<ul>
<li>最大传输距离 50 米。</li>
<li>传输速率较低，在异步传输时，波特率为 20Kbps。</li>
<li>只允许一对一通信。</li>
</ul>
<p><img src="/images/uart/RS232.webp" alt="img"><br><img src="/images/uart/max3232.png" alt="max3232"></p>
<h2 id="RS485"><a href="#RS485" class="headerlink" title="RS485"></a>RS485</h2><p>RS-232接口只能点对点的通信，不能实现联网功能，于是一个新的标准RS-485产生了。RS-485使用一对双绞线采用差分传输方式，由于是差分通信，因此数据的接收和发送数据不能同时进行，只能工作在半双工模式，常用于总线网。</p>
<ul>
<li>电气特性：逻辑1以两线间的电压差为+2 ~ 6V表示；逻辑0以两线间的电压差为-2 ~ 6V表示。</li>
<li>最大的通信距离约为1200米（9600bps 时），实际上可达 3000 米。</li>
<li>最大传输速率为10Mb/s。</li>
<li>RS-485总线一般最大支持32个节点。</li>
</ul>
<p><img src="/images/uart/max485.png" alt="MAX485"></p>
<p>为了提高RS485的抗干扰性能，需要在靠近MAX485的AB引脚之间并接一个100 ~ 1K的电阻。</p>
<h2 id="RS422"><a href="#RS422" class="headerlink" title="RS422"></a>RS422</h2><p>RS-422（EIA RS-422-A Standard）是Apple的Macintosh计算机的串口连接标准。有4根信号线：两根发送，两根接收。由于RS-422 的收与发是分开的，所以可以全双工，适用于两个站之间通信，星型网、环网，不可用于总线网。</p>
<ul>
<li>最大传输距离为1219米，最大传输速率为10Mb/s。</li>
<li>最多可接10个节点。</li>
<li>支持点对多的双向通信。</li>
</ul>
<p><img src="/images/uart/RS-xxx.webp" alt="RS-xxx"></p>
<h2 id="帧协议"><a href="#帧协议" class="headerlink" title="帧协议"></a>帧协议</h2><p><img src="/images/uart/uart-protocol.jpg" alt="img"></p>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.analog.com/cn/analog-dialogue/articles/uart-a-hardware-communication-protocol.html">https://www.analog.com/cn/analog-dialogue/articles/uart-a-hardware-communication-protocol.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/pci/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/pci/" class="post-title-link" itemprop="url">PCI总线</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:55:51" itemprop="dateModified" datetime="2022-06-08T17:55:51+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PCI即Peripheral Component Interconnect，中文意思是“外围器件互联”，是由PCISIG (PCI Special Interest Group)推出的一种局部并行总线标准。PCI总线是由ISA(Industy Standard Architecture)总线发展而来的，是一种同步的独立于处理器的32位或64位局部总线。从结构上看，PCI是在CPU的供应商和原来的系统总线之间插入的一级总线，具体由一个桥接电路实现对这一层的管理，并实现上下之间的接口以协调数据的传送。广泛用于当前高档微机、工作站，以及便携式微机。主要用于连接显卡、网卡、声卡。</p>
<p>PCI总线是一种树型结构，并且独立于CPU总线，可以和CPU总线并行操作。PCI总线上可以挂接PCI设备和PCI桥，PCI总线上只允许有一个PCI主设备（同一时刻），其他的均为PCI 从设备，而且读写操作只能在主从设备之间进行，从设备之间的数据交换需要通过主设备中转。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/diode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/diode/" class="post-title-link" itemprop="url">二极管参数</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="常规参数"><a href="#常规参数" class="headerlink" title="常规参数"></a>常规参数</h3><ul>
<li><strong>正向导通压降</strong></li>
</ul>
<p>压降：二极管的电流流过负载以后相对于同一参考点的电势（电位）变化称为电压降，简称压降。</p>
<p>导通压降：二极管开始导通时对应的电压。</p>
<p>正向特性：在二极管外加正向电压时，在正向特性的起始部分，正向电压很小，不足以克服PN结内电场的阻挡作用，正向电流几乎为零。当正向电压大到足以克服PN结电场时，二极管正向导通，电流随电压增大而迅速上升。</p>
<p>反向特性：外加反向电压不超过一定范围时，通过二极管的电流是少数载流子漂移运动所形成反向电流。由于反向电流很小，二极管处于截止状态。反向电压增大到一定程度后，二极管反向击穿。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZk45v8aXXoyHQFJzOFxsD6dlX5tS0N9pnSKSvMUapO88vPM7AkAe5X7w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="img"></p>
<ul>
<li><strong>正向导通压降与导通电流的关系</strong></li>
</ul>
<p>在二极管两端加正向偏置电压时，其内部电场区域变窄，可以有较大的正向扩散电流通过PN结。只有当正向电压达到某一数值(这一数值称为“门槛电压”，锗管约为0.2V，硅管约为0.6V)以后，二极管才能真正导通。但二极管的导通压降是恒定不变的吗?它与正向扩散电流又存在什么样的关系?通过下图1的测试电路在常温下对型号为SM360A的二极管进行导通电流与导通压降的关系测试，可得到如图2所示的曲线关系：正向导通压降与导通电流成正比，其浮动压差为0.2V。从轻载导通电流到额定导通电流的压差虽仅为0.2V，但对于功率二极管来说它不仅影响效率也影响二极管的温升，所以在价格条件允许下，尽量选择导通压降小、额定工作电流较实际电流高一倍的二极管。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkt1qDGpibE7o3uMEAmbxHjNEnSUJdfPtibiaorfW589WicrHqibV2K9wN97w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="二极管导通压降测试电路"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkV1ibwvm5JYmzWcFADEI1gW1VHwib0tYXwfGbDxPQUKn84hvsOFNAyp6A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="导通压降与导通电流关系"></p>
<ul>
<li><strong>正向导通压降与环境的温度的关系</strong></li>
</ul>
<p>在我们开发产品的过程中，高低温环境对电子元器件的影响才是产品稳定工作的最大障碍。环境温度对绝大部分电子元器件的影响无疑是巨大的，二极管当然也不例外，在高低温环境下通过对SM360A的实测数据表1与图3的关系曲线可知道：二极管的导通压降与环境温度成反比。在环境温度为-45℃时虽导通压降最大，却不影响二极管的稳定性，但在环境温度为75℃时，外壳温度却已超过了数据手册给出的125℃，则该二极管在75℃时就必须降额使用。这也是为什么开关电源在某一个高温点需要降额使用的因素之一。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkZ4lic7M3Y3AdqNV1icQQo0XshwZ0yKZ6CLTZttnadD6jRVsibp4EI2ImQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="导通压降与导通电流测试数据"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkibMhpkDI5dcqVGMviaOGgChmvSu9kXYd8PZqfpO8C5X1owAPTNZV3Oiaw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="导通压降与环境温度关系曲线"></p>
<ul>
<li><strong>最大整流电流IF</strong></li>
</ul>
<p>是指二极管长期连续工作时，允许通过的最大正向平均电流值，其值与PN结面积及外部散热条件等有关。因为电流通过管子时会使管芯发热，温度上升，温度超过容许限度（硅管为141左右，锗管为90左右）时，就会使管芯过热而损坏。所以在规定散热条件下，二极管使用中不要超过二极管最大整流电流值。例如，常用的IN4001－4007型锗二极管的额定正向工作电流为1A。</p>
<ul>
<li><strong>最高反向工作电压Udrm</strong></li>
</ul>
<p>加在二极管两端的反向电压高到一定值时，会将管子击穿，失去单向导电能力。为了保证使用安全，规定了最高反向工作电压值。例如，IN4001二极管反向耐压为50V，IN4007反向耐压为1000V。</p>
<ul>
<li><strong>反向电流Idrm</strong></li>
</ul>
<p>反向电流是指二极管在常温（25℃）和最高反向电压作用下，流过二极管的反向电流。反向电流越小，管子的单方向导电性能越好。值得注意的是反向电流与温度有着密切的关系，大约温度每升高10℃，反向电流增大一倍。例如2AP1型锗二极管，在25℃时反向电流若为250uA，温度升高到35℃，反向电流将上升到500uA，依此类推，在75℃时，它的反向电流已达8mA，不仅失去了单方向导电特性，还会使管子过热而损坏。又如，2CP10型硅二极管，25℃时反向电流仅为5uA，温度升高到75℃时，反向电流也不过160uA。故硅二极管比锗二极管在高温下具有较好的稳定性。</p>
<p>外加反向电压不超过一定范围时，通过二极管的电流是少数载流子漂移运动所形成反向电流。由于反向电流很小，二极管处于截止状态。这个反向电流又称为反向饱和电流或漏电流，二极管的反向饱和电流受温度影响很大。</p>
<p>一般硅管的反向电流比锗管小得多，小功率硅管的反向饱和电流在nA数量级，小功率锗管在μA数量级。温度升高时，半导体受热激发，少数载流子数目增加，反向饱和电流也随之增加。</p>
<p>二极管漏电流与反向电压的关系</p>
<p>在二极管两端加反向电压时，其内部电场区域变宽，有较少的漂移电流通过PN结，形成我们所说的漏电流。漏电流也是评估二极管性能的重要参数，二极管漏电流过大不仅使其自身温升高，对于功率电路来说也会影响其效率，不同反向电压下的漏电流是不同的，关系如图4所示：反向电压愈大，漏电流越大，在常温下肖特基管的漏电流可忽略。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkkIWySV60Xq8vNcObvDWy33UUKLxNiaLicrNOCmgibWhX2u1ZAjgpUsnpw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="反向电压与漏电流关系曲线"></p>
<p>二极管漏电流与环境温度的关系</p>
<p>其实对二极管漏电流影响最大的还是环境温度，下图5是在额定反压下测试的关系曲线，从中可以看出：温度越高，漏电流越大。在75℃后成直线上升，该点的漏电流是导致二极管外壳在额定电流下达到125℃的两大因素之一，只有通过降额反向电压和正向导通电流才能降低二极管的工作温度。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZk2C3xjuEd0PKlI8KicqunibJgOVDyfqcFOAWrMjko8yfQbib7f8YcJ3FlA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="漏电流与环境温度关系曲线"></p>
<ul>
<li><strong>电压温度系数αuz</strong></li>
</ul>
<p>αuz指温度每升高一摄氏度时的稳定电压的相对变化量。uz为6v左右的稳压二极管的温度稳定性较好</p>
<h3 id="极限参数"><a href="#极限参数" class="headerlink" title="极限参数"></a>极限参数</h3><ul>
<li><strong>最大反向峰值电压VRM</strong></li>
</ul>
<p>即使没有反向电流,只要不断地提高反向电压,迟早会使二极管损坏。这种能加上的反向电压,不是瞬时电压,而是反复加上的正反向电压。因给整流器加的是交流电压,它的最大值是规定的重要因子。</p>
<ul>
<li><strong>最大直流反向电压VR</strong></li>
</ul>
<p>上述最大反向峰值电压是反复加上的峰值电压,VR是连续加直流电压时的值。用于直流电路,最大直流反向电压对于确定允许值和上限值是很重要的。</p>
<ul>
<li><strong>最大浪涌电流Isurge</strong></li>
</ul>
<p>允许流过的过量的正向电流。它不是正常电流,而是瞬间电流,这个值相当大。</p>
<ul>
<li><strong>最大平均整流电流IO</strong></li>
</ul>
<p>在半波整流电路中,流过负载电阻的平均整流电流的最大值。这是设计时非常重要的值。</p>
<ul>
<li><strong>最大交流输入电压VI</strong></li>
</ul>
<p>在半波整流电路(电阻负荷)上加的正弦交流电压的有效值。这也是选择整流器时非常重要的参数。最大峰值正向电流IFM 正向流过的最大电流值,这也是设计整流电路时的重要参数。</p>
<ul>
<li><strong>最大功率P</strong></li>
</ul>
<p>二极管中有电流流过,就会吸热,而使自身温度升高。最大功率P为功率的最大值。具体讲就是加在二极管两端的电压乘以流过的电流。这个极限参数对稳压二极管,可变电阻二极管显得特别重要。</p>
<ul>
<li><strong>反向电流IR</strong></li>
</ul>
<p>一般说来,二极管中没有反向电流流过,实际上,加一定的反向电压,总会有电流流过,这就是反向电流。不用说,好的二极管,反向电流较小。</p>
<ul>
<li><strong>反向恢复时间tre</strong></li>
</ul>
<p>指在规定的负载、正向电流及最大反向瞬态电压下的反向恢复时间。从正向电压变成反向电压时,理想情况是电流能瞬时截止,实际上,一般要延迟一点点时间。决定电流截止延时的量,就是反向恢复时间。虽然它直接影响二极管的开关速度,但不一定说这个值小就好。</p>
<ul>
<li><strong>IF— 最大平均整流电流</strong></li>
</ul>
<p>指二极管工作时允许通过的最大正向平均电流。该电流由PN结的结面积和散热条件决定。使用时应注意通过二极管的平均电流不能大于此值，并要满足散热条件。例如1N4000系列二极管的IF为1A。</p>
<ul>
<li><strong>VR— 最大反向工作电压</strong></li>
</ul>
<p>指二极管两端允许施加的最大反向电压。若大于此值，则反向电流(IR)剧增，二极管的单向导电性被破坏，从而引起反向击穿。通常取反向击穿电压(VB)的一半作为(VR)。例如1N4001的VR为50V，1N4007的VR为1OOOV.</p>
<ul>
<li><p><strong>IR— 反向电流。</strong><br>指二极管未击穿时反向电流值。温度对IR的影响很大。例如1N4000系列二极管在100°C条件IR应小于500uA;在25°C时IR应小于5uA。</p>
</li>
<li><p><strong>VR— 击穿电压。</strong></p>
</li>
</ul>
<p>指二极管反向伏安特性曲线急剧弯曲点的电压值。反向为软特性时，则指给定反向漏电流条件下的电压值。</p>
<h3 id="交流参数"><a href="#交流参数" class="headerlink" title="交流参数"></a>交流参数</h3><ul>
<li><strong>CO— 零偏压电容。</strong></li>
</ul>
<p>指二极管两端电压为零时，扩散电容及结电容的容量之和。值得注意的，由于制造工艺的限制，即使同一型号的二极管其参数的离散性也很大。手册中给出的参数往往是一个范围，若测试条件改变，则相应的参数也会发生变化，例如在25°C时测得1N5200系列硅塑封整流二极管的IR小于1OuA，而在 100°C时IR则变为小于500uA。</p>
<p>我们知道二极管具有容易从P型向N型半导体通过电流,而在相反方向不易通过的的特性。这两种特性合起来就产生了电容器的作用,即蓄积电荷的作用。蓄积有电荷,当然要放电。放电可以在任何方向进行。而二极管只在一个方向有电流流过这种说法,严格来说是不成立的。这种情况在高频时就明显表现出来。因此,二极管的极电容以小为好。</p>
<ul>
<li><strong>动态电阻Rd</strong></li>
</ul>
<p>二极管特性曲线静态工作点Q附近电压的变化与相应电流的变化量之比。</p>
<ul>
<li><strong>最高工作频率Fm</strong></li>
</ul>
<p>Fm是二极管工作的上限频率。因二极管与PN结一样，其结电容由势垒电容组成。所以Fm的值主要取决于PN结结电容的大小。若是超过此值。则单向导电性将受影响。</p>
<ul>
<li><strong>二极管反向恢复时间</strong></li>
</ul>
<p>如图6所示，二极管的反向恢复时间为电流通过零点由正向转换成反向，再由反向转换到规定低值的时间间隔，实际上是释放二极管在正向导通期间向PN结的扩散电容中储存的电荷。反向恢复时间决定了二极管能在多高频率的连续脉冲下做开关使用，如果反向脉冲的持续时间比反向恢复时间短，则二极管在正向、反向均可导通就起不到开关的作用。PN结中储存的电荷量与反向电压共同决定了反向恢复时间，而在高频脉冲下不但会使其损耗加重，也会引起较大的电磁干扰。所以知道二极管的反向恢复时间正确选择二极管和合理设计电路是必要的，选择二极管时应尽量选择PN结电容小、反向恢复时间短的，但大多数厂家都不提供该参数数据。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ewiaKibzhXCHPUoeYgxyMhPTaIb3eDgrZkxqBM8wAn7vicNLsDcantI8m8Via5cQicpLkX8PHibWQMDt8XRf9n0M15bA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="二极管恢复时间示意图"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/speaker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/speaker/" class="post-title-link" itemprop="url">speaker</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><strong>额定阻抗</strong></li>
</ul>
<p>额定阻抗是指音频为400Hz时，从扬声器输入端测得的阻抗。它一般是音圈直流电阻的1.2~1.5倍。一般动圈式扬声器常见的阻抗有4Ω、8Ω、16Ω、32Ω等。</p>
<ul>
<li><strong>功率</strong></li>
</ul>
<p>扬声器的功率分为额定功率、最小功率、最大功率和瞬间功率，单位均为W。</p>
<p>额定功率也称标称功率，是指扬声器长时间正常连续工作而无明显失真的输入平均电功率。</p>
<p>最小功率也称起步功率，是指扬声器能被推动工作的基准电功率值。</p>
<p>最大功率也称最大承载功率，是指扬声器长时间连续工作时所能承受的最大输入功率。</p>
<p>瞬间功率也称瞬时承受功率，是指扬声器在短时间内（10ms）所能承受的最大功率，一般为额定功率的8~30倍。</p>
<ul>
<li><strong>频率特性</strong></li>
</ul>
<p>扬声器的频率特性是指当输入扬声器的信号电压恒定不变时，扬声器有参考轴上的输出声压随输入信号的频率变化而变化的规律。它是一条随频率变化的频率响应（简称频响）曲线，反映了扬声器对不同频率声波的辐射能力。</p>
<p>扬声器的频响曲线是具有许多峰谷点的不规则连续曲线，将扬声器的谐振频率作为低频不限频率，而将频响曲线高频端的交点作为高频上限频率。低频下限与高频上限之间的频率范围。称为扬声器的有效频率范围。</p>
<p>扬声器的频响曲线越平坦，说明频率失真越小，有效频率范围越宽。</p>
<p>一般低音扬声器的频率范围在20 ~ 3kHZ之间，中音扬声器的频率范围在500 ~ 5kHZ之间，高音扬声器的频率范围在2 ~ 20kHZ之间。</p>
<ul>
<li><strong>谐振频率</strong></li>
</ul>
<p>谐振频率是扬声器频率范围的下限，谐振频率低，扬声器的低音重放的质感和力度也越好。</p>
<p>低音扬声器的谐振频率值一般是随其口径的增大而降低，6in（in=0.0254m）低音扬声器的谐振频率为50HZ左右，8in（in=0.0254m）低音扬声器的谐振频率为40HZ左右，10in低音扬声器的谐振频率为30HZ左右，12in低音扬声器的谐振频率为20HZ左右。</p>
<ul>
<li><strong>灵敏度（dB/W）</strong></li>
</ul>
<p>灵敏度也称输出声压级，主要用来反映扬声器的电-声转换效率。高灵敏度扬声器，用较小的电功率即可推动它。</p>
<p>扬声器的灵敏度有特性灵敏度级和平均特性灵敏度两种表示方法，前者最常用且误差较小。</p>
<p>扬声器的灵敏度是指输入功率为1W的噪声电压时，在扬声器轴向正面1m处所测得的声压大小。灵敏度是衡量扬声器对音频信号中的细节能否巨细无遗地重放的指标。灵敏度越高，则扬声器对音频信号中细节均能作出的响应。作为Hi-Fi扬声器的灵敏度应大于86dB/W。</p>
<ul>
<li><strong>失真度</strong></li>
</ul>
<p>扬声器的失真主要表现为重放声音与原始声音有差异。它又分为谐波失真、瞬态失真、互调失真和相位失真。</p>
<ul>
<li><strong>等效质量</strong></li>
</ul>
<p>扬声器的等效质量也称振动质量，是扬声器振动系统的静态质量（指振膜和音圈本身的质量）与同振质量（指振膜两边随之一起振动的部分空气层的质量）之和。</p>
<p>等效质量与扬声器的口径成正比，与扬声器的谐振频率成反比。</p>
<ul>
<li><strong>等效顺性</strong></li>
</ul>
<p>等效顺性也称力顺或声顺，表示扬声器悬置系统的松紧度（指折环和定位支片的柔软程度）或称为受力后位移的顺从性。</p>
<ul>
<li><strong>弹性系数</strong></li>
</ul>
<p>扬声器的弹性系数也称振动系统的等效力劲度，是表示锥盆折环和定位支片刚性的参数，它与扬声器的谐振频率成正比，与振动系统的等效质量成反比。</p>
<ul>
<li><strong>总品质因数</strong></li>
</ul>
<p>扬声器的总品质因数也称Qts值，用来反映其振动系统消耗能量的较慢，即表示振动系统损耗的大小。</p>
<ul>
<li><strong>等效容积</strong></li>
</ul>
<p>扬声器等效容积是指扬声器振动系统顺性的等效空气容积。扬声器的口径越大，其等效容积也越大。</p>
<ul>
<li><strong>等效振动半径</strong></li>
</ul>
<p>扬声器的等效振动半径也称振膜有效面积，它表示有助于声音辐射的面积，一般指从振膜中心到折环中间处的长度。</p>
<ul>
<li><strong>磁感应强度与磁通量</strong></li>
</ul>
<p>磁感应强度也称磁隙强度，用来表示扬声器空气隙中磁场强度的品质标记。</p>
<p>磁通量等于磁感应强度与空气隙面积平均值的乘积。</p>
<ul>
<li><strong>线性范围</strong></li>
</ul>
<p>扬声器的线性范围是指振膜的最大线性位移。扬声器工作时，若振膜的位移超过线性范围值，放音失真就会增大。</p>
<ul>
<li><strong>指向性</strong></li>
</ul>
<p>指向性是指扬声器在不同方向的声压辐射能力随频率而变化的特性，或指扬声器声波辐射到空间各个方向的能力。输入扬声器的信号频率越高，指向性越强。指向性与扬声器的口径有关，口径大时指向性尖，口径小时指向性宽。指向性还与频率有关，一般而言，对250Hz以下的低频信号，没有明显的指向性。对1.5kHz以下的高频信号则有明显的指向性。</p>
<ul>
<li><strong>谐波失真（TMD%）</strong></li>
</ul>
<p>扬声器的失真有很多种，常见的有谐波失真（多由扬声器磁场不均匀以及振动系统的畸变而引起，常在低频时产生）、互调失真（因两种不同频率的信号同时加入扬声器，互相调制引起的音质劣化）和瞬态失真（因振动系统的惯性不能紧跟信号的变化而变化，从而引起信号失真）等。谐波失真是指重放时，增加了原信号中没有的谐波成份。扬声器的谐波失真来源于磁体磁场不均匀、振动膜的特性、音圈位移等非线性失真。目前，较好的扬声器的谐波失真指标不大于5%。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/triode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/triode/" class="post-title-link" itemprop="url">常用贴片三极管丝印与型号对照表</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <table>
<thead>
<tr>
<th>丝印</th>
<th>三极管型号</th>
</tr>
</thead>
<tbody><tr>
<td>1A</td>
<td>BC846A</td>
</tr>
<tr>
<td>1AM</td>
<td>MMBT3904</td>
</tr>
<tr>
<td>1AMZ</td>
<td>MMBT3904LT1</td>
</tr>
<tr>
<td>1B</td>
<td>BC846B</td>
</tr>
<tr>
<td>1D</td>
<td>MMBTA42</td>
</tr>
<tr>
<td>1E</td>
<td>BC847A</td>
</tr>
<tr>
<td>1F</td>
<td>BC847B</td>
</tr>
<tr>
<td>1G</td>
<td>BC847C</td>
</tr>
<tr>
<td>1J</td>
<td>BC848A</td>
</tr>
<tr>
<td>1K</td>
<td>BC848B</td>
</tr>
<tr>
<td>1L</td>
<td>BC848C</td>
</tr>
<tr>
<td>1T</td>
<td>S9011</td>
</tr>
<tr>
<td>1P</td>
<td>MMBT2222</td>
</tr>
<tr>
<td>2T</td>
<td>S9012</td>
</tr>
<tr>
<td>2A</td>
<td>MMBT3906</td>
</tr>
<tr>
<td>2AM</td>
<td>S8550</td>
</tr>
<tr>
<td>2D</td>
<td>MMBTA92</td>
</tr>
<tr>
<td>2F</td>
<td>MMBT2907</td>
</tr>
<tr>
<td>2L</td>
<td>MMBT5401</td>
</tr>
<tr>
<td>2T1</td>
<td>S9012</td>
</tr>
<tr>
<td>2TY</td>
<td>S8550</td>
</tr>
<tr>
<td>2X</td>
<td>2N4401</td>
</tr>
<tr>
<td>3A</td>
<td>BC856A</td>
</tr>
<tr>
<td>3B</td>
<td>BC856B</td>
</tr>
<tr>
<td>3E</td>
<td>BC857A</td>
</tr>
<tr>
<td>3F</td>
<td>BC857B</td>
</tr>
<tr>
<td>3J</td>
<td>BC858A</td>
</tr>
<tr>
<td>3K</td>
<td>BC858B</td>
</tr>
<tr>
<td>3L</td>
<td>BC858C</td>
</tr>
<tr>
<td>5A</td>
<td>BC807-16</td>
</tr>
<tr>
<td>5B</td>
<td>BC807-25</td>
</tr>
<tr>
<td>5C</td>
<td>BC807-40</td>
</tr>
<tr>
<td>6A</td>
<td>BC817-16</td>
</tr>
<tr>
<td>6B</td>
<td>BC817-25</td>
</tr>
<tr>
<td>6C</td>
<td>BC817-40</td>
</tr>
<tr>
<td>702</td>
<td>2N7002</td>
</tr>
<tr>
<td>AD</td>
<td>2SC3838</td>
</tr>
<tr>
<td>BA</td>
<td>2SA1015</td>
</tr>
<tr>
<td>CR</td>
<td>2SC945</td>
</tr>
<tr>
<td>CS</td>
<td>2SA733</td>
</tr>
<tr>
<td>G1</td>
<td>MMBT5551</td>
</tr>
<tr>
<td>HF</td>
<td>2SC1815</td>
</tr>
<tr>
<td>J3</td>
<td>S9013</td>
</tr>
<tr>
<td>J3Y</td>
<td>S8050</td>
</tr>
<tr>
<td>J6</td>
<td>S9014</td>
</tr>
<tr>
<td>J8</td>
<td>S9018</td>
</tr>
<tr>
<td>KL4</td>
<td>BAT54S</td>
</tr>
<tr>
<td>L6</td>
<td>2SC1623</td>
</tr>
<tr>
<td>M5C</td>
<td>MMBD7000</td>
</tr>
<tr>
<td>M6</td>
<td>S9015</td>
</tr>
<tr>
<td>R23</td>
<td>2SC3356</td>
</tr>
<tr>
<td>V1</td>
<td>UN2111</td>
</tr>
<tr>
<td>V2</td>
<td>UN2112</td>
</tr>
<tr>
<td>V3</td>
<td>UN2113</td>
</tr>
<tr>
<td>V4</td>
<td>UN2211</td>
</tr>
<tr>
<td>V5</td>
<td>UN2212</td>
</tr>
<tr>
<td>V6</td>
<td>UN2213</td>
</tr>
<tr>
<td>W2A</td>
<td>PMBT3906</td>
</tr>
<tr>
<td>Y1</td>
<td>S8050</td>
</tr>
<tr>
<td>Y2</td>
<td>S8550</td>
</tr>
<tr>
<td>Y6</td>
<td>S9016</td>
</tr>
<tr>
<td>Z14</td>
<td>BZX84-C3V3</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/motor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/motor/" class="post-title-link" itemprop="url">motor</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:21:31" itemprop="dateModified" datetime="2022-06-08T17:21:31+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="步进电机"><a href="#步进电机" class="headerlink" title="步进电机"></a>步进电机</h2><h3 id="24BYJ48"><a href="#24BYJ48" class="headerlink" title="24BYJ48"></a>24BYJ48</h3><p>24BYJ48-5V型号的具体含义：</p>
<pre><code>24——表示此步进电机的有效最大外径是24mm。

B——表示是步进电机，“步”字的汉语拼音（Bu）开头字母。

Y——表示该步进电机是永磁式，“永”汉语拼音（Yong）开头字母。

J——表示该步进减速电机的减速型式，“减”汉语拼音（Jian）开头字母。

那么“BYJ”合起来就表示——永磁式减速步进电机。

48——表示四相八拍。

5V——表示这个步进电机的额定电压为5V。
</code></pre>
<ul>
<li><p><strong>参数</strong></p>
<p>  减速比:1/64<br>  步距角:5.625°/64<br>  驱动方式:4相8拍<br>  直流电阻:50Ω±7%(25℃)<br>  起动转矩100PPS g.cm ≥300<br>  起动频率PPS ≥500<br>  起位转矩g.cm ≥300<br>  空载牵入频率:≥500Hz<br>  空载牵出频率:≥900Hz<br>  牵入转矩:29.4mN.m(120Hz)<br>  自定位转矩:34.3mN.m<br>  绝缘电阻:＞50MΩ(500V)<br>  绝缘介电强度:600VAC/1mA/1S<br>  绝缘等级:A<br>  温升:＜40K(120Hz)<br>  噪音:＜40dB(120Hz)<br>  重量:大约40g<br>  转向：CCW</p>
</li>
<li><p><strong>内部结构</strong></p>
</li>
</ul>
<p>内圈上面有6个齿，分别标注为0～5，这个叫做转子，转子的每个齿上都带有永久的磁性，是一块永磁体，这就是“永磁式”的概念。外圈就是定子，它是跟电机的外壳固定在一起的，上面有8个齿，而每个齿上都缠上了一个线圈绕组，正对着的2个齿上的绕组又是串联在一起的，也就是说正对着的2个绕组总是会同时导通或关断的，如此就形成了4相，在图中分别标注为 A-B-C-D，这就是“4相”的概念。</p>
<p><img src="/images/motor/24BYJ48.png" alt="步进电机内部结构示意图"></p>
<ul>
<li><strong>工作原理</strong></li>
</ul>
<p>假定电机的起始状态就如图所示，B相绕组的开关闭合，B相绕组导通，那么导通电流就会在正上和正下两个定子齿上产生磁性，这两个定子齿上的磁性就会对转子上的0和3号齿产生最强的吸引力，转子的0号齿在正上、3号齿在正下而处于平衡状态。转子的1号齿与右上的定子齿也就是C相的一个绕组呈现一个很小的夹角。</p>
<p>接下来，我们把B相绕组断开，而使C相绕组导通，右上的定子齿将对转子1号齿产生最大的吸引力，转子就转过了起始状态时1号齿和C相绕组那个夹角的角度。再接下来，断开C相绕组，导通D相绕组，过程与上述的情况完全相同，最终将使转子2、5号齿与定子D相绕组对齐，转子又转过了上述同样的角度。</p>
<p>当A相绕组再次导通，完成一个 B-C-D-A 的四节拍操作后，转子的0、3号齿将由原来对齐到B相绕组上变为了对齐到A相绕组上，即转子转过了一个定子齿的角度。依此类推，再来一个四节拍，转子就将再转过一个齿的角度，8个四节拍后转子将转过完整的一圈，那么单个节拍使转子转过的角度为360度/(8*4)=11.25度，这个值就叫做步进角度。</p>
<p>在单四拍的两个节拍之间再插入一个双绕组导通的中间节拍，组成八拍模式。新插入的节拍使转子转了单四拍模式中步进角度的一半，即5.625度，转动精度增加了一倍，而转子转动一圈则需要8*8=64拍。另外还会在原来单四拍的两个节拍引力之间又加了一把引力，从而大大增加电机的扭力。</p>
<p><img src="/images/motor/24BYJ48_p.png" alt="线序"></p>
<p><img src="/images/motor/24BYJ48_2.png" alt="励磁方式"></p>
<p>对力矩要求高使用2相励磁，对精度要求高使用1-2相励磁。</p>
<h3 id="2相4线"><a href="#2相4线" class="headerlink" title="2相4线"></a>2相4线</h3><p><img src="/images/motor/2p4l.jpeg" alt="内部结构图"></p>
<p><img src="/images/motor/2p4l.jpg" alt="规格"></p>
<h2 id="舵机"><a href="#舵机" class="headerlink" title="舵机"></a>舵机</h2><p>舵机（Servo）由直流电机、减速齿轮组、传感器和控制电路组成的一套自动控制系统。通过发送信号，指定输出轴旋转角度。最大旋转180度。与普通直流电机的区别主要在，直流电机是一圈圈转动的，舵机只能在一定角度内转动，不能一圈圈转。</p>
<p>舵机内部有一个基准电路，产生周期为20ms、宽度为1.5ms的基准信号，将获得的直流偏置电压与电位器的电压比较，获得电压差输出。经过电路板IC方向判断，再驱动无核心马达开始转动，透过减速齿轮将动力传至摆臂，同时由位置检测器送回信号，判断是否已经到位。</p>
<p>舵机转动的角度是通过调节PWM的占空比来实现的。标准的PWM信号的<strong>周期固定为20ms，高电平脉宽应该在0.5~2.5ms范围之间</strong>，脉宽与转角0°—180°相对应。</p>
<p>0.5ms————-0度</p>
<p>1.0ms————45度</p>
<p>1.5ms————90度</p>
<p>2.0ms———–135度</p>
<p>2.5ms———–180度</p>
<p>![舵机]](/images/motor/servo.gif)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/gpio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/gpio/" class="post-title-link" itemprop="url">gpio structure</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-05 16:56:47" itemprop="dateModified" datetime="2022-07-05T16:56:47+08:00">2022-07-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hardware/" itemprop="url" rel="index"><span itemprop="name">hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>TTL电平</strong></p>
<p>TTL(Transistor-Transistor Logic)晶体管-晶体管逻辑，电路规格：</p>
<ul>
<li>输出高电平&gt;=2.4V，输出低电平&lt;=0.4V；</li>
<li>输入高电平&gt;=2.0V，输入低电平&lt;=0.8V。</li>
<li>噪声容限是0.4V。</li>
</ul>
<p>开漏输出要输出高电平需要接一个上拉电阻，I2C支持多个主设备与多个从设备在一条总线上，用推挽输出，会造成主从设备之间短路，故要用开漏输出。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/net/wifi-tool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/net/wifi-tool/" class="post-title-link" itemprop="url">wifi 调试工具</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 17:53:37" itemprop="dateModified" datetime="2022-06-08T17:53:37+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>wext为linux-2.6.18版本之前实现方式；用户空间使用ioctl方式访问驱动，设置无线参数或者获取无线参数，配置无线驱动进行联网操作；无线驱动事件到应用层的传递采用的netlink socket技术。</p>
<p>linux-2.6.18以后wifi驱动实现方式增加了nl80211，无论是用户层访问驱动还是驱动事件通知应用层、都采用的netlink技术。</p>
<p>用<code>lsusb</code>命令查看USB ID号，无线网上的硬件id为：0bda:xxxx。</p>
<h2 id="wpa-supplicant"><a href="#wpa-supplicant" class="headerlink" title="wpa_supplicant"></a>wpa_supplicant</h2><p>支持OPEN、WEP、WPA(TKIP)、WPA2(AES)无线加密方式。下载地址：<a target="_blank" rel="noopener" href="https://w1.fi/releases/">https://w1.fi/releases/</a><br>wpa_supplicant-0.8以前的版本，编译前对.config文件进行裁剪，去掉一些功能。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#CONFIG_DRIVER_HOSTAP=y</span><br><span class="line">#CONFIG_DRIVER_ATMEL=y</span><br><span class="line">#CONFIG_DRIVER_NL80211=y</span><br><span class="line">#CONFIG_DRIVER_WIRED=y</span><br><span class="line">CONFIG_WPS=y</span><br><span class="line">CONFIG_TLS=internal</span><br><span class="line">CONFIG_INTERNAL_LIBTOMMATH=y</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp defconfig .config</span><br><span class="line">make CC=arm-himix100-linux-gcc clean</span><br><span class="line">make CC=arm-himix100-linux-gcc -j4</span><br><span class="line">arm-himix100-linux-strip wpa_supplicant</span><br></pre></td></tr></table></figure>

<p>依赖libnl，openssl，dbus库，Makefie修改：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/dbus-1.12.10/<span class="keyword">include</span>/dbus-1.0</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/dbus-1.12.10/lib -ldbus-1</span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/expat-2.2.9/<span class="keyword">include</span>/</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/expat-2.2.9/lib </span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/openssl-1.1.1/<span class="keyword">include</span></span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/openssl-1.1.1/lib </span><br><span class="line">CFLAGS += -I/home/luo_u/usr/hisi/libnl-3.4.0/<span class="keyword">include</span>/libnl3</span><br><span class="line">LIBS += -L/home/luo_u/usr/hisi/libnl-3.4.0/lib </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.linuxfromscratch.org/blfs/view/svn/basicnet/wpa_supplicant.html">http://www.linuxfromscratch.org/blfs/view/svn/basicnet/wpa_supplicant.html</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=/var/run/wpa_supplicant/</span><br><span class="line">update_config=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">network=<span class="punctuation">&#123;</span></span><br><span class="line">    ssid=<span class="string">&quot;SECULINK  R&amp;D&quot;</span></span><br><span class="line">    scan_ssid=<span class="number">1</span></span><br><span class="line">    psk=<span class="string">&quot;secueye1&quot;</span></span><br><span class="line">    key_mgmt=WPA-PSK WPA-EAP IEEE8021X NONE</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">#连接无密码的ssid字段，需要添加key_mgmt=NONE去连接这个网络</span><br><span class="line">network=<span class="punctuation">&#123;</span></span><br><span class="line">        key_mgmt=NONE</span><br><span class="line">        ssid=<span class="string">&quot;wifi-name&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./wpa_supplicant -i wlan0 -D wext -c wpa_supplicant.conf -B -dd</span><br></pre></td></tr></table></figure>

<p>加<code>-dd</code>选项，显示调试打印。</p>
<ul>
<li><strong>错误</strong></li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">rfkill: <span class="title">Cannot</span> <span class="title">open</span> <span class="title">RFKILL</span> <span class="title">control</span> <span class="title">device</span></span></span><br></pre></td></tr></table></figure>

<p>打开rfkill失败，这是一个控制接口应该在/dev/rfkill，看了下板子上，确实没有这个设备接口。打开内核配置<code>CONFIG_RFKILL</code></p>
<h2 id="wpa-cli"><a href="#wpa-cli" class="headerlink" title="wpa_cli"></a>wpa_cli</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">wpa_cli -i wlan0 scan 　       #搜索wifi热点</span><br><span class="line">wpa_cli -i wlan0 scan_result 　#显示搜索wifi热点</span><br><span class="line">wpa_cli -i wlan0 status      　#当前WPA/EAPOL/EAP通讯状态</span><br><span class="line">wpa_cli -i wlan0 ping        　#ping wpa_supplicant</span><br><span class="line"></span><br><span class="line">wpa_cli -i wlan0 add_network   #添加一个网络连接,会返回&lt;network id&gt;</span><br><span class="line">wpa_cli set_network &lt;network id&gt; ssid &#x27;&quot;name&quot;&#x27;  #ssid名称</span><br><span class="line">wpa_cli set_network &lt;network id&gt; psk &#x27;“psk”&#x27;    #密码</span><br><span class="line">wpa_cli set_network &lt;network id&gt; scan_ssid 1</span><br><span class="line">wpa_cli set_network &lt;network id&gt; priority 1     #优先级</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接指定的ssid</span></span><br><span class="line">wpa_cli -i wlan0 select_network &lt;network id&gt;   </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接无密码热点</span></span><br><span class="line">wpa_cli set_network &lt;network id&gt; ssid &quot;wifi-name&quot;</span><br><span class="line">wpa_cli set_network &lt;network id&gt; key_mgmt NONE</span><br><span class="line">       </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">断开连接</span></span><br><span class="line">wpa_cli -i wlan0 disable_network &lt;network id&gt;   </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">信息保存到默认的配置文件中</span></span><br><span class="line">wpa_cli -i wlan0 save_config </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">列举保存过得连接</span></span><br><span class="line">wpa_cli -i wlan0 list_network     </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使能制定的ssid</span></span><br><span class="line">wpa_cli -i wlan0 enable_network &lt;network id&gt;   </span><br></pre></td></tr></table></figure>

<h2 id="iwconfig"><a href="#iwconfig" class="headerlink" title="iwconfig"></a>iwconfig</h2><p>Wireles stools用来设置支持LinuxWireless Extension的无线设备。Wireles stools for Linux 和Linux Wireless Extension 由 Jean Tourrilhes在维护，由HP惠普赞助。</p>
<p>WirelessExtension (WE)是一组通用的API，能在用户空间对通用Wireless LANs进行配置和统计。它的好处在于仅通过一组单一的工具就能对各种各样的WirelessLANs进行管理，不管它们是什么类型，只要其驱动支持WirelessExtension就行；另一个好处就是不用重启驱动或Linux就能改变这些参数。</p>
<p>WirelessTools (WT)就是用来操作Wireless Extensions的工具集，它们使用字符界面，支持所有WirelessExtension。WirelessTools包括以下工具：</p>
<p>-　iwconfig：设置基本无线参数<br>-　iwlist：扫描、列出频率，比特率，密钥等<br>-　iwspy：获取每个节点链接的质量<br>-　iwpriv：操作WirelessExtensions 特定驱动<br>-　ifrename： 基于各种静态标准命名接口</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html">https://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html</a><br>修改Makefile，编译。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CC = arm-himix100-linux-gcc</span><br><span class="line">AR = arm-himix100-linux-ar</span><br><span class="line">RANLIB = arm-himix100-linux-anlib</span><br><span class="line">BUILD_STATIC = y</span><br></pre></td></tr></table></figure>

<p>只适用于OPEN和WEP加密方式。建议用iw工具替代。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iwlist wlan0 scan   #搜索ap</span><br><span class="line">iwconfig wlan0 key &lt;psk&gt;  #验证密码</span><br><span class="line">iwconfig wlan0 key open   #密码验证功能打开</span><br><span class="line">iwconfig wlan0 essid &lt;ssid&gt;  #连接ap</span><br></pre></td></tr></table></figure>

<p>在设置监听模式之前需要将无线网卡down掉，开启监听模式再up，然后在锁定信道.。</p>
<h2 id="iw"><a href="#iw" class="headerlink" title="iw"></a>iw</h2><p>iw 是一种新的基于 nl80211 的用于无线设备的CLI配置实用程序。只能连接 OPEN和WEP 加密方式的热点。下载地址：<a target="_blank" rel="noopener" href="https://mirrors.edge.kernel.org/pub/software/network/iw/">https://mirrors.edge.kernel.org/pub/software/network/iw/</a></p>
<p>修改Makefile，依赖libnl库。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CC = arm-anykav200-linux-uclibcgnueabi-gcc</span><br><span class="line">CFLAGS += -I/home/luoyou/home/usr/anyka/libnl-3.4.0/<span class="keyword">include</span>/libnl3</span><br><span class="line">LIBS += -L/home/luoyou/home/usr/anyka/libnl-3.4.0/lib</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PKG_CONFIG_PATH=/home/luoyou/home/usr/anyka/libnl-3.4.0/lib/pkgconfig</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">iw help    # 帮助</span><br><span class="line">iw list    # 获得所有设备的功能，如带宽信息和802.11n的信息</span><br><span class="line">iw dev wlan0 scan   # 扫描</span><br><span class="line">iw event            # 监听事件 </span><br><span class="line">iw dev wlan0 link   # 获得链路状态 </span><br><span class="line"></span><br><span class="line">iw wlan0 connect &lt;essid&gt;       # 连接开放的AP</span><br><span class="line">iw wlan0 connect &lt;essid&gt; 2432  # 连接到2432频道的AP </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">连接WEP的AP，d:default, 0:第0个密码, 1:第0个密码</span></span><br><span class="line">iw wlan0 connect foo keys 0:abcde d:1:123456    </span><br><span class="line"></span><br><span class="line">iw dev wlan1 station dump    # 获取station 的统计信息</span><br><span class="line">iw dev wlan1 station get     # 获得station对应的peer统计信息</span><br><span class="line">iw wlan0 set bitrates legacy-2.4 12 18 24    # 修改传输比特率 </span><br><span class="line">iw dev wlan0 set bitrates mcs-5 4    # 修改tx HT MCS的比特率 </span><br><span class="line">iw dev wlan0 set bitrates mcs-2.4 10  </span><br><span class="line">iw dev wlan0 set bitrates mcs-5  # 清除所有tx比特率和设置的东西来恢复正常</span><br><span class="line">iw dev　set txpower  []   #设置传输功率</span><br><span class="line">iw phy　set txpower  []   #设置传输功率</span><br><span class="line">iw dev wlan0 set power_save on  #设置省电模式</span><br><span class="line">iw dev wlan0 get power_save     #查询当前的节电设定</span><br><span class="line">iw phy phy0 interface add moni0 type monitor  #添加一个monitor接口</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/phy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/phy/" class="post-title-link" itemprop="url">PHY</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PHY（Physical Layer）即物理接口收发器，它实现OSI模型的物理层。包括MII/GMII（介质独立接口）子层、PCS（物理编码子层）、PMA（物理介质附加）子层、PMD（物理介质相关）子层、MDI子层。PHY是IEEE802.3中定义的一个标准模块，STA（station management entity，管理实体，一般为MAC或CPU）通过SMI（Serial Manage Interface）对PHY的行为、状态进行管理和控制，而具体管理和控制动作是通过读写PHY内部的寄存器实现的。<br>10BaseT 和 100BaseTX PHY两种实现的帧格式是一样的，但信令机制不同，而且10BaseT采用曼彻斯特编码，100BaseTX 采用4B/5B编码。</p>
<p><img src="/images/net/phy/PHY.png" alt="img"></p>
<p>PHY里面的部分寄存器是IEEE定义的，这样PHY把自己的目前的状态反映到寄存器里面，MAC通过SMI总线不断的读取PHY的状态寄存器以得知目前PHY的状态，例如连接速度，双工的能力等。当然也可以通过SMI设置PHY的寄存器达到控制的目的，例如流控的打开关闭，自协商模式还是强制模式等。不论是物理连接的MII总线和SMI总线还是PHY的状态寄存器和控制寄存器都是有IEEE的规范的，因此不同公司的MAC和PHY一样可以协调工作。当然为了配合不同公司的PHY的自己特有的一些功能，驱动需要做相应的修改。</p>
<ul>
<li><strong>工作过程</strong></li>
</ul>
<p>PHY在发送数据的时候，收到MAC过来的数据(对PHY来说，没有帧的概念，对它来说，都是数据而不管什么地址，数据还是CRC)，每4bit就增加1bit的检错码，然后把并行数据转化为串行流数据，再按照物理层的编码规则(10Based-T的NRZ编码或100based-T的曼彻斯特编码)把数据编码，再变为模拟信号把数据送出去。收数据时的流程反之。</p>
<h2 id="PHY寄存器"><a href="#PHY寄存器" class="headerlink" title="PHY寄存器"></a>PHY寄存器</h2><p>PHY寄存器的地址空间为5位，从0到31最多可以定义32个寄存器（随着芯片功能不断增加，很多PHY芯片采用分页技术来扩展地址空间以定义更多的寄存器），IEEE802.3定义了地址为0-15这16个寄存器的功能，地址16-31的寄存器留给芯片制造商自由定义，如下表所示。</p>
<p><img src="/images/net/phy/PHY_REG.png" alt="PHY_REG"></p>
<h3 id="Control-Register-Register-0"><a href="#Control-Register-Register-0" class="headerlink" title="Control Register (Register 0)"></a>Control Register (Register 0)</h3><p>寄存器0是PHY控制寄存器，通过Control Register可以对PHY的主要工作状态进行设置。应该保证控制寄存器每个位的默认值，以便在没有管理干预的情况下，上电或复位时PHY的初始状态为正常操作状态。Control Register的每一位完成的功能见下。</p>
<p><img src="/images/net/phy/PHY_CTRL_REG.png" alt="PHY_CTRL_REG"></p>
<ul>
<li><strong>Reset：</strong> 通过将位0.15设置为逻辑1来完成复位PHY。 该操作应将状态和控制寄存器设置为其默认状态。 因此，此操作可能会改变PHY的内部状态以及与PHY关联的物理链路的状态。复位过程中Bit15保持为1，复位完成之后该位应该自动清零。在复位过程完成之前，PHY不需要接受对控制寄存器的写入操作，并且在复位过程完成之前写入0.15以外的控制寄存器位可能不起作用。 复位过程应在0.15位设置的0.5 s内完成。</li>
</ul>
<blockquote>
<p>（1）一般要改变端口的工作模式（如速率、双工、流控或协商信息等）时，在设置完相应位置的寄存器之后，需要通过Reset位复位PHY来使配置生效。<br>（2）该比特位的默认值为 0。</p>
</blockquote>
<ul>
<li><strong>Loopback：</strong> 当位0.14被设置为逻辑1时，PHY应置于环回操作模式。 当位0.14置位时，PHY接收电路应与网络介质隔离，并且MII或GMII处的TX_EN断言不应导致网络介质上的数据传输。 当位0.14置位时，PHY应接受来自MII或GMII发送数据路径的数据，并将其返回给MII或GMII接收数据路径，以响应TX_EN的断言。 当位0.14置位时，从断言TX_EN到断言RX_DV的延迟应小于512 BT。 当位0.14置位时，除非设置了位0.7，否则COL信号应始终保持无效，在这种情况下，COL信号的行为应如22.2.4.1.9所述。 清0.14位为零允许正常操作。</li>
</ul>
<p>Loopback是一个调试以及故障诊断中常用的功能，Bit14置1之后，PHY和外部MDI的连接在逻辑上将被断开，从MAC经过MII/GMII（也可能是其他的MAC/PHY接口）发送过来的数据将不会被发送到MDI上，而是在PHY内部（一般在PCS）回环到本端口的MII/GMII接收通道上，通过Loopback功能可以检查MII/GMII以及PHY接口部分是否工作正常，对于端口不通的情况可用于故障定位。</p>
<blockquote>
<p>（1）需要注意的是，很多时候PHY设置Loopback后端口可能就Link down了，MAC无法向该端口发帧，这时就需要通过设置端口Force Link up才能使用Loopback功能。<br>（2）该比特位的默认值为 0。</p>
</blockquote>
<ul>
<li><p><strong>Speed Selection：</strong> <em><strong>Bit13和Bit6两位联合实现</strong></em>对端口的速率控制功能。链接速度可以通过自动协商过程或手动速度选择来选择。 通过将位0.12清零来禁用自动协商时，允许手动速度选择。</p>
</li>
<li><p>当禁用自动协商并将位0.6清除为逻辑0时，将位0.13设置为逻辑1将PHY配置为100 Mb / s操作，并将位0.13清除为逻辑0将PHY配置为10 Mb / s操作 。</p>
</li>
<li><p>当禁用自动协商并将位0.6设置为逻辑1时，将位0.13清零为逻辑0会选择1000 Mb / s的操作。 将位0.6和0.13设置为逻辑1的组合保留用于未来的标准化。</p>
</li>
<li><p>当使能自动协商时，可以读取或写入位0.6和0.13，但位0.6和位0.13的状态对链路配置没有影响，位0.6和位0.13不需要反映当它被读取时链接。</p>
</li>
</ul>
<p>如果PHY通过比特1.15：9和比特15.15：12报告它不能工作在所有速度时，则比特0.6和0.13的值应该与PHY可以操作的速度相对应。并且任何试图将该位设置为无效的操作均将被忽略。</p>
<blockquote>
<p>（1）对Speed Selection的修改设置，往往需要复位端口才能配置生效。因此在设置该位置的时候需要检查自动协商的设置并通过Bit15复位端口。<br>（2）位0.6和0.13的默认值是根据位1.15：9和15.15：12所指示的PHY可以操作的最高数据速率的编码组合。</p>
</blockquote>
<ul>
<li><strong>Auto-Negotiation Enable：</strong> 自动协商过程应通过将位0.12设置为逻辑1来启用。 如果位0.12设置为逻辑1，则位0.13、0.8和0.6不应对链路配置和除了自动协商协议规定之外的站操作产生影响。 如果将位0.12清零为逻辑0，则无论链路配置和自动协商过程的先前状态如何，位0.13、0.8和0.6都将确定链路配置。</li>
</ul>
<p>如果PHY通过位1.3报告它缺乏执行自动协商的能力，则PHY应在位0.12返回零值。 如果PHY通过位1.3报告它缺乏执行自动协商的能力，则位0.12应该始终写为0，并且任何尝试将1写入位0.12都应该被忽略。</p>
<blockquote>
<p>必须注意的是，对于1000BASE-T接口,自动协商必须打开。</p>
</blockquote>
<ul>
<li><strong>Power Down：</strong> 通过将位0.11设置为逻辑1，可以将PHY置于低功耗状态。 清0.11位为零允许正常操作。 PHY在掉电状态下的具体行为是特定实现的。 处于掉电状态时，PHY应响应管理事务。 在转换到掉电状态期间和处于掉电状态期间，PHY不应在MII或GMII上产生寄生信号。</li>
</ul>
<p>当位0.11或位0.10被设置为逻辑1时，PHY不需要满足RX_CLK和TX_CLK信号功能要求。 在位0.11和0.10清零后，PHY应在0.5 s内满足22.2.2中定义的RX_CLK和TX_CLK信号功能要求。</p>
<blockquote>
<p>（1）Power Down模式一般在软件shut down端口的时候使用，需要注意的是端口从Power Down模式恢复，需要复位端口以保证端口可靠的连接。<br>（2）该位的默认值为 0。</p>
</blockquote>
<ul>
<li><strong>Isolate：</strong> 通过将位0.10设置为逻辑1，PHY可能被迫将其数据路径与MII或GMII电隔离。 清零位0.10允许正常操作。 当PHY与MII或GMII隔离时，它不会响应TXD数据包和TX_EN，TX_ER、GTX_CLK的输入。并且它的TX_CLK，RX_CLK，RX_DV，RX_ER，RXD数据包、COL和CRS输出均应为高阻态。 当PHY与MII或GMII隔离时，它将响应管理事务（MDC/MDIO接口的信号）。</li>
</ul>
<blockquote>
<p>（1）IEEE802.3没有对Isolate 时MDI接口的状态进行规范，此时MDI端可能还在正常运行。Isolate在实际应用中并没有用到。<br>（2）由于目前很多百兆的PHY芯片其MAC接口主流的都是SMII/S3MII，8个端口的接口是相互关联的，一个端口设置Isolate可能会影响其他端口的正常使用，因此在使用中注意不要随意更改bit10的状态。</p>
</blockquote>
<ul>
<li><strong>Restart Auto-Negotiation：</strong> 如果PHY通过位1.3报告它缺乏执行自动协商的能力，或者如果自动协商被禁用，则PHY应在位0.9返回零值。 如果PHY通过位1.3报告它缺乏执行自动协商的能力，或者如果禁用了自动协商，则应将位0.9始终写为0，并且任何尝试将1写入位0.9应被忽略。</li>
</ul>
<p>Bit9置1将重新启动端口的自动协商进程，当然前提是Auto-Negotiation Enable是使能的。</p>
<blockquote>
<p>一般在修改端口的自动协商能力信息之后通过Bit9置1重新启动自动协商来使端口按照新的配置建立link。</p>
</blockquote>
<ul>
<li><strong>Duplex Mode：</strong> 可以通过自动协商过程或手动双面选择来选择双工模式。 通过将位0.12清零来禁用自动协商时，允许手动双面选择。</li>
</ul>
<ul>
<li>当禁用自动协商时，将位0.8设置为逻辑1将PHY配置为全双工操作，并将位0.8清零以将逻辑0配置为用于半双工操作的PHY。</li>
<li>当启用自动协商时，可以读取或写入位0.8，但位0.8的状态对链路配置没有影响。</li>
</ul>
<p>如果PHY通过位1.15：9和15.15：12报告它只能在一个双工模式下工作，则位0.8的值应该与PHY可以工作的模式相对应，并且任何尝试改变将该位0.8修改为无效指的操作应被忽略。</p>
<blockquote>
<p>对Duplex Mode的修改配置也需要复位端口才能生效。</p>
</blockquote>
<ul>
<li><strong>Collision Test：</strong> 冲突信号（COL）测试开关。在需要对COL信号进行测试时，可以通过Bit7置1，这时PHY将输出一个COL脉冲以供测试。实际测试操作中也可以将端口配置为半双工状态，通过发帧冲突来测试COL信号，因此该配置实用价值不大。</li>
<li><strong>Unidirectional enable：</strong> 如果PHY通过比特1.7报告它不具备编码和传输来自媒体独立接口的数据的能力，而不管PHY是否确定已建立有效链路，则PHY应在比特0.5中返回零值，并且 任何尝试写一个到位0.5应该被忽略。</li>
</ul>
<h3 id="Status-register"><a href="#Status-register" class="headerlink" title="Status register"></a>Status register</h3><p>寄存器1是PHY状态寄存器，主要包含PHY的状态信息，大多数bit的值都是由芯片厂家确定的，每一个bit的功能在表3种已有详细说明。</p>
<p><img src="/images/net/phy/PHY_STA_REG.png" alt="PHY_STA_REG"></p>
<ul>
<li><strong>100BASE-T4 ability：</strong> 当读为逻辑1时，位1.15指示PHY有能力使用100BASE-T4信令规范执行链路发送和接收。 当读为逻辑0时，位1.15表示PHY缺乏使用100BASE-T4信令规范执行链路发送和接收的能力。</li>
<li><strong>100BASE-X full duplex ability：</strong> 当读为逻辑1时，位1.14指示PHY有能力使用100BASE-X信令规范执行全双工链路传输和接收。 当作为逻辑0读取时，bit1.14表示PHY缺乏使用100BASE-X信令规范执行全双工链路传输和接收的能力。</li>
<li><strong>100BASE-X half duplex ability：</strong> 当读为逻辑1时，位1.13指示PHY有能力使用100BASE-X信令规范执行半双工链路传输和接收。 当读为逻辑0时，位1.13指示PHY缺乏使用100BASE-X信令规范执行半双工链路传输和接收的能力。</li>
<li><strong>Unidirectional ability：</strong> 当读为逻辑1时，位1.7指示PHY具有编码和传输来自媒体独立接口的数据的能力，而不管PHY是否确定已建立有效链路。 当读为逻辑0时，位1.7指示PHY只有在PHY确定已建立有效链路时才能从媒体独立接口传输数据。</li>
<li><strong>MF preamble suppression ability：</strong> 当读为逻辑1时，位1.6指示PHY能够接受管理帧，而不管它们是否在22.2.4.5.2中描述的前导码模式之前。 当读为逻辑0时，位1.6指示PHY不能接受管理帧，除非它们之前是22.2.4.5.2中描述的前导码模式。</li>
<li><strong>Auto-Negotiation Complete：</strong> 当读为逻辑1时，位1.5指示自动协商过程已完成，并且由自动协商协议（条款28或条款37）实施的扩展寄存器的内容是有效的。 当读为逻辑0时，位1.5指示自动协商过程尚未完成，并且扩展寄存器的内容由自动协商协议的当前状态定义，或者为手动配置写入。 如果自动协商通过清除位0.12禁用，则PHY应在位1.5返回零值。 如果PHY缺乏执行自动协商的能力，它还应在位1.5返回零值。</li>
</ul>
<blockquote>
<p>在调试以及异常故障处理时，可以通过该位寄存器的状态判断AN是否成功，从而进一步的检查AN相关的设置是否正确，或者芯片的AN功能是否正常等。</p>
</blockquote>
<ul>
<li><strong>Remote Fault：</strong> 当读为逻辑1时，位1.4表示检测到远程故障状态。 故障类型以及故障检测的标准和方法是PHY特定的。 远程故障位必须使用锁存功能来实现，以便发生远程故障将导致远程故障位置位，并保持置位状态直至被清除。 每当通过管理接口读取寄存器1时，远程故障位应清零，并且还应通过PHY复位清零。</li>
</ul>
<p>远端错误指示位。Bit4=1代表连接对端（Link Partner）出错，至于出错的具体类型以及错误检测机制在规范中并没有定义，由PHY的制造商自由发挥，一般的厂商都会在其他的寄存器（Register16-31由厂商自行定义）指示比较详细的错误类型。在与端口相关的故障查证中，Remote Fault是一个重要的指示信息，通过互联双方的Remote Fault信息（可能要加上其他的具体错误指示），可以帮助定位故障原因。</p>
<ul>
<li><p><strong>Auto-Negotiation ability：</strong> 当读为逻辑1时，位1.3指示PHY有能力执行自动协商。 当读为逻辑0时，位1.3指示PHY缺乏执行自动协商的能力。</p>
</li>
<li><p><strong>Link Status：</strong> 当读为逻辑1时，位1.2指示PHY已经确定已建立有效链路。 当作为逻辑0读取时，位1.2指示该链接无效。 确定链路有效性的标准是PHY特定的。 链路状态位应该使用锁存功能来实现，以便发生链路故障情况将导致链路状态位清零并保持清零，直到通过管理接口读取。 此状态指示旨在支持在30.5.1.1.4，aMediaAvailable中定义的管理属性。</p>
</li>
</ul>
<p>实际应用中一般都是通过Bit2来判断端口的状态。而且，一般的MAC芯片也是通过轮询PHY的这个寄存器值来判断端口的Link状态的（这个过程可能有不同的名称，比如BCM叫做Link Scan，而Marvell叫做PHY Polling。）如前所述，在AN Enable的情况下，Link Status的信息只有在Auto-Negotiation Complete指示已经完成的情况下才是正确可靠的，否则有可能出错。</p>
<ul>
<li><strong>Jabber Detect：</strong> 当作为逻辑1读取时，位1.1指示已经检测到爆音条件。 此状态指示旨在支持30.5.1.1.6中定义的管理属性，aJabber和30.5.1.3.1 nJabber中定义的MAU通知。 检测Jabber条件的标准是PHY特定的。 Jabber检测位应该使用锁存功能来实现，以便发生Jabber条件将导致Jabber检测位置位，并保持置位状态直至被清除。 每次通过管理接口读取寄存器1时，Jabber检测位应清零，并且还应通过PHY复位清零。</li>
</ul>
<p>IEEE802.3对Jabber的解释是“A condition wherein a station transmits for a period of time longer than the maximum permissible packet length, usually due to a fault condition”。这一位指示的是Link Partner发送的时间超过了规定的最大长度。值得注意的是，Jabber Detect只有在10BASE-T模式下才有意义，100和1000M模式是没有定义Jabber这一功能的。</p>
<h3 id="PHY-Identifier-Register"><a href="#PHY-Identifier-Register" class="headerlink" title="PHY Identifier Register"></a>PHY Identifier Register</h3><p>寄存器2和3存放PHY芯片的型号代码，寄存器2(PHY ID1)为高16位，而寄存器3(PHY ID2)为低16位。由芯片制造商自行定义，实际应用中软件通过读取这两个寄存器的内容可以识别PHY的型号和版本。</p>
<p>PHY标识符应由由IEEE分配给PHY制造商的组织唯一标识符（OUI）的（<em>只需要使用第3至第24位，共22位</em>），加上6位制造商的型号以及4位制造商的修订版编号组成。 PHY标识符旨在提供足够的信息来支持30.1.2中所要求的oResourceTypeID对象。</p>
<p>OUI的第三位分配给位2.15，OUI的第四位分配给位2.14，依此类推。 位2.0包含OUI的第十八位。 位3.15包含OUI的第十九位，位3.10包含OUI的第二十四位。 位3.9包含制造商型号的MSB。 位3.4包含制造商型号的LSB。 位3.3包含制造商版本号的MSB，位3.0包含制造商版本号的LSB。具体如下图所示：</p>
<p><img src="/images/net/phy/PHY_ID_REG.png" alt="PHY_ID_REG"></p>
<h3 id="Auto-Negotiation-Advertisement-Register-Register-4-R-W"><a href="#Auto-Negotiation-Advertisement-Register-Register-4-R-W" class="headerlink" title="Auto-Negotiation Advertisement Register (Register 4) (R/W)"></a>Auto-Negotiation Advertisement Register (Register 4) (R/W)</h3><p>寄存器4是自动协商的能力通告寄存器，在AN Enable的前提下（见寄存器0），端口根据该寄存器的相关配置将自动协商信息通过FLP在MDI上进行通告。当AN配置为Disable状态的时候，寄存器4的配置将不起作用，端口的工作模式由控制寄存器中的配置决定。</p>
<p>该寄存器包含PHY的通告能力，它们将在自动协商期间传送给其链接伙伴。 基本页的位定义在IEEE标准的28.2.1.2中定义。 上电时，在自动协商开始之前，该寄存器应具有以下默认配置：</p>
<ul>
<li><strong>Selector Field （4.4：0）：</strong> 被设置为适当的代码，如IEEE标准的附件28A中所规定。</li>
<li><strong>Reserved（4.14）：</strong> 被设置为逻辑0。</li>
<li><strong>Technology Ability Field（4.11：5）：</strong> <em><strong>根据MII状态寄存器（寄存器1）（1.15：11）中设置的值或等效值设置</strong></em>。 另见28.2.1.2.3和附件28D。</li>
</ul>
<p><img src="/images/net/phy/PHY_REG_4.png" alt="PHY_REG_4"></p>
<h3 id="Link-codeword-encoding（基本链路码字）"><a href="#Link-codeword-encoding（基本链路码字）" class="headerlink" title="Link codeword encoding（基本链路码字）"></a>Link codeword encoding（基本链路码字）</h3><p>在FLP Burst内传输的基本链路代码字（基本页面）应该传达如图28-7所示的编码。 自动协商功能可以使用下一页功能支持其他页面。 下一页交换中使用的链接代码字的编码在28.2.3.4中定义。 在FLP Burst中，D0应该是第一个传输的位。</p>
<p><img src="/images/net/phy/20180428154543415.png" alt="这里写图片描述"></p>
<h3 id="Next-Page-function"><a href="#Next-Page-function" class="headerlink" title="Next Page function"></a>Next Page function</h3><p>下一页功能使用标准的自动协商仲裁机制来允许交换任意的数据。 数据由可选的下一页信息携带，其遵循用于基本链接码字的传输和确认过程。 定义了四种类型的下一页编码：消息页面，未格式化页面，扩展消息页面和扩展的未格式化页面。</p>
<p>关于该部分，具体见IEEE标准的<strong>28.2.3.4 Next Page function</strong>。</p>
<p>在IEEE标准中，Auto-Negotiation Advertisement Register中的各部分全部是在独立章节中进行介绍的。具体如下：</p>
<ul>
<li><strong>Selector Field：</strong> 选择器字段（S [4：0]）是一个5位宽的字段，编码32个可能的消息。 链路码字中的选择器字段S [4：0]应用于识别自动协商发送的消息的类型。 下表列出了可能发送的消息的类型。 随着新消息的发展，该表格将相应更新。</li>
</ul>
<p><img src="/images/net/phy/20180428155653138.png" alt="Selector Field"></p>
<p>未指定的组合保留供将来使用。 不会传输选择器字段的预留组合。<em><strong>我们所接触的以太网PHY遵从IEEE802.3规范，Selector Field=0001，该区域不可随意更改（很多PHY将此区域设计为只读寄存器，以免被修改）</strong></em>。</p>
<ul>
<li><strong>Technology Ability Field：</strong> 技术能力字段（A [6：0]）是一个7位宽的字段，其中包含指示选择器字段值特定的支持技术的信息。 这些位被映射到各个技术，以便能够针对单个选择器字段值并行通告能力。 附录28B.2和附件28D描述了IEEE 802.3选择器的技术能力字段编码。 链接代码字中可能会公布多种技术。 设备应支持其宣传的技术的数据服务能力。</li>
</ul>
<p><img src="/images/net/phy/20180428152215994.png" alt="Technology Ability Field"></p>
<ul>
<li><p><strong>Extended Next Page：</strong> 扩展下一页（XNP）被编码在基本链路码字的位D12中。 扩展下一页位指示本地设备在设置为逻辑1时支持扩展下一页的传输，并指示本地设备在设置为逻辑0时不支持扩展下一页。 Extended Next Page的使用与协商的数据速率，媒体或链接技术是正交的。 扩展下一页位按照28.2.3.4中的扩展下一页功能规范使用。</p>
</li>
<li><p><strong>Next Page：</strong> 无论选择器字段值还是链接码字编码，下一页（NP）都在D15位编码。 支持附加链接码字编码的传输和接收是可选的。 如果不支持Next Page功能，NP位应始终设置为逻辑0。 如果设备实现下一页功能并希望进行下一页交换，则应将NP位设置为逻辑1。 设备可以实现下一页功能，并通过将NP位设置为逻辑0来选择不参与下一页交换。 下一页功能在28.2.3.4中定义。</p>
</li>
<li><p><strong>Remote Fault：</strong> 远程故障（RF）编码在基本链路码字的位D13中。 默认值是逻辑零。 远程故障位为传输简单的故障信息提供了一种标准的传输机制。 当自动协商通告寄存器（寄存器4）中的RF位设置为逻辑1时，发送的基本链路码字中的RF位被设置为逻辑1。 当接收到的基本链路代码字中的RF位被设置为逻辑1时，如果存在MII管理功能，则MII状态寄存器（寄存器1）中的远程故障位将被设置为逻辑1。</p>
</li>
</ul>
<h3 id="Auto-Negotiation-Link-Partner-ability-register-Register-5-RO"><a href="#Auto-Negotiation-Link-Partner-ability-register-Register-5-RO" class="headerlink" title="Auto-Negotiation Link Partner ability register (Register 5) (RO)"></a>Auto-Negotiation Link Partner ability register (Register 5) (RO)</h3><p>寄存器5保存的是本端PHY接收到的对端PHY所通告的端口能力，寄存器5的结构和寄存器4基本一致。</p>
<h3 id="Auto-Negotiation-Expansion-Register-Register-6-RO"><a href="#Auto-Negotiation-Expansion-Register-Register-6-RO" class="headerlink" title="Auto-Negotiation Expansion Register (Register 6) (RO)"></a>Auto-Negotiation Expansion Register (Register 6) (RO)</h3><p>寄存器6保存了PHY自动协商过程的异常信息。从这个寄存其中我们可以获取到Link Partner子否支持自动协商以及自动协商下一页有没有收到的信息。</p>
<p><img src="/images/net/phy/20180428163901700.png" alt="Auto-Negotiation Expansion Register"></p>
<h3 id="Auto-Negotiation-Next-Page-transmit-register-Register-7-R-W"><a href="#Auto-Negotiation-Next-Page-transmit-register-Register-7-R-W" class="headerlink" title="Auto-Negotiation Next Page transmit register (Register 7) (R/W)"></a>Auto-Negotiation Next Page transmit register (Register 7) (R/W)</h3><p>自动协商下一页发送寄存器包含在支持下一页功能时要发送的下一页链接码字。 （见表28-6）内容在28.2.3.4中定义。 上电时，该寄存器应包含默认值2001H，该值表示消息代码设置为Null消息的消息页面。 该值可以由设备希望传输的任何有效的下一页消息代码替换。 写入该寄存器应将mr_next_page_loaded设置为true。</p>
<p><img src="/images/net/phy/2018042816462224.png" alt="Register 7"></p>
<h3 id="Auto-Negotiation-Link-Partner-Received-Next-Page-register-Register-8-RO"><a href="#Auto-Negotiation-Link-Partner-Received-Next-Page-register-Register-8-RO" class="headerlink" title="Auto-Negotiation Link Partner Received Next Page register (Register 8) (RO)"></a>Auto-Negotiation Link Partner Received Next Page register (Register 8) (RO)</h3><p><img src="/images/net/phy/20180428164942266.png" alt="Register 8"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/07/hardware/mii/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ubun2">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nullptr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/07/hardware/mii/" class="post-title-link" itemprop="url">Media Independent Interface</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-07 16:05:44" itemprop="dateCreated datePublished" datetime="2022-06-07T16:05:44+08:00">2022-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-08 20:18:38" itemprop="dateModified" datetime="2022-06-08T20:18:38+08:00">2022-06-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/net/" itemprop="url" rel="index"><span itemprop="name">net</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="MII"><a href="#MII" class="headerlink" title="MII"></a>MII</h2><p>MII（Media Independent Interface）即媒体独立接口，MII接口是MAC与PHY连接的标准接口。它是IEEE-802.3定义的以太网行业标准。MII接口提供了MAC与PHY之间、PHY与STA(Station Management)之间的互联技术，该接口支持10Mb/s与100Mb/s的数据传输速率，单向传输的数据线有4根，整个接口由14根线组成。媒体独立的意思，是指不管铜轴、光纤、电缆等媒体的变化，媒体处理的相关工作都由PHY和MAC的芯片完成。</p>
<p>MII接口主要包括四个部分。一是从MAC层到PHY层的发送数据接口，二是从PHY层到MAC层的接收数据接口，三是从PHY层到MAC层的状态指示信号，四是MAC层和PHY层之间传送控制和状态信息的MDIO接口。</p>
<p><img src="/images/net/mii/MII.jpg" alt="MII"></p>
<ul>
<li><p>TXD[3:0]：数据发送信号，共4根信号线；</p>
</li>
<li><p>TX_CLK：发送数据使用的时钟信号，对于10M位/s的数据传输，此时钟为2.5MHz，对于100M位/s的数据传输，此时钟为25MHz。</p>
</li>
<li><p>TX_ER（transmit coding error）： TX_ER同步于TX_CLK，在数据传输过程中，如果TX_ER有效超过一个时钟周期，并且此时TX_EN是有效的，则数据通道中传输的数据是无效的，没用的。注：当TX_ER有效并不影响工作在10Mb/s的PHY或者TX_EN无效时的数据传输。在MII接口的连线中，如果TX_ER信号线没有用到，必须将它下拉接地。</p>
</li>
<li><p>TX_EN：传输使能信号，此信号必需与数据前导符的起始位同步出现，并在传输完毕前一直保持。</p>
</li>
<li><p>TXD[3:0]：发送数据线，每次传输4位数据，数据在TX_EN信号有效时有效。当TX_EN信号无效时，PHY忽略传输的数据。</p>
</li>
<li><p>RX_CLK：接收数据使用的时钟信号，对于10M位/s的数据传输，此时钟为2.5MHz，对于100M位/s的数据传输，此时钟为25MHz。</p>
</li>
<li><p>RXD[3:0]：接收数据线，每次接收4位数据，数据在RX_DV信号有效时有效。当RX_EN无效，而RX_ER有效时，RXD[3:0]数据值代表特定的信息。</p>
</li>
<li><p>RX_DV：接收数据使能信号，由PHY控制，当PHY准备好数据供MAC接收时，使能该信号。此信号必需和帧数据的首位同步出现，并保持有效直到数据传输完成。在传送最后4位数据后的第一个时钟之前，此信号必需变为无效状态。为了正确的接收一个帧，有效电平不能滞后于数据线上的SFD位出现。</p>
</li>
<li><p>RX_ER：接收出错信号，保持一个或多个时钟周期(RX_CLK)的有效状态，表明MAC在接收过程中检测到错误。具体错误原因需配合RX_DV的状态及RXD[3:0]的数据值。</p>
</li>
<li><p>CRS：载波侦听信号，仅工作在半双工模式下，由PHY控制，当发送或接收的介质非空闲时，使能此信号。 PHY必需保证CRS信号在发生冲突的整个时间段内都保持有效，不需要此信号与发送/接收的时钟同步。</p>
</li>
<li><p>COL：冲突检测信号，仅工作在半双工模式下，由PHY控制，当检测到介质发生冲突时，使能此信号，并且在整个冲突的持续时间内，保持此信号有效。此信号不需要和发送/接收的时钟同步。</p>
</li>
<li><p>MDC：配置接口时钟。</p>
</li>
<li><p>MDIO：配置接口I/O，是PHY和STA之间的双向信号。 它用于在PHY和STA之间传输控制信息和状态。 控制信息由STA同步地针对MDC驱动并且由PHY同步地采样。 状态信息由PHY针对MDC同步驱动并由STA同步采样。需要1.5K电阻上拉。</p>
</li>
</ul>
<p>MII接口的类型有很多，常用的有MII、RMII、SMII、SSMII、SSSMII、GMII、RGMII、SGMII、TBI、RTBI、XGMII、XAUI、XLAUI等。</p>
<table>
<thead>
<tr>
<th></th>
<th>MII</th>
<th>RMII</th>
<th>GMII</th>
<th>RGMII</th>
<th>SMII</th>
</tr>
</thead>
<tbody><tr>
<td>传输速度</td>
<td>100/10M</td>
<td>100/10M</td>
<td>1000/100/10M</td>
<td>1000/100/10M</td>
<td>100M</td>
</tr>
<tr>
<td>单向数据线数</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>时钟速率</td>
<td>25/2.5M</td>
<td>50/5M</td>
<td>25/2.5M</td>
<td>125/25/2.5M</td>
<td>125M</td>
</tr>
</tbody></table>
<h2 id="RMII"><a href="#RMII" class="headerlink" title="RMII"></a>RMII</h2><p>RMII即Reduced MII，是简化的MII接口。连线数量由MII的16根减少为8根，对于10Mbps线速，MII的时钟速率是2.5MHz就可以了，RMII则需要5MHz；对于100Mbps线速，MII需要的时钟速率是25MHz，RMII则是50MHz。</p>
<p><img src="/images/net/mii/RMII.jpg" alt="RMII"></p>
<ul>
<li><p>TXD[1:0]：数据发送信号线，数据位宽为2</p>
</li>
<li><p>RXD[1:0]：数据接收信号线，数据位宽为2</p>
</li>
<li><p>TX_EN(Transmit Enable)：数据发送使能信号</p>
</li>
<li><p>RX_ER(Receive Error)：数据接收错误提示信号</p>
</li>
<li><p>CLK_REF：是由外部时钟源提供的50MHz参考时钟，与MII接口不同，MII接口中的接收时钟和发送时钟是分开的，而且都是由PHY芯片提供给MAC芯片的。这里需要注意的是，由于数据接收时钟是由外部晶振提供而不是由载波信号提取的，所以在PHY层芯片内的数据接收部分需要设计一个FIFO，用来协调两个不同的时钟,在发送接收的数据时提供缓冲。PHY层芯片的发送部分则不需要FIFO，它直接将接收到的数据发送到MAC就可以了。</p>
</li>
<li><p>CRS_DV：此信号是由MII接口中的RX_DV和CRS两个信号合并而成。当介质不空闲时，CRS_DV和RE_CLK相异步的方式给出。当CRS比RX_DV早结束时(即载波消失而队列中还有数据要传输时)，就会出现CRS_DV在半位元组的边界以25MHz/2.5MHz的频率在0、1之间的来回切换。因此，MAC能够从 CRS_DV中精确的恢复出RX_DV和CRS。</p>
</li>
</ul>
<p>在100Mbps速率时，TX/RX每个时钟周期采样一个数据；在10Mbps速率时，TX/RX每隔10个周期采样一个数据，因而TX/RX数据需要在数据线上保留10个周期，相当于一个数据发送10次。</p>
<p>当PHY层芯片收到有效的载波信号后，CRS_DV信号变为有效，此时如果FIFO中还没有数据，则它会发送出全0的数据给MAC，然后当FIFO中填入有效的数据帧，数据帧的开头是“101010—”交叉的前导码，当数据中出现“01”的比特时，代表正式数据传输开始，MAC芯片检测到这一变化，从而开始接收数据。</p>
<p>当外部载波信号消失后，CRS_DV会变为无效，但如果FIFO中还有数据要发送时，CRS_DV在下一周期又会变为有效，然后再无效再有效，直到FIFO中数据发送完为止。在接收过程中如果出现无效的载波信号或者无效的数据编码，则RX_ER会变为有效，表示物理层芯片接收出错。</p>
<h2 id="SMII"><a href="#SMII" class="headerlink" title="SMII"></a>SMII</h2><p>SMII即Serial MII，串行MII的意思，跟RMII相比，连线进一步减少到4根。只用一根信号线传送发送数据，一根信号线传输接受数据，所以在时钟上为了满足100的需求，它的时钟频率高达到125M，数据线里面还会传送一些控制信息。所有端口的数据收发都公用同一个外部的125M时钟。</p>
<p><img src="/images/net/mii/SMII.jpg" alt="SMII"></p>
<ul>
<li>TXD：发送数据信号，位宽为1；</li>
<li>RXD：接收数据信号，位宽为1；</li>
<li>SYNC：收发数据同步信号，每10个时钟周期置1次高电平，指示同步。</li>
<li>CLK_REF：所有端口共用的一个参考时钟，频率为125MHz，为什么100Mbps速率要用125MHz时钟？因为在每8位数据中会插入2位控制信号，请看下面介绍。</li>
</ul>
<p>TXD/RXD以10比特为一组，以SYNC为高电平来指示一组数据的开始，在SYNC变高后的10个时钟周期内，TXD上依次输出的数据是：TXD[7:0]、TX_EN、TX_ER，控制信号的含义与MII接口中的相同；RXD上依次输出的数据是：RXD[7:0]、RX_DV、CRS，RXD[7:0]的含义与RX_DV有关，当RX_DV为有效时(高电平)，RXD[7:0]上传输的是物理层接收的数据。当RX_DV为无效时(低电平)，RXD[7:0]上传输的是物理层的状态信息数据。见下表：</p>
<p><img src="/images/net/mii/SMII2.jpg" alt="img"></p>
<p>当速率为10Mbps时，每一组数据要重复10次，MAC/PHY芯片每10个周期采样一次。MAC/PHY芯片在接收到数据后会进行串/并转换。</p>
<h2 id="SSMII"><a href="#SSMII" class="headerlink" title="SSMII"></a>SSMII</h2><p>SSMII即Serial Sync MII，叫串行同步接口，跟SMII接口很类似，只是收发使用独立的参考时钟和同步时钟，不再像SMII那样收发共用参考时钟和同步时钟，传输距离比SMII更远。</p>
<p><img src="/images/net/mii/SSMII.jpg" alt="img"></p>
<h2 id="SSSMII"><a href="#SSSMII" class="headerlink" title="SSSMII"></a>SSSMII</h2><p>SSSMII即Source Sync Serial MII，叫源同步串行MII接口，SSSMII与SSMII的区别在于参考时钟和同步时钟的方向，SSMII的TX/RX参考时钟和同步时钟都是由PHY芯片提供的，而SSSMII的TX参考时钟和同步时钟是由MAC芯片提供的，RX参考时钟和同步时钟是由PHY芯片提供的，所以顾名思义叫源同步串行。</p>
<p><img src="/images/net/mii/SSSMII.jpg" alt="img"></p>
<h2 id="GMII"><a href="#GMII" class="headerlink" title="GMII"></a>GMII</h2><p>GMII(Gigabit MII)是千兆网的MII接口。GMII采用8位接口数据，工作时钟125MHz，因此传输速率可达1000Mbps。同时兼容MII所规定的10/100 Mbps工作方式。GMII接口数据结构符合IEEE 802.3-2000以太网标准。</p>
<p>与MII接口相比，GMII的数据宽度由4位变为8位，GMII接口中的控制信号如TX_ER、TX_EN、RX_ER、RX_DV、CRS和COL的作用同MII接口中的一样，发送参考时钟GTX_CLK和接收参考时钟RX_CLK的频率均为125MHz(1000Mbps/8=125MHz)。</p>
<p>发送参考时钟GTX_CLK，它和MII接口中的TX_CLK是不同的，MII接口中的TX_CLK是由PHY芯片提供给MAC芯片的，而GMII接口中的GTX_CLK是由MAC芯片提供给PHY芯片的。两者方向不一样。绝大多数GMII接口都是兼容MII接口的，所以GMII接口都有两个发送参考时钟：TX_CLK和GTX_CLK(两者方向不一样)，在用作MII模式时，使用TX_CLK和8根数据线中的4根。</p>
<p><img src="/images/net/mii/GMII.jpg" alt="GMII"></p>
<p>在千兆速率下，向PHY提供GTXCLK信号、TXD、TXEN、TXER信号与此时钟信号同步。否则在10/100Mbps速率下，PHY提供TXCLK时钟信号，其它信号与此信号同步。其工作频率为25MHz(100M网络)或2.5MHz(10M网络)。</p>
<h2 id="RGMII"><a href="#RGMII" class="headerlink" title="RGMII"></a>RGMII</h2><p>RGMII即Reduced GMII，是GMII的简化版本，将接口信号线数量从24根减少到14根，时钟频率仍旧为125MHz，TX/RX数据宽度从8为变为4位，为了保持1000Mbps的传输速率不变，RGMII接口在时钟的上升沿和下降沿都采样数据。在参考时钟的上升沿发送GMII接口中的TXD[3:0]/RXD[3:0]，在参考时钟的下降沿发送GMII接口中的TXD[7:4]/RXD[7:4]。RGMI同时也兼容100Mbps和10Mbps两种速率，此时参考时钟速率分别为25MHz和2.5MHz。</p>
<p>TX_EN信号线上传送TX_EN和TX_ER两种信息，在TX_CLK的上升沿发送TX_EN，下降沿发送TX_ER；同样的，RX_DV信号线上也传送RX_DV和RX_ER两种信息，在RX_CLK的上升沿发送RX_DV，下降沿发送RX_ER。</p>
<p><img src="/images/net/mii/RGMII.jpg" alt="RGMII"></p>
<p><img src="/images/net/mii/RGMII2.jpg" alt="img"></p>
<h2 id="SGMII"><a href="#SGMII" class="headerlink" title="SGMII"></a>SGMII</h2><p>SGMII即Serial GMII，串行GMII，收发各一对差分信号线，时钟频率625MHz，在时钟信号的上升沿和下降沿均采样，参考时钟RX_CLK由PHY提供，是可选的，主要用于MAC侧没有时钟的情况，一般情况下，RX_CLK不使用。收发都可以从数据中恢复出时钟。</p>
<p>在TXD发送的串行数据中，每8比特数据会插入TX_EN/TX_ER 两比特控制信息，同样，在RXD接收数据中，每8比特数据会插入RX_DV/RX_ER 两比特控制信息，所以总的数据速率为1.25Gbps=625Mbps*2。</p>
<p>其实，大多数MAC芯片的SGMII接口都可以配置成SerDes接口(在物理上完全兼容，只需配置寄存器即可)，直接外接光模块，而不需要PHY层芯片，此时时钟速率仍旧是625MHz，不过此时跟SGMII接口不同，SGMII接口速率被提高到1.25Gbps是因为插入了控制信息，而SerDes端口速率被提高是因为进行了8B/10B变换，本来8B/10B变换是PHY芯片的工作，在SerDes接口中，因为外面不接PHY芯片，此时8B/10B变换在MAC芯片中完成了。8B/10B变换的主要作用是扰码，让信号中不出现过长的连“0”和连“1”情况，影响时钟信息的提取，关于8B/10B变换知识，我后续会单独介绍。</p>
<p><img src="/images/net/mii/SGMII.jpg" alt="SGMII"></p>
<h2 id="TBI"><a href="#TBI" class="headerlink" title="TBI"></a>TBI</h2><p>TBI即Ten Bit Interface，接口数据位宽由GMII接口的8位增加到10位，其实，TBI接口跟GMII接口的差别不是很大，多出来的2位数据主要是因为在TBI接口下，MAC芯片在将数据发给PHY芯片之前进行了8B/10B变换(8B/10B变换本是在PHY芯片中完成的，前面已经说过了)，另外，RX_CLK+/-是从接收数据中恢复出来的半频时钟，频率为62.5MHz，RX_CLK+/-不是差分信号，而是两个独立的信号，两者之间有180度的相位差，在这两个时钟的上升沿都采样数据。RX_CLK+/-也叫伪差分信号。除掉上面说到的之外，剩下的信号都跟GMII接口中的相同。大多数芯片的TBI接口和GMII接口兼容。在用作TBI接口时，CRS和COL一般不用。</p>
<p><img src="/images/net/mii/TBI.jpg" alt="img"></p>
<h2 id="RTBI"><a href="#RTBI" class="headerlink" title="RTBI"></a>RTBI</h2><p>RTBI即Reduced TBI，简化版TBI，接口数据位宽为5bit，时钟频率为125MHz，在时钟的上升沿和下降沿都采样数据，同RGMII接口一样，TX_EN线上会传送TX_EN和TX_ER两种信息，在时钟的上升沿传TX_EN，下降沿传TX_ER；RX_DV线上传送RX_DV和RX_ER两种信息，在RX_CLK上升沿传RX_DV，下降沿传RX_ER。</p>
<p><img src="/images/net/mii/RTBI.jpg" alt="img"></p>
<h2 id="XGMII"><a href="#XGMII" class="headerlink" title="XGMII"></a>XGMII</h2><p>XGMII–10 Gigabit Media Independent Interface 即10Gb独立于媒体的接口，X对应罗马数字10。</p>
<p><img src="/images/net/mii/XGMII.jpg" alt="XGMII"></p>
<p>XGMII接口共74根连线，单端信号，采用HSTL/SSTL_2逻辑，端口电压1.5V/2.5V，由于SSTL_2的端口电压高，功耗大，现在已很少使用。</p>
<ul>
<li><p>TXD[31:0]：数据发送通道，32位并行数据。</p>
</li>
<li><p>RXD[31:0]：数据接收通道，32位并行数据。</p>
</li>
<li><p>TXC[3:0]：发送通道控制信号，TXC=0时，表示TXD上传输的是数据；TXC=1时，表示TXD上传输的是控制字符。TXC[3:0]分别对应TXD[31:24], TXD[23:16], TXD[15:8], TXD[7:0]。</p>
</li>
<li><p>RXC[3:0]：接收通道控制信号，RXC=0时，表示RXD上传输的是数据；RXC=1时，表示RXD上传输的是控制字符。RXC[3:0]分别对应RXD[31:24], RXD[23:16], RXD[15:8], RXD[7:0]。</p>
</li>
<li><p>TX_CLK：TXD和TXC的参考时钟，时钟频率156.25MHz，在时钟信号的上升沿和下降沿都采样数据。156.25MHz - 2 - 32 = 10Gbps 。</p>
</li>
<li><p>RX_CLK：RXD和RXC的参考时钟，时钟频率156.25MHz，在时钟信号的上升沿和下降沿都采样数据。</p>
</li>
</ul>
<p>HSTL即High Speed Transceiver Logic，高速发送逻辑的意思。</p>
<p>SSTL，即Stub Series Terminated Logic，短路终止逻辑，主要用于高速内存接口，SSTL目前存在两种标准，SSTL_3是3.3V标准；SSTL_2是2.5V标准。</p>
<h2 id="XAUI"><a href="#XAUI" class="headerlink" title="XAUI"></a>XAUI</h2><p>由于受电气特性的影响，XGMII接口的PCB走线最大传输距离仅有7cm，并且XGMII接口的连线数量太多，给实际应用带来不便，因此，在实际应用中，XGMII接口通常被XAUI接口代替，XAUI即10 Gigabit attachment unit interface，将XGMII集成到芯片内部，XAUI在XGMII的基础上实现了XGMII接口的物理距离扩展，将PCB走线的传输距离增加到50cm，使背板走线成为可能。</p>
<p>源端XGMII把收发32位宽度数据流分为4个独立的lane通道，每个lane通道对应一个字节，经XGXS(XGMII Extender Sublayer)完成8B/10B编码后，将4个lane分别对应XAUI的4个独立通道，XAUI端口速率为：<code>2.5Gbps - 1.25 - 4＝12.5Gbps</code>。</p>
<p><img src="/images/net/mii/XAUI.jpg" alt="img"></p>
<p>在发送端的XGXS模块中，将TXD[31:0]/ RXD[31:0],TXC[3:0]/ RXC[3:0], TX_CLK/ RX_CLK转换成串行数据从TX Lane[3:0]/ RX Lane[3:0]中发出去，在接收端的XGXS模块中，串行数据被转换成并行，并且进行时钟恢复和补偿，完成时钟去抖，经过5B/4B解码后，重新聚合成XGMII。</p>
<p>万兆以太网接口的端口速率为10Gbps，主要有XGMII和XAUI两种，另外还有HIGIG。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/19/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><span class="page-number current">20</span><a class="page-number" href="/page/21/">21</a><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/21/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ubun2</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">219</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ubun2</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v5.4.2
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.7.2
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
